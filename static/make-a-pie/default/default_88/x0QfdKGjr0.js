const observationData=[{name:"第一次",time:"2020-09-26",floor:-3,settlement:0},{name:"第二次",time:"2020-10-23",floor:2,settlement:-1.44},{name:"第三次",time:"2020-11-04",floor:6,settlement:-2.28},{name:"第四次",time:"2020-11-28",floor:10,settlement:-3.8}];let maxSettlement=Math.min(...observationData.map(e=>e.settlement)),settlementArr=[],yAxisDividNum=.5;maxSettlement*1.2<-20?(maxSettlement=-20,yAxisDividNum=1):maxSettlement*=1.2;do settlementArr.push(maxSettlement),maxSettlement=Number((maxSettlement+yAxisDividNum).toFixed(1));while(maxSettlement<0);settlementArr.unshift(settlementArr[0]-yAxisDividNum);const buildingHeight=19;let buildingArr=[];for(let e=1;e<=buildingHeight;e++)buildingArr.push(e);buildingArr=[.1,.2,.3].concat(buildingArr);const temp=settlementArr.concat(buildingArr);let fNum=0,zNum=0;for(let e=0;e<temp.length;e++)temp[e]<0&&fNum--,temp[e]>0&&zNum++;let yAxisData=[];for(let e=fNum;e<=zNum;e++)yAxisData.push(e);const CJL=observationData.map(e=>e.settlement);option={backgroundColor:"#fff",tooltip:{show:!0,trigger:"axis",formatter:e=>`<span>${e[0].axisValueLabel}</span><br>
                <span><span>${e[0].marker}</span>楼层：${e[0].value===0?0:e[0].value-3}</span><br>
                <span><span>${e[1].marker}</span>沉降量：${CJL[e[1].dataIndex]}</span>`},grid:{containLabel:!0},xAxis:{type:"category",splitLine:{show:!0},boundaryGap:!1,axisLabel:{show:!0,align:"left"},axisLine:{symbol:["none","arrow"],lineStyle:{width:2}},data:observationData.map(e=>`${e.time}
${e.name}`)},yAxis:{name:"载荷（楼层）",nameTextStyle:{align:"right"},type:"value",max:yAxisData[yAxisData.length-1],min:yAxisData[0],interval:1,splitLine:{show:!0},axisLabel:{show:!0,formatter:(e,t)=>e===yAxisData[0]?"累积沉降量（mm）":e>=0&&e<4?e===0?0:e===1?"B2":e===2?"B1":"J":e<0?settlementArr[t]:e===yAxisData[yAxisData.length-1]?"机房层":e-3},axisLine:{symbol:["arrow","arrow"],symbolOffset:[-12,12],lineStyle:{width:2}},data:yAxisData},series:[{name:"楼层",type:"line",smooth:!0,label:{show:!0,formatter:e=>{switch(e.value){case 0:return"";case 1:return"B2";case 2:return"B1";case 3:return"J";default:return e.value-3}}},data:observationData.map(e=>e.floor+3)},{name:"沉降量",type:"line",smooth:!0,label:{show:!0,position:"bottom",formatter:e=>e.value===0?"":CJL[e.dataIndex]},data:CJL.map((e,t)=>t===0?0:e/yAxisDividNum-(settlementArr[settlementArr.length-1]/yAxisDividNum+1))}]};

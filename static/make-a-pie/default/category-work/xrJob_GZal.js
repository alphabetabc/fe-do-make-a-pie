option={series:[]};function phyllotaxisLayout(a,e,t=0,h=0,r=0){var o=Math.PI*(3-Math.sqrt(5)),n=e/2;return a.forEach((v,c)=>{var l=(c+r)%a.length,s=n*Math.sqrt(l)*Math.cos(l*o),i=n*Math.sqrt(l)*Math.sin(l*o);v.x=t+s-n,v.y=h+i-n}),a}function gridLayout(a,e,t){var h=e,r=Math.floor(t/e),o=a.length/r;return a.forEach((n,v)=>{n.x=e*(v%r),n.y=h*Math.floor(v/r)}),a}function randomLayout(a,e,t,h){return a.forEach((r,o)=>{r.x=Math.random()*(t-e),r.y=Math.random()*(h-e)}),a}function sineLayout(a,e,t,h){var r=.3*(h/2),o=h/2,n=3,v=d3.scaleLinear().domain([0,a.length-1]).range([0,n*2*Math.PI]);return a.forEach((c,l)=>{c.x=l/a.length*(t-e),c.y=r*Math.sin(v(l))+o}),a}function spiralLayout(a,e,t,h){var r=.3*(h/2),o=t/2,n=h/2,v=20,c=d3.scaleLinear().domain([0,a.length-1]).range([0,Math.min(t/2,h/2)-e]),l=d3.scaleLinear().domain([0,a.length-1]).range([0,v*2*Math.PI]);return a.forEach((s,i)=>{s.x=c(i)*Math.cos(l(i))+o,s.y=c(i)*Math.sin(l(i))+n}),a}function createPoints(a,e,t,h){var r=d3.scaleSequential(d3.interpolateViridis).domain([a-1,0]),o=d3.range(a).map(n=>({id:n,color:r(n)}));return randomLayout(o,e,t,h)}var width=myChart.getZr().getWidth(),height=myChart.getZr().getHeight(),numPoints=7e3,pointWidth=3,pointMargin=3,duration=1500,ease=d3.easeCubic,timer,currLayout=0,points=createPoints(numPoints,pointWidth,width,height),toGrid=a=>gridLayout(a,pointWidth+pointMargin,width),toSine=a=>sineLayout(a,pointWidth+pointMargin,width,height),toSpiral=a=>spiralLayout(a,pointWidth+pointMargin,width,height),toPhyllotaxis=a=>phyllotaxisLayout(a,pointWidth+pointMargin,width/2,height/2),layouts=[toSine,toPhyllotaxis,toSpiral,toPhyllotaxis,toGrid];function animate(a,e){points.forEach(t=>{t.sx=t.x,t.sy=t.y}),e(points),points.forEach(t=>{t.tx=t.x,t.ty=t.y}),timer=d3.timer(t=>{var h=Math.min(1,ease(t/duration));points.forEach(r=>{r.x=r.sx*(1-h)+r.tx*h,r.y=r.sy*(1-h)+r.ty*h}),a.forEach(function(r,o){r.setShape("x",r.__point__.x),r.setShape("y",r.__point__.y)}),h===1&&(timer.stop(),currLayout=(currLayout+1)%layouts.length,animate(a,layouts[currLayout]))})}myChart.getZr().clear();var rects=points.map(function(a){var e=new echarts.graphic.Rect({shape:{width:pointWidth,height:pointWidth},style:{fill:a.color},silent:!0,__point__:a});return myChart.getZr().add(e),e});toGrid(points),rects.forEach(function(a,e){a.setShape("x",a.__point__.x),a.setShape("y",a.__point__.y)}),setTimeout(function(){animate(rects,layouts[currLayout])},1e3);

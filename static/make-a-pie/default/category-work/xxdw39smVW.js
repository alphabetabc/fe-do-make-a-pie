var upColor="#00da3c",downColor="#ec0000";function splitData(a){for(var e=[],s=[],l=[],o=0;o<a.length;o++)e.push(a[o].splice(0,1)[0]),s.push(a[o]),l.push([o,a[o][4],a[o][0]>a[o][1]?1:-1]);return{categoryData:e,values:s,volumes:l}}function calculateMA(a,e){for(var s=[],l=0,o=e.values.length;l<o;l++){if(l<a){s.push("-");continue}for(var r=0,t=0;t<a;t++)r+=e.values[l-t][1];s.push(+(r/a).toFixed(3))}return s}$.get("data/asset/data/stock-DJI.json",function(a){var e=splitData(a);console.log(e),myChart.setOption(option={tooltip:{trigger:"axis",axisPointer:{type:"cross"},backgroundColor:"rgba(245, 245, 245, 0.8)",borderWidth:1,borderColor:"#ccc",padding:10,textStyle:{color:"#000"},position:function(s,l,o,r,t){var i={top:10};return i[["left","right"][+(s[0]<t.viewSize[0]/2)]]=30,i}},axisPointer:{link:{xAxisIndex:"all"},label:{backgroundColor:"#777"}},visualMap:{show:!1,seriesIndex:3,dimension:2,pieces:[{value:1,color:downColor},{value:-1,color:upColor}]},grid:[{left:"10%",right:"8%",height:"50%"},{left:"10%",right:"8%",top:"63%",height:"16%"}],xAxis:[{type:"category",data:e.categoryData,scale:!0,boundaryGap:!1,axisLine:{onZero:!1},splitLine:{show:!1},splitNumber:20,min:"dataMin",max:"dataMax",axisPointer:{z:100,label:{show:!1}}},{type:"category",gridIndex:1,data:e.categoryData,scale:!0,boundaryGap:!1,axisLine:{onZero:!1},axisTick:{show:!1},splitLine:{show:!1},axisLabel:{show:!1},splitNumber:20,axisPointer:{z:100,label:{show:!1}}}],yAxis:[{scale:!0,splitArea:{show:!0},axisTick:{show:!1},axisLabel:{inside:!0,formatter:`{value}
`}},{scale:!0,gridIndex:1,splitNumber:2,axisLabel:{show:!1},axisLine:{show:!1},axisTick:{show:!1},splitLine:{show:!1},axisPointer:{label:{show:!1}}}],series:[{name:"Dow-Jones",type:"candlestick",data:e.values,itemStyle:{normal:{color:upColor,color0:downColor,borderColor:null,borderColor0:null}}},{name:"MA5",type:"line",data:calculateMA(5,e),smooth:!0,lineStyle:{normal:{opacity:.5}}},{name:"MA10",type:"line",data:calculateMA(10,e),smooth:!0,lineStyle:{normal:{opacity:.5}}},{name:"Volume",type:"bar",xAxisIndex:1,yAxisIndex:1,data:e.volumes}]})});

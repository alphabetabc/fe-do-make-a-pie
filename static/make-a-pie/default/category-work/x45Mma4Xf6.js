AMap.plugin(["AMap.Geolocation","AMap.DistrictSearch"],function(){new AMap.Geolocation().getCurrentPosition(function(s,e){var p=new AMap.Marker({position:new AMap.LngLat(e.position.lng,e.position.lat),title:e.formattedAddress}),l=new AMap.DistrictSearch({subdistrict:0,level:"province",extensions:"all"}).search(e.addressComponent.province,function(d,n){n=n.districtList[0];var r=n.boundaries,t=new AMap.Map("chart-panel",{mapStyle:"amap://styles/3217e099bb7b1bb4a8e063ce169bbb5b",mask:r.map(function(o){return[o]}),center:n.center,pitch:52,viewMode:"3D",buildingAnimation:!0,labelzIndex:130,cursor:"pointer",features:["road","building","point"]});t.on("complete",function(){p.setMap(this),this.setCity(e.addressComponent.adcode),t.plugin(["AMap.ControlBar"],function(){var a=new AMap.ControlBar({position:{right:"0",bottom:"-173px"}});t.addControl(a)}),t.plugin(["AMap.Scale"],function(){var a=new AMap.Scale;t.addControl(a)}),t.plugin(["AMap.ToolBar"],function(){var a=new AMap.ToolBar;t.addControl(a)}),t.plugin(["AMap.DistrictLayer"],function(){var a=new AMap.DistrictLayer.Country({SOC:"CHN",zIndex:1,depth:2,styles:{"province-stroke":"cornflowerblue","city-stroke":"white","county-stroke":"#3c648780",fill:"rgba(0,0,0,0)"}});a.setMap(t)});var o=new AMap.Object3D.Wall({path:r,height:5e3,color:"#0088ffcc"});o.transparent=!0;var i=new AMap.Object3DLayer({});i.add(o),i.setMap(t);var c=new AMap.TileLayer({zIndex:-1,getTileUrl:"http://t{1,2,3,4}.tianditu.gov.cn/DataServer?tk=2ce94f67e58faa24beb7cb8a09780552&T=ter_w&x=[x]&y=[y]&l=[z]"});c.setMap(t)})})})});

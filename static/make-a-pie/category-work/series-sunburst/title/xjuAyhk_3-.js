const sourceData=[{id:"1470876252852527106",parentId:"0",children:[{id:"1470876252852527107",parentId:"1470876252852527106",children:[{id:"1470876252852527108",parentId:"1470876252852527107",children:[],nodeName:"低频"},{id:"1470876252852527109",parentId:"1470876252852527107",children:[],nodeName:"高频"}],nodeName:"基本面"},{id:"1470876252852527110",parentId:"1470876252852527106",children:[{id:"1470876252852527111",parentId:"1470876252852527110",children:[],nodeName:"风险溢价"},{id:"1470876252852527112",parentId:"1470876252852527110",children:[],nodeName:"RAI"},{id:"1470876252852527113",parentId:"1470876252852527110",children:[],nodeName:"均线动量"},{id:"1470876252852527114",parentId:"1470876252852527110",children:[],nodeName:"资金"}],nodeName:"市场趋势"}],nodeName:"债券"},{id:"1470876252852527115",parentId:"0",children:[{id:"1470876252852527116",parentId:"1470876252852527115",children:[{id:"1470876252852527117",parentId:"1470876252852527116",children:[],nodeName:"估值"},{id:"1470876252852527118",parentId:"1470876252852527116",children:[],nodeName:"盈利"}],nodeName:"基本面"},{id:"1470876252852527119",parentId:"1470876252852527115",children:[{id:"1470876252852527120",parentId:"1470876252852527119",children:[],nodeName:"风险溢价"},{id:"1470876252852527121",parentId:"1470876252852527119",children:[],nodeName:"成交量"},{id:"1470876252852527122",parentId:"1470876252852527119",children:[],nodeName:"机构行为"}],nodeName:"市场趋势"},{id:"1470876252852527123",parentId:"1470876252852527115",children:[],nodeName:"尾部信号"}],nodeName:"股票"},{id:"1470876252852527124",parentId:"0",children:[],nodeName:"股票风格"}],gapDeg=3;function getDepthAndSum(e,i,d){var a=!1,n=[];for(let t=0;t<e.length;t++)if(e[t].name=e[t].nodeName,e[t].children instanceof Array){for(let r=0;r<e[t].children.length;r++)n.push(e[t].children[r]);a=!0,e[t].children.length===0&&(d++,e[t].value=1)}return a?(i++,getDepthAndSum(n,i,d)):{depth:i,endNodeSum:d}}const{depth,endNodeSum}=getDepthAndSum(sourceData,0,0),realData=[],list=["债券","股票风格","股票"];list.forEach(e=>{const i=sourceData.find(({nodeName:d})=>d===e);realData.push(i),realData.push({value:gapDeg/360*endNodeSum,itemStyle:{opacity:0,color:"transparent"},cursor:"auto",type:"gap"})});function handleSunburstData(e,i,d){e.forEach(a=>{d(a,i),a.children&&a.children.length>0&&a.type!=="hideItem"&&handleSunburstData(a.children,i+1,d)})}function getSunburstData(e){const i=[],d=JSON.parse(JSON.stringify(realData));let a=0;return handleSunburstData(d,1,(n,t)=>{a++,n.type!=="gap"&&(e===0?(!n.children||t<depth&&n.children.length===0)&&(n.dataIndex=a,n.label={show:!1},n.itemStyle={opacity:0},n.emphasis={label:{show:!1}},n.type="hideItem",t===1&&(n.seriesIndex=1,n.children=[{id:n.id,value:1,dataIndex:a,seriesIndex:1,itemStyle:{opacity:0},children:[{id:n.id,value:1,dataIndex:a,seriesIndex:1,itemStyle:{opacity:0}}]}]),t===2&&(n.seriesIndex=2,n.children=[{id:n.id,value:1,dataIndex:a,seriesIndex:2,itemStyle:{opacity:0}}])):(t!==e||n.children.length!==0)&&(n.label={show:!1},n.itemStyle={opacity:0},n.cursor="auto",n.emphasis={label:{show:!1}}))}),d}option={title:{text:"旭日图菜单"},series:[{type:"sunburst",radius:["20%","80%"],center:["50%","50%"],data:getSunburstData(0),emphasis:{focus:"none"},sort:null,label:{rotate:0},nodeClick:!1,z:3,startAngle:90-gapDeg/2},{type:"sunburst",radius:["20%","200%"],center:["50%","50%"],data:getSunburstData(1),emphasis:{focus:"none"},sort:null,label:{rotate:0},nodeClick:!1,silent:!0,startAngle:90-gapDeg/2},{type:"sunburst",radius:["0%","120%"],center:["50%","50%"],data:getSunburstData(2),emphasis:{focus:"none"},sort:null,label:{rotate:0},nodeClick:!1,silent:!0,startAngle:90-gapDeg/2}]},myChart.on("mouseover",function(e){if(e.data.dataIndex){const{seriesIndex:i,dataIndex:d}=e.data;myChart.dispatchAction({type:"highlight",seriesIndex:i,dataIndex:d})}}),myChart.on("mouseout",function(e){if(e.data.dataIndex){const{seriesIndex:i,dataIndex:d}=e.data;myChart.dispatchAction({type:"downplay",seriesIndex:i,dataIndex:d})}}),myChart.on("click",function(e){console.log(e.data.id)});

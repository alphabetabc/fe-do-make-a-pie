var uploadedDataURL="https://geo.datav.aliyun.com/areas_v2/bound/430000_full.json",changsha="https://geo.datav.aliyun.com/areas_v2/bound/430100_full.json",zhuzhou="https://geo.datav.aliyun.com/areas_v2/bound/430200_full.json",xiangtan="https://geo.datav.aliyun.com/areas_v2/bound/430300_full.json",changde="https://geo.datav.aliyun.com/areas_v2/bound/430700_full.json",chenzhou="https://geo.datav.aliyun.com/areas_v2/bound/431000_full.json",henyang="https://geo.datav.aliyun.com/areas_v2/bound/430400_full.json",huaihua="https://geo.datav.aliyun.com/areas_v2/bound/431200_full.json",loudi="https://geo.datav.aliyun.com/areas_v2/bound/431300_full.json",shaoyang="https://geo.datav.aliyun.com/areas_v2/bound/430500_full.json",yiyang="https://geo.datav.aliyun.com/areas_v2/bound/430900_full.json",yongzhou="https://geo.datav.aliyun.com/areas_v2/bound/431100_full.json",yueyang="https://geo.datav.aliyun.com/areas_v2/bound/430600_full.json",zhangjiajie="https://geo.datav.aliyun.com/areas_v2/bound/430800_full.json",xiangxi="https://geo.datav.aliyun.com/areas_v2/bound/433100_full.json";$.get(uploadedDataURL,function(E){myChart.hideLoading(),echarts.registerMap("湖南",E);var y={长沙市:changsha,株洲市:zhuzhou,湘潭市:xiangtan,常德市:changde,郴州市:chenzhou,衡阳市:henyang,怀化市:huaihua,娄底市:loudi,邵阳市:shaoyang,益阳市:yiyang,永州市:yongzhou,岳阳市:yueyang,张家界市:zhangjiajie,湘西土家族苗族自治州:xiangxi},h={长沙市:[112.945358,28.234451],株洲市:[113.142199,27.830501],湘潭市:[112.952189,27.835703],常德市:[111.706024,29.037245],郴州市:[113.022608,25.777204],衡阳市:[112.584198,26.900606],怀化市:[110.010239,27.575161],娄底市:[112.000353,27.705255],邵阳市:[111.476157,27.243729],益阳市:[112.367266,28.559712],永州市:[111.621754,26.426899],岳阳市:[113.135488,29.364184],张家界市:[110.488982,29.122817],湘西土家族苗族自治州:[109.74443,28.322965]},v=[[{name:"长沙市",value:28}],[{name:"株洲市",value:19}],[{name:"湘潭市",value:6}],[{name:"常德市",value:0}],[{name:"郴州市",value:0}],[{name:"衡阳市",value:0}],[{name:"怀化市",value:0}],[{name:"娄底市",value:0}],[{name:"邵阳市",value:0}],[{name:"益阳市",value:0}],[{name:"永州市",value:0}],[{name:"岳阳市",value:0}],[{name:"张家界市",value:0}],[{name:"湘西土家族苗族自治州",value:0}]],m=[{name:"桔子洲",value:[112.970259,28.209371,3]},{name:"五一大桥",value:[112.974812,28.201219,2]},{name:"猴子石",value:[112.966892,28.147666,1]}],g=[{name:"株洲市四水厂(枫溪)",value:[113.795,26.6315,3]},{name:"株洲市一水厂",value:[113.521,27.1174,2]},{name:"株洲市二、三水厂(白石)",value:[113.755,26.8041,1]},{name:"炎陵泵房",value:[113.843,26.3766,0]}],x=[{name:"湘潭市三水厂",value:[112.892,27.4549,3]},{name:"湘潭市易俗河水厂",value:[112.956,27.7689,2]},{name:"涓水入湘江口",value:[112.782,27.662,0]}],b=[{name:"武陵大桥",value:[111.705018,29.023562,1]}],C=[{name:"东江",value:[113.183872,25.916113,1]}],O=[{name:"蒸水湘江入水口",value:[112.620562,26.917616,1]}],z=[{name:"舞水大桥",value:[109.962382,27.552532,1]}],_=[{name:"涟水入水口",value:[112.0752,27.741965,1]}],k=[{name:"资水",value:[111.497429,27.266338,1]}],w=[{name:"益阳资江二桥口",value:[112.381531,28.604063,1]}],j=[{name:"祁阳市湘江二桥口",value:[111.84403,26.572493,1]}],S=[{name:"东洞庭湖",value:[113.048676,29.301209,1]}],T=[{name:"张家界市大庸桥口",value:[110.466753,29.134629,1]}],A=[{name:"沅江武水入水口",value:[110.175293,28.279329,1]}],D={bgColor:"#013954",mapName:"湖南",goDown:!0,callback:function(a,e,t){console.log(a,e,t),a=="湖南"?(e.series[0].data=N(v),e.series[1].data=v.map(function(r){return{name:r[0].name,value:h[r[0].name].concat([r[0].value])}}),myChart.setOption(e,!0),setTimeout(()=>{myChart.setOption(e,!0)},500)):a=="长沙市"?(e.series[0].data=s(m),e.series[1].data=m,myChart.setOption(e,!0),setTimeout(()=>{myChart.setOption(e,!0)},500)):a=="株洲市"?(e.series[0].data=s(g),e.series[1].data=g,myChart.setOption(e,!0),setTimeout(()=>{myChart.setOption(e,!0)},500)):a=="湘潭市"?(e.series[0].data=s(x),e.series[1].data=x,myChart.setOption(e,!0),setTimeout(()=>{myChart.setOption(e,!0)},500)):a=="常德市"?(e.series[0].data=s(b),e.series[1].data=b,myChart.setOption(e,!0),setTimeout(()=>{myChart.setOption(e,!0)},500)):a=="郴州市"?(e.series[0].data=s(C),e.series[1].data=C,myChart.setOption(e,!0),setTimeout(()=>{myChart.setOption(e,!0)},500)):a=="衡阳市"?(e.series[0].data=s(O),e.series[1].data=O,myChart.setOption(e,!0),setTimeout(()=>{myChart.setOption(e,!0)},500)):a=="怀化市"?(e.series[0].data=s(z),e.series[1].data=z,myChart.setOption(e,!0),setTimeout(()=>{myChart.setOption(e,!0)},500)):a=="娄底市"?(e.series[0].data=s(_),e.series[1].data=_,myChart.setOption(e,!0),setTimeout(()=>{myChart.setOption(e,!0)},500)):a=="邵阳市"?(e.series[0].data=s(k),e.series[1].data=k,myChart.setOption(e,!0),setTimeout(()=>{myChart.setOption(e,!0)},500)):a=="益阳市"?(e.series[0].data=s(w),e.series[1].data=w,myChart.setOption(e,!0),setTimeout(()=>{myChart.setOption(e,!0)},500)):a=="永州市"?(e.series[0].data=s(j),e.series[1].data=j,myChart.setOption(e,!0),setTimeout(()=>{myChart.setOption(e,!0)},500)):a=="岳阳市"?(e.series[0].data=s(S),e.series[1].data=S,myChart.setOption(e,!0),setTimeout(()=>{myChart.setOption(e,!0)},500)):a=="张家界市"?(e.series[0].data=s(T),e.series[1].data=T,myChart.setOption(e,!0),setTimeout(()=>{myChart.setOption(e,!0)},500)):a=="湘西土家族苗族自治州"&&(e.series[0].data=s(A),e.series[1].data=A,myChart.setOption(e,!0),setTimeout(()=>{myChart.setOption(e,!0)},500))},data:[]},L={1:"#f44336",2:"#fc9700",3:"#ffde00",4:"#00eaff"},F={mapName:"china",goDown:!1,activeArea:[],data:[],callback:function(a,e,t){}};D&&(opt1=$.extend(F,D));var d=[opt1.mapName],p=0,l={leftPlus:55,leftCur:50,left:10,top:10},M=[[0,0],[8,11],[0,22]],f={font:'18px "Microsoft YaHei", sans-serif',textColor:"#eee",lineColor:"rgba(147, 235, 248, .8)"},i={resetOption:function(a,e,t){console.log(a),console.log(e),console.log(t);var r=this.createBreadcrumb(t),n=d.indexOf(t),u=e.graphic.length;if(n<0){if(console.log("jinru1"),e.graphic.push(r),e.graphic[0].children[0].shape.x2=195,e.graphic[0].children[1].shape.x2=195,e.graphic.length>2)for(var o=0;o<opt1.data.length;o++)if(t===opt1.data[o].name+"市"){e.series[0].data=i.initSeriesData(opt1.data[o].data);break}else e.series[0].data=[];d.push(t),p++}else console.log("jinru2",n),e.graphic.splice(n+2,u),e.graphic.length<=2&&(e.graphic[0].children[0].shape.x2=85,e.graphic[0].children[1].shape.x2=85,e.series[0].data=i.initSeriesData(v)),d.splice(n+1,u),p=n,l.leftCur-=l.leftPlus*(u-n-1);e.geo.map=t,e.geo.zoom=1,a.clear(),a.setOption(e),this.zoomAnimation(),opt1.callback(t,e,a)},createBreadcrumb:function(a){var e={长沙市:"changsha",株洲市:"zhuzhou",湘潭市:"xiangtan",常德市:"changde",郴州市:"chenzhou",衡阳市:"henyang",怀化市:"huaihua",娄底市:"loudi",邵阳市:"shaoyang",益阳市:"yiyang",永州市:"yongzhou",岳阳市:"yueyang",张家界市:"zhangjiajie",湘西土家族苗族自治州:"xiangxi"},t={type:"group",id:a,left:l.leftCur+l.leftPlus,top:l.top+3,children:[{type:"polyline",left:-90,top:-5,shape:{points:M},style:{stroke:"#fff",key:a},onclick:function(){var r=this.style.key;i.resetOption(myChart,c,r)}},{type:"text",left:-68,top:"middle",style:{text:a,textAlign:"center",fill:f.textColor,font:f.font},onclick:function(){var r=this.style.text;i.resetOption(myChart,c,r)}},{type:"text",left:-68,top:10,style:{name:a,text:e[a]?e[a].toUpperCase():"",textAlign:"center",fill:f.textColor,font:'12px "Microsoft YaHei", sans-serif'},onclick:function(){var r=this.style.name;i.resetOption(myChart,c,r)}}]};return l.leftCur+=l.leftPlus,t},initSeriesData:function(a){console.log(a,"22222222222");for(var e=[],t=0;t<a.length;t++){var r=h[a[t].name];r&&e.push({name:a[t].name,value:r.concat(a[t].value,a[t].level)})}return e},zoomAnimation:function(){var a=null,e=function(t){a||(a=t),a=a+t,myChart.setOption({geo:{zoom:a}}),a<1&&window.requestAnimationFrame(function(){e(.2)})};window.requestAnimationFrame(function(){e(.2)})}},N=function(a){for(var e=[],t=0;t<a.length;t++){var r=a[t],n=r[0].name,u=h[r[0].name],o=[112.945358,28.234451];u&&o&&e.push([{name:n,coord:u,value:r[0].value},{coord:o}])}return e},s=function(a){for(var e=[],t=0;t<a.length;t++){var r=a[t],n=r.name,u=a[0].value.slice(0,2),o=r.value.slice(0,2);u&&o&&e.push([{name:n,coord:u,value:r.value[2]},{coord:o}])}return e},P=[];[["长沙市",v]].forEach(function(a,e){console.log(a),P.push({type:"lines",zlevel:1,effect:{show:!0,period:3,trailLength:.7,color:"#fff",symbolSize:3},lineStyle:{normal:{width:.1,opacity:.2,curveness:.3}},data:N(a[1])},{type:"effectScatter",coordinateSystem:"geo",zlevel:2,rippleEffect:{period:4,brushType:"stroke",scale:4},label:{normal:{show:!1,position:"right",offset:[5,0],formatter:function(t){return t.data.name},fontSize:19},emphasis:{show:!0}},symbol:"circle",symbolSize:function(t){return 10+t[2]*0},itemStyle:{normal:{show:!1,color:"#f00"}},data:a[1].map(function(t){return{name:t[0].name,value:h[t[0].name].concat([t[0].value])}})},{type:"scatter",coordinateSystem:"geo",zlevel:2,rippleEffect:{period:4,brushType:"stroke",scale:4},label:{normal:{show:!1,position:"right",color:"#0f0",formatter:"{b}",textStyle:{color:"#0f0"}},emphasis:{show:!1,color:"#f60"}}})});var c={tooltip:{trigger:"item",backgroundColor:"rgba(0,0,0,0)",formatter:function(a){if(console.log(a,"item!!!!"),a.componentSubType==="lines"){var e="";return e='<div style="background:#fff;border-radius:10px;padding-top:10px;box-shadow:0 0 10px #666"><div style="color:#fff;height:20px;border-radius:6px;font-size:12px;line-height:20px;background-color:#5861a2;text-align:center;margin:0 2px;">'+a.data.name+'</div><div style="text-align:center;color:#494949;padding:8px 6px"><span style="font-size:18px;font-weight:bold;">总测试设备：'+a.data.value+" </span></div></div>",e}else if(a.componentSubType==="effectScatter"){var t="";return t='<div style="background:#fff;border-radius:10px;padding-top:10px;box-shadow:0 0 10px #666"><div style="color:#fff;height:20px;border-radius:6px;font-size:12px;line-height:20px;background-color:#5861a2;text-align:center;margin:0 2px;">'+a.data.name+'</div><div style="text-align:center;color:#494949;padding:8px 6px"><span style="font-size:18px;font-weight:bold;">总测试设备：'+a.data.value[2]+" </span></div></div>",t}else if(a.componentSubType==="scatter"){var r="";return r='<div style="background:#fff;border-radius:10px;padding-top:10px;box-shadow:0 0 10px #666"><div style="color:#fff;height:20px;border-radius:6px;font-size:12px;line-height:20px;background-color:#5861a2;text-align:center;margin:0 2px;">'+a.data.name+'</div><div style="text-align:center;color:#494949;padding:8px 6px"><span style="font-size:18px;font-weight:bold;">总测试设备：'+a.data.value[2]+" </span></div></div>",r}}},backgroundColor:"#013954",graphic:[{type:"group",left:l.left,top:l.top-4,children:[{type:"line",left:0,top:-20,shape:{x1:0,y1:0,x2:85,y2:0},style:{stroke:f.lineColor}},{type:"line",left:0,top:20,shape:{x1:0,y1:0,x2:85,y2:0},style:{stroke:f.lineColor}}]},{id:d[p],type:"group",left:l.left+2,top:l.top,children:[{type:"polyline",left:90,top:-12,shape:{points:M},style:{stroke:"transparent",key:d[0]},onclick:function(){var a=this.style.key;console.log(a,"111111"),i.resetOption(myChart,c,a)}},{type:"text",left:0,top:"middle",style:{text:d[0]==="湖南"?"湖南省":d[0],textAlign:"center",fill:f.textColor,font:f.font},onclick:function(){i.resetOption(myChart,c,"湖南")}},{type:"text",left:0,top:10,style:{text:"HUNAN",textAlign:"center",fill:f.textColor,font:'12px "Microsoft YaHei", sans-serif'},onclick:function(){i.resetOption(myChart,c,"湖南")}}]}],visualMap:{min:0,max:1,calculable:!0,show:!1,color:["#f44336","#fc9700","#ffde00","#ffde00","#00eaff"],textStyle:{color:"#fff"}},geo:{map:"湖南",layoutCenter:["55%","50%"],layoutSize:"109%",label:{normal:{show:!0,textStyle:{color:"#fff"}},emphasis:{textStyle:{color:"#fff"}}},roam:!0,mapLocation:{width:"110%",height:"97%"},itemStyle:{normal:{borderColor:"rgba(147, 235, 248, 1)",borderWidth:1,areaColor:{type:"radial",x:.5,y:.5,r:.8,colorStops:[{offset:0,color:"rgba(147, 235, 248, 0)"},{offset:1,color:"rgba(147, 235, 248, .2)"}],globalCoord:!1},shadowColor:"rgba(128, 217, 248, 1)",shadowOffsetX:-2,shadowOffsetY:2,shadowBlur:10},emphasis:{itemStyle:{areaColor:"#FFD181",borderColor:"#404a59",borderWidth:1}}}},series:P};myChart.setOption(c),myChart.on("click",function(a){console.log(a);var e=this;if(y[a.name]){var t=y[a.name];$.get(t,function(r){curGeoJson=r,echarts.registerMap(a.name,r),i.resetOption(e,c,a.name)})}})});

var uploadedDataURL="/asset/get/s/data-1585799654003-46R-3f-c3.json",geoGpsMap={1:[116.415,39.915],2:[116.448,39.935],3:[116.455,39.915],4:[116.435,39.925],基站1:[116.415,39.915],基站2:[116.448,39.935],基站3:[116.455,39.915],控制中心:[116.435,39.925]},l1={主卧:[116.409,39.928]},l2={书房控制:[116.428,39.939]},l3={卫生间控制:[116.448,39.939]},l4={客厅控制:[116.426,39.918]},l5={次卧控制:[116.448,39.92]},l6={楼梯控制:[116.443,39.911]},l7={厨房控制:[116.448,39.905]},zhuwo={主卧控制:[116.409,39.928]},geoCoordMap={客厅1:[116.41,39.9036],客厅2:[116.43,39.918],主卧1:[116.409,39.921],主卧2:[116.409,39.935],书房:[116.432,39.939],卫生间:[116.4516,39.939],客厅3:[116.4516,39.9306],次卧:[116.4516,39.92],楼梯:[116.447,39.911],厨房:[116.4516,39.905]},geoCoordMap001={客厅1:[116.41,39.9036],客厅2:[116.43,39.918],主卧1:[116.409,39.921],主卧2:[116.409,39.935]},geoCoordMap002={书房:[116.432,39.939],卫生间:[116.4516,39.939],客厅3:[116.4516,39.9306]},geoCoordMap003={次卧:[116.4516,39.92],楼梯:[116.447,39.911],厨房:[116.4516,39.905]},geoCoordMap004={基站1:[116.415,39.915],基站2:[116.448,39.935],基站3:[116.455,39.915]},d1={客厅1:20,客厅2:25,主卧1:17,主卧2:19,书房:13,卫生间:22,客厅3:11,次卧:9,楼梯:29,厨房:38,基站1:40,基站2:45,基站3:37},d2={客厅1:40,客厅2:45,主卧1:37,主卧2:39,书房:23,卫生间:80,客厅3:56,次卧:39,楼梯:29,厨房:68},d3={客厅2:5,主卧2:3,书房:2,卫生间:0,客厅3:0,次卧:3,楼梯:2,厨房:0},d4={客厅1:40,客厅2:45,主卧1:37,主卧2:39,书房:53,卫生间:60,客厅3:56,次卧:39,楼梯:29,厨房:68},d5={客厅1:40,客厅2:45,主卧1:37,主卧2:39,书房:23,卫生间:80,客厅3:56,次卧:39,楼梯:29,厨房:68},database=[{name:"基站1",value:0},{name:"基站2",value:0},{name:"基站3",value:0},{name:"控制中心",value:0}],da1=[{name:"主卧",value:0}],da2=[{name:"书房控制",value:0}],da3=[{name:"卫生间控制",value:0}],da4=[{name:"客厅控制",value:0}],da5=[{name:"次卧控制",value:0}],da6=[{name:"楼梯控制",value:0}],da7=[{name:"厨房控制",value:0}],colors=[["#1DE9B6","#F46E36","#04B9FF","#5DBD32","#FFC809","#FB95D5","#BDA29A","#6E7074","#546570","#C4CCD3"],["#37A2DA","#67E0E3","#32C5E9","#9FE6B8","#FFDB5C","#FF9F7F","#FB7293","#E062AE","#E690D1","#E7BCF3","#9D96F5","#8378EA","#8378EA"],["#DD6B66","#759AA0","#E69D87","#8DC1A9","#EA7E53","#EEDD78","#73A373","#73B9BC","#7289AB","#91CA8C","#F49F42"]],colorIndex=0;$(function(){var c=["温度（℃）","湿度（%）","振动(g)","烟雾（百ppm）","光线（百lx）"],v=["空调调温","加湿器/窗户协调","门锁锁定","紧急消防","照明系统"],l=[[],[],[],[],[]],w=[],S=[],x=[],g=[],U=[[10,12,13,12,14,14,16,17,18,20,22,26,27,26,23,20,18,18,16,16,14,13,12,10],[68,67,66,63,61,55,53,48,46,44,42,42,36,34,36,37,38,42,46,44,58,62,66,68],[1,1,1,1,1,1,1,2,3,2,1,1,1,1,1,1,3,3,1,3,3,1,1,1],[56,59,60,62,56,50,40,42,38,38,39,38,40,42,38,37,34,35,38,44,46,50,54,56],[1,1,2,1,5,10,20,24,30,32,32,34,38,40,40,38,32,25,32,32,5,1,1,1]],W=[[11,12,14,12,15,13,16,16,16,21,22,24,22,24,23,21,19,18,15,14,15,13,12,11],[62,64,66,65,62,58,54,49,45,44,41,40,32,36,36,39,38,40,46,48,52,60,63,61],[1,1,1,2,1,1,1,2,1,2,1,1,3,1,1,1,3,2,1,1,3,1,2,1],[58,59,62,62,54,50,44,42,34,33,35,38,40,44,38,35,32,35,33,40,46,53,56,54],[1,1,1,1,6,12,20,22,30,33,32,35,38,42,40,37,34,28,32,33,10,1,1,1]],m=[[],[],[],[],[]],O=[],P=[],G=[],X=[];for(var u in geoCoordMap001)O.push({year:"温度",name:u,value:d1[u]});for(var u in geoCoordMap002)P.push({year:"温度",name:u,value:d1[u]});for(var u in geoCoordMap003)G.push({year:"温度",name:u,value:d1[u]});for(var u in geoCoordMap004)X.push({year:"温度",name:u,value:d1[u]});for(var u in geoCoordMap)l[0].push({year:"温度",name:u,value:d1[u]}),l[1].push({year:"湿度",name:u,value:d2[u]}),l[2].push({year:"振动",name:u,value:d3[u]}),l[3].push({year:"烟雾",name:u,value:d4[u]}),l[4].push({year:"光线",name:u,value:d5[u]});for(var C=[],y=[],d=[],b=[],z=[45,80,10,80,50],B=[-5,15,0,20,0],F=[],a=0;a<l.length;a++){l[a].sort(function(D,i){return D.value-i.value}),g.push([]),w.push([]),S.push([]),x.push([]),m.push([]),C[a]=0,y[a]=0,F[a]=0,d[a]=0,b[a]=1e3;for(var n=0;n<l[a].length;n++)l[a][n].name=="主卧1"?m[a][0]=l[a][n].value:l[a][n].name=="主卧2"?m[a][1]=l[a][n].value:l[a][n].name=="书房"?m[a][2]=l[a][n].value:l[a][n].name=="卫生间"?m[a][3]=l[a][n].value:l[a][n].name=="客厅1"?m[a][4]=l[a][n].value:l[a][n].name=="客厅2"?m[a][5]=l[a][n].value:l[a][n].name=="客厅3"?m[a][6]=l[a][n].value:l[a][n].name=="次卧"?m[a][7]=l[a][n].value:l[a][n].name=="楼梯"?m[a][8]=l[a][n].value:l[a][n].name=="厨房"&&(m[a][9]=l[a][n].value),l[a][n].value>=-100?(C[a]+=l[a][n].value,y[a]++):S[a].push(l[a][n].name),l[a][n].value>=d[a]&&(d[a]=l[a][n].value),l[a][n].value<=b[a]&&(b[a]=l[a][n].value),(l[a][n].value<B[a]||l[a][n].value>z[a])&&(F[a]++,x[a].push(l[a][n].name)),g[a].push(l[a][n].value),w[a].push(l[a][n].name)}$.getJSON(uploadedDataURL,function(N){echarts.registerMap("home",N);var D=function(e){for(var o=[],t=0;t<e.length;t++){var s=geoCoordMap[e[t].name];s&&o.push({name:e[t].name,value:s.concat(e[t].value)})}return o},i=function(e){for(var o=[],t=0;t<e.length;t++){var s=geoGpsMap[e[t].name];s&&o.push({name:e[t].name,value:s.concat(e[t].value)})}return o},J=[i(database),i(database.sort(function(e,o){return o.value-e.value}).slice(0,6))],E=function(e){for(var o=[],t=0;t<e.length;t++){var s=l1[e[t].name];s&&o.push({name:e[t].name,value:s.concat(e[t].value)})}return o},V=[E(da1),E(da1.sort(function(e,o){return o.value-e.value}).slice(0,6))],A=function(e){for(var o=[],t=0;t<e.length;t++){var s=l2[e[t].name];s&&o.push({name:e[t].name,value:s.concat(e[t].value)})}return o},Y=[A(da2),A(da2.sort(function(e,o){return o.value-e.value}).slice(0,6))],L=function(e){for(var o=[],t=0;t<e.length;t++){var s=l3[e[t].name];s&&o.push({name:e[t].name,value:s.concat(e[t].value)})}return o},q=[L(da3),L(da3.sort(function(e,o){return o.value-e.value}).slice(0,6))],M=function(e){for(var o=[],t=0;t<e.length;t++){var s=l4[e[t].name];s&&o.push({name:e[t].name,value:s.concat(e[t].value)})}return o},K=[M(da4),M(da4.sort(function(e,o){return o.value-e.value}).slice(0,6))],k=function(e){for(var o=[],t=0;t<e.length;t++){var s=l5[e[t].name];s&&o.push({name:e[t].name,value:s.concat(e[t].value)})}return o},Q=[k(da5),k(da5.sort(function(e,o){return o.value-e.value}).slice(0,6))],T=function(e){for(var o=[],t=0;t<e.length;t++){var s=l6[e[t].name];s&&o.push({name:e[t].name,value:s.concat(e[t].value)})}return o},Z=[T(da6),T(da6.sort(function(e,o){return o.value-e.value}).slice(0,6))],R=function(e){for(var o=[],t=0;t<e.length;t++){var s=l7[e[t].name];s&&o.push({name:e[t].name,value:s.concat(e[t].value)})}return o},_=[R(da7),R(da7.sort(function(e,o){return o.value-e.value}).slice(0,6))],I=function(e,o){for(var t=[],s=0;s<e.length;s++){var f=e[s],h=geoCoordMap[f.name];debugger;var p=o;h&&p&&t.push([{coord:h,value:f.value},{coord:p}])}return t},H=function(e,o){for(var t=[],s=0;s<e.length;s++){var f=e[s],h=geoCoordMap004[f.name];debugger;var p=o;h&&p&&t.push([{coord:h,value:f.value},{coord:p}])}return t};optionXyMap01={timeline:{data:c,axisType:"category",autoPlay:!0,playInterval:3e3,left:"10%",right:"10%",bottom:"3%",width:"80%",label:{normal:{textStyle:{color:"#ddd"}},emphasis:{textStyle:{color:"#fff"}}},symbolSize:10,lineStyle:{color:"#555"},checkpointStyle:{borderColor:"#87CEEB",borderWidth:2},controlStyle:{showNextBtn:!0,showPrevBtn:!0,normal:{color:"#666",borderColor:"#666"},emphasis:{color:"#aaa",borderColor:"#aaa"}}},baseOption:{animation:!0,animationDuration:1e3,animationEasing:"cubicInOut",animationDurationUpdate:1e3,animationEasingUpdate:"cubicInOut",grid:[{left:"65%",top:"34.5%",bottom:"44.5%",width:"20%"},{gridindex:1,left:"65%",right:"3%",top:"65%",bottom:"10%",containLabel:!0}],tooltip:{trigger:"axis",axisPointer:{type:"shadow",shadowStyle:{color:"#aaa"}}},toolbox:{show:!0,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["bar","line"]},restore:{show:!0},saveAsImage:{show:!0}}},legend:[{data:["历史平均数据1","历史平均数据2"],x:"75%",y:"60%",textStyle:{color:"#fff"}},{data:["基站","传感器","传输路线"],top:"10%",left:"35%",textStyle:{color:"#fff"}},{icon:"roundRect",orient:"vertical",top:"7%",left:"5%",data:[{name:"主卧"},{name:"书房控制"},{name:"卫生间控制"},{name:"客厅控制"},{name:"次卧控制"},{name:"楼梯控制"},{name:"厨房控制"}],selected:{主卧:!1,书房控制:!1,客厅控制:!1,次卧控制:!1,楼梯控制:!1,厨房控制:!1,卫生间控制:!1},textStyle:{color:"#fff"}}],geo:{show:!0,map:"home",roam:!0,zoom:.8,center:[116.453,39.92],label:{emphasis:{show:!1}},itemStyle:{normal:{borderColor:"rgba(147, 235, 248, 1)",borderWidth:1,areaColor:{type:"radial",x:.5,y:.5,r:.8,colorStops:[{offset:0,color:"rgba(147, 235, 248, 0)"},{offset:1,color:"rgba(147, 235, 248, .2)"}],globalCoord:!1},shadowColor:"rgba(128, 217, 248, 1)",shadowOffsetX:-2,shadowOffsetY:2,shadowBlur:10},emphasis:{areaColor:"#389BB7",borderWidth:0}}}},options:[]};for(var r=0;r<c.length;r++)optionXyMap01.options.push({backgroundColor:"#013954",title:[{text:"传感器布设平面图",left:"16%",top:"5%",textStyle:{color:"#fff",fontSize:25}},{id:"statistic",text:c[r]+"数据统计情况",left:"60%",top:"5%",textStyle:{color:"#fff",fontSize:25}},{text:"平均值："+C[r]/y[r],left:"60%",top:"14.5%",textStyle:{color:"#90ee90",fontSize:15}},{text:"最大值："+d[r],left:"72%",top:"14.5%",textStyle:{color:"#FF4500",fontSize:15}},{text:"最小值："+b[r],left:"84%",top:"14.5%",textStyle:{color:"#87CEFF",fontSize:15}},{text:"未使用的传感器："+(l[r].length-y[r]),left:"60%",top:"17.5%",textStyle:{color:"#FF7F00",fontSize:15},extraCssText:"width:120px; white-space:pre-wrap"},{text:"数据异常传感器："+F[r],left:"76%",top:"17.5%",textStyle:{color:"#9370DB",fontSize:15},extraCssText:"width:120px; white-space:pre-wrap"},{text:"(数据正常范围："+B[r]+"~"+z[r]+")",left:"60%",top:"20.5%",textStyle:{color:"#FFA54F",fontSize:15},extraCssText:"width:120px; white-space:pre-wrap"},{text:"未使用的传感器："+S[r],left:"60%",top:"23.5%",textStyle:{color:"#FF7F00",fontSize:15},extraCssText:"width:120px; white-space:pre-wrap"},{text:"数据异常传感器："+x[r],left:"60%",top:"26.5%",textStyle:{color:"#9370DB",fontSize:15},extraCssText:"width:120px; white-space:pre-wrap"}],visualMap:{min:B[r],max:z[r],calculable:!0,text:["High","Low"],inRange:{color:["#50a3ba","#eac736","#d94e5d"]},padding:5,right:"5%",bottom:"40%",textStyle:{color:"#fff"}},xAxis:[{type:"value",scale:!0,position:"top",min:0,boundaryGap:!1,splitLine:{show:!1},axisLine:{show:!1},axisTick:{show:!1},axisLabel:{margin:2,textStyle:{color:"#fff"}}},{gridIndex:1,type:"category",boundaryGap:!1,axisLabel:{margin:2,textStyle:{color:"#fff"}},data:["0时","1时","2时","3时","4时","5时","6时","7时","8时","9时","10时","11时","12时","13时","14时","15时","16时","17时","18时","19时","20时","21时","22时","23时"]}],yAxis:[{type:"category",nameGap:16,axisLine:{show:!0,lineStyle:{color:"#ddd"}},axisTick:{show:!1,lineStyle:{color:"#ddd"}},axisLabel:{interval:0,textStyle:{color:"#ddd"}},data:w[r]},{gridIndex:1,type:"value",axisLabel:{formatter:"{value} ",textStyle:{color:"#ddd"}}}],series:[{type:"map",map:"home",geoIndex:0,aspectScale:.75,showLegendSymbol:!0,label:{normal:{show:!1},emphasis:{show:!1,textStyle:{color:"#fff"}}},roam:!0,itemStyle:{normal:{areaColor:"#031525",borderColor:"#FFFFFF"},emphasis:{areaColor:"#2B91B7"}},animation:!1,data:l},{name:"传感器",type:"effectScatter",coordinateSystem:"geo",data:D(l[r].sort(function(e,o){return o.value-e.value}).slice(0,20)),symbolSize:function(e){return(e[2]*40+1200)/180},showEffectOn:"render",rippleEffect:{brushType:"stroke"},hoverAnimation:!0,label:{normal:{formatter:"{b}",position:"right",show:!0}},itemStyle:{normal:{color:colors[colorIndex][r],shadowBlur:10,shadowColor:colors[colorIndex][r]}},zlevel:1},{name:"基站",type:"effectScatter",coordinateSystem:"geo",data:i(database.sort(function(e,o){return o.value-e.value}).slice(0,20)),symbol:"arrow",symbolSize:10,showEffectOn:"render",rippleEffect:{brushType:"stroke"},hoverAnimation:!0,label:{normal:{formatter:"{b}",position:"right",show:!0}},itemStyle:{normal:{color:colors[colorIndex][r],shadowBlur:10,shadowColor:"#2f4554"},emphasis:{color:"#fff",shadowBlur:10,shadowColor:"#cfff"}},zlevel:1},{name:"主卧",type:"effectScatter",coordinateSystem:"geo",data:E(da1.sort(function(e,o){return o.value-e.value}).slice(0,20)),symbol:"roundRect",symbolSize:10,label:{normal:{formatter:"{b}"+v[r]+"：开",position:"bottom",show:!0},emphasis:{formatter:"{b}"+c[r]+"："+m[r][0],position:"bottom",show:!0}},itemStyle:{normal:{color:"#2f4554",shadowBlur:10,shadowColor:"#2f4554"},emphasis:{color:"#c23531",shadowBlur:10,shadowColor:"#c23531"}},zlevel:1},{name:"书房控制",type:"effectScatter",coordinateSystem:"geo",data:A(da2.sort(function(e,o){return o.value-e.value}).slice(0,20)),symbol:"roundRect",symbolSize:10,label:{normal:{formatter:"{b}"+v[r]+"：开",position:"bottom",show:!0},emphasis:{formatter:"{b}"+c[r]+"："+m[r][2],position:"bottom",show:!0}},itemStyle:{normal:{color:"#2f4554",shadowBlur:10,shadowColor:"#2f4554"},emphasis:{color:"#c23531",shadowBlur:10,shadowColor:"#c23531"}},zlevel:1},{name:"卫生间控制",type:"effectScatter",coordinateSystem:"geo",data:L(da3.sort(function(e,o){return o.value-e.value}).slice(0,20)),symbol:"roundRect",symbolSize:10,label:{normal:{formatter:"{b}"+v[r]+"：开",position:"bottom",show:!0},emphasis:{formatter:"{b}"+c[r]+"："+m[r][0],position:"bottom",show:!0}},itemStyle:{normal:{color:"#2f4554",shadowBlur:10,shadowColor:"#2f4554"},emphasis:{color:"#c23531",shadowBlur:10,shadowColor:"#c23531"}},zlevel:1},{name:"客厅控制",type:"effectScatter",coordinateSystem:"geo",data:M(da4.sort(function(e,o){return o.value-e.value}).slice(0,20)),symbol:"roundRect",symbolSize:10,label:{normal:{formatter:"{b}"+v[r]+"：开",position:"bottom",show:!0},emphasis:{formatter:"{b}"+c[r]+"："+m[r][0],position:"bottom",show:!0}},itemStyle:{normal:{color:"#2f4554",shadowBlur:10,shadowColor:"#2f4554"},emphasis:{color:"#c23531",shadowBlur:10,shadowColor:"#c23531"}},zlevel:1},{name:"次卧控制",type:"effectScatter",coordinateSystem:"geo",data:k(da5.sort(function(e,o){return o.value-e.value}).slice(0,20)),symbol:"roundRect",symbolSize:10,label:{normal:{formatter:"{b}"+v[r]+"：开",position:"bottom",show:!0},emphasis:{formatter:"{b}"+c[r]+"："+m[r][0],position:"bottom",show:!0}},itemStyle:{normal:{color:"#2f4554",shadowBlur:10,shadowColor:"#2f4554"},emphasis:{color:"#c23531",shadowBlur:10,shadowColor:"#c23531"}},zlevel:1},{name:"楼梯控制",type:"effectScatter",coordinateSystem:"geo",data:T(da6.sort(function(e,o){return o.value-e.value}).slice(0,20)),symbol:"roundRect",symbolSize:10,label:{normal:{formatter:"{b}"+v[r]+"：开",position:"bottom",show:!0},emphasis:{formatter:"{b}"+c[r]+"："+m[r][0],position:"bottom",show:!0}},itemStyle:{normal:{color:"#2f4554",shadowBlur:10,shadowColor:"#2f4554"},emphasis:{color:"#c23531",shadowBlur:10,shadowColor:"#c23531"}},zlevel:1},{name:"厨房控制",type:"effectScatter",coordinateSystem:"geo",data:R(da7.sort(function(e,o){return o.value-e.value}).slice(0,20)),symbol:"roundRect",symbolSize:10,label:{normal:{formatter:"{b}"+v[r]+"：开",position:"bottom",show:!0},emphasis:{formatter:"{b}"+c[r]+"："+m[r][0],position:"bottom",show:!0}},itemStyle:{normal:{color:"#2f4554",shadowBlur:10,shadowColor:"#2f4554"},emphasis:{color:"#c23531",shadowBlur:10,shadowColor:"#c23531"}},zlevel:1},{name:"传输路线",type:"lines",zlevel:2,effect:{show:!0,period:4,trailLength:.02,symbol:"arrow",symbolSize:3},lineStyle:{normal:{color:colors[colorIndex][r],width:.1,opacity:.5,curveness:.3}},data:I(O,geoGpsMap[Math.ceil(1)])},{name:"传输路线",type:"lines",zlevel:2,effect:{show:!0,period:4,trailLength:.02,symbol:"arrow",symbolSize:3},lineStyle:{normal:{color:colors[colorIndex][r],width:.1,opacity:.5,curveness:.3}},data:I(P,geoGpsMap[Math.ceil(2)])},{name:"传输路线",type:"lines",zlevel:2,effect:{show:!0,period:4,trailLength:.02,symbol:"arrow",symbolSize:3},lineStyle:{normal:{color:colors[colorIndex][r],width:.1,opacity:.5,curveness:.3}},data:I(G,geoGpsMap[Math.ceil(3)])},{name:"传输路线",type:"lines",zlevel:2,effect:{show:!0,period:4,trailLength:.02,symbol:"arrow",symbolSize:3},lineStyle:{normal:{color:colors[colorIndex][r],width:.1,opacity:.5,curveness:.3}},data:H(X,geoGpsMap[Math.ceil(4)])},{zlevel:1.5,type:"bar",symbol:"none",itemStyle:{normal:{color:colors[colorIndex][r]}},data:g[r]},{xAxisIndex:1,yAxisIndex:1,name:"历史平均数据1",type:"line",lineStyle:{normal:{color:"#4ea397"}},data:U[r],markPoint:{data:[{type:"max",name:"最大值",symbolSize:40},{type:"min",name:"最小值",symbolSize:20}],itemStyle:{normal:{color:"#d0648a"}}},markLine:{data:[{type:"average",name:"平均值"}]}},{xAxisIndex:1,yAxisIndex:1,name:"历史平均数据2",type:"line",lineStyle:{normal:{color:"#4ea397"}},data:W[r],markPoint:{data:[{type:"max",name:"最大值",symbolSize:40},{type:"min",name:"最小值",symbolSize:20}],itemStyle:{normal:{color:"#d0648a"}}},markLine:{data:[{type:"average",name:"平均值"}]}}]});myChart.setOption(optionXyMap01)})});

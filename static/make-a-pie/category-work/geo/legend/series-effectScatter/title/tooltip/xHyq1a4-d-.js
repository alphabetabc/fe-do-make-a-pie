var uploadedDataURL="/asset/get/s/data-1482909818685-H17FOkZSl.json";let data=[{name:"长沙市",value:12},{name:"株洲市",value:12},{name:"湘潭市",value:12},{name:"岳阳市",value:14},{name:"益阳市",value:27},{name:"常德市",value:25},{name:"娄底市",value:26},{name:"衡阳市",value:26},{name:"郴州市",value:26},{name:"永州市",value:27},{name:"邵阳市",value:27},{name:"怀化市",value:27},{name:"湘西土家族苗族自治州",value:28},{name:"张家界市",value:29}],geoCoordMap={长沙市:[113,28.21],株洲市:[113.09,27.51],湘潭市:[112.53,27.52],岳阳市:[113.06,29.22],益阳市:[112.2,28.36],常德市:[111.69,29.05],娄底市:[111.59,27.44],衡阳市:[112.37,26.53],郴州市:[113.02,25.46],永州市:[111.37,26.13],邵阳市:[111.28,27.14],怀化市:[109.58,27.33],湘西土家族苗族自治州:[109.73,28.32],张家界市:[110.29,29.08]},convertData=function(a){let t=[];for(let e=0;e<a.length;e++){let l=geoCoordMap[a[e].name];l&&t.push({name:a[e].name,value:l.concat(a[e].value)})}return t},left=!1,top=!1,priority="top",config={ecBoxId:"chart-panel",lineColor:"#fff",L1:{time:.3,long:40},L2:{time:.3,long:40},text:{time:.5,text:"",font:"14px Arial",color:"#fff",padding:[10,10],width:120,height:60,lineHeight:24,backgroundColor:"rgba(50, 50, 50, 0.8)"}};option={title:{top:10,text:"引导线tooltip轮播动画效果",subtext:"点击查看github最新代码",sublink:"https://github.com/Mying666/myEcTooltip",subtextStyle:{color:"#ccc"},left:"center",textStyle:{color:"#fff"}},backgroundColor:"#404a59",tooltip:{trigger:"item",triggerOn:"click",backgroundColor:"transparent",alwaysShowContent:!0,position(a){return getPosOrSize("pos",a)},formatter(a,t,e){canvasAnimation(a);let l=getPosOrSize("size");return`<canvas id="tCanvas" width="${l.width}" height="${l.height}">123</canvas>`}},legend:{show:!1},geo:{map:"china",label:{emphasis:{show:!1}},roam:!1,itemStyle:{normal:{areaColor:"#323c48",borderColor:"#111"},emphasis:{areaColor:"#2a333d"}}},series:[{name:"Tooltip Test",type:"effectScatter",coordinateSystem:"geo",data:convertData(data.sort(function(a,t){return t.value-a.value}).slice(0,50)),symbolSize:function(a){return a[2]/5},showEffectOn:"render",rippleEffect:{brushType:"stroke"},hoverAnimation:!0,label:{normal:{formatter:"{b}",position:"right",show:!0}},itemStyle:{normal:{color:"#f4e925",shadowBlur:10,shadowColor:"#333"}},zlevel:1}]};const canvasAnimation=a=>{setTimeout(function(){config.text.text=`地点：${a.name}
数量：${a.value[2]}`,new myTooltip("tCanvas",config)},0)},getPosOrSize=(a,t)=>{let e=config.L1.long*Math.sin(Math.PI/4),l=e+config.L2.long+config.text.width,n=e+config.text.height/2;if(a==="size")return config.width=l,config.height=n,{width:l,height:n};{let i=document.getElementById(config.ecBoxId),s=i.offsetWidth,h=i.offsetHeight,r=t[0],o=t[1];return left=!1,r+l>=s/1.2&&(r=r-l-5,left=!0),priority==="top"?(top=!0,o=o-n-5,o<=0&&(o=t[1],top=!1),[r,o]):(top=!1,o+n>=h&&(o=o-n-5,top=!0),[r,o])}};class myTooltip{constructor(t,e){this.config=e,this.totalTime=0,this.stage=new createjs.Stage(t),this.timeline=new TimelineMax({repeat:0}),this.g=new createjs.Graphics,this.lineShape=new createjs.Shape(this.g),this.textShape=new createjs.Shape,this.stage.addChild(this.lineShape,this.textShape),this.init(),this.begin(),this.update()}init(){this.start=[0,0],left&&(this.start[0]=this.config.width),top&&(this.start[1]=this.config.height)}begin(){this.L1(),this.L2(),this.addText()}L1(){let t=this,e=t.config,l=new TimelineMax,n={s:0},i=e.L1.long*Math.sin(Math.PI/4);left?top?this.L1End=[t.start[0]-i,t.start[1]-i]:this.L1End=[t.start[0]-i,t.start[1]+i]:top?this.L1End=[i,t.start[1]-i]:this.L1End=[i,i],l.to(n,e.L1.time,{s:1,onUpdate(){let s=n.s;left?top?t.g.c().s(e.lineColor).mt(...t.start).lt(t.start[0]-i*s,t.start[1]-i*s):t.g.c().s(e.lineColor).mt(...t.start).lt(t.start[0]-i*s,t.start[1]+i*s):top?t.g.c().s(e.lineColor).mt(...t.start).lt(i*s,t.start[1]-i*s):t.g.c().s(e.lineColor).mt(...t.start).lt(i*s,i*s),t.update()}}),this.timeline.add(l,this.totalTime),this.totalTime+=e.L1.time}L2(){let t=this,e=t.config,l=new TimelineMax,n={s:0};l.to(n,e.L2.time,{s:1,onUpdate(){let i=n.s;left?t.g.c().s(e.lineColor).mt(...t.start).lt(...t.L1End).lt(t.L1End[0]-e.L2.long*i,t.L1End[1]):t.g.c().s(e.lineColor).mt(...t.start).lt(...t.L1End).lt(t.L1End[0]+e.L2.long*i,t.L1End[1]),t.update()}}),this.timeline.add(l,this.totalTime),this.totalTime+=e.L2.time}addText(){let t=this,e=t.config,l=new TimelineMax,n={s:0},i=[t.L1End[0]+e.L2.long,t.L1End[1]];left&&(i=[t.L1End[0]-e.L2.long,t.L1End[1]]),l.to(n,e.text.time,{s:1,onStart(){let s=0,h=0;left?s=i[0]-e.text.width:s=i[0],t.g.c().s(e.lineColor).mt(...t.start).lt(...t.L1End).lt(...i),t.text=new createjs.Text(e.text.text,e.text.font,e.text.color),t.text.alpha=0,t.text.lineHeight=e.text.lineHeight,t.text.x=s+e.text.padding[0],t.text.y=i[1]-e.text.height/2+e.text.padding[1],t.stage.addChild(t.text),t.textShape.graphics.c().f(e.text.backgroundColor).rr(s,i[1]-e.text.height/2,e.text.width,e.text.height,5),t.textShape.alpha=0,t.update()},onUpdate(){t.text.alpha=n.s,t.textShape.alpha=n.s,t.update()}}),this.timeline.add(l,this.totalTime)}update(){this.stage.update()}}let EC=echarts.getInstanceByDom(document.getElementById("chart-panel"));var index=0;window.addEventListener("resize",a=>{let t=document.getElementById("tCanvas");t&&(t.style.display="none")});

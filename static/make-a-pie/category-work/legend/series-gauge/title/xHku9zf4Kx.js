var uploadedDataURL="/asset/get/s/data-1495173075713-rJ20wZ3gW.json",data=[{q:[{x:"T",id:"1",z:"13.87",t:"201601",time:" ",color:[[.166,"#91c7ae"],[.5,"#63869e"],[.635,"#EFC631"],[1,"#c23531"]],scale:[0,2]}]},{q:[{x:"T2",id:"1",z:"72.93",t:"201601",time:" ",color:[[.166,"#91c7ae"],[.5,"#63869e"],[.635,"#EFC631"],[1,"#c23531"]],scale:[0,2]}]}];obj=createGaugeOption(data,"q",["x"],"z",["r","time"],"color","scale"),setInterval(function(){option.series[0].data[0].value=(Math.random()*2).toFixed(2)-0,myChart.setOption(option,!0),option.series[1].data[0].value=(Math.random()*2).toFixed(2)-0,myChart.setOption(option,!0)},1e3),option={title:{text:"仪表图-内外盘"},legend:obj.legend,series:obj.series};function createGaugeOption(datas,colName,legColName,dataColName,categoryColName,colorData,scaleData){console.log(JSON.stringify(datas));for(var obj={},series=new Array,legs=new Array,rows=new Array,cols=new Array,n=0;n<datas.length;n++)for(var data=datas[n],d=eval("data."+colName),i=0;i<d.length;i++){var rowname=ArrToStr(d[i],categoryColName[0]),colname=ArrToStr(d[i],categoryColName[1]);$.inArray(rowname,rows)<0&&rows.push(rowname),$.inArray(colname,cols)<0&&cols.push(colname)}rows=rows.sort(fncSort),cols=cols.sort(fncSort);for(var n=0;n<datas.length;n++){var data=datas[n],d=eval("data."+colName);if(d.length>0){var lstr="";lstr=ArrToStr(d[0],legColName),legs.push({name:lstr,textStyle:{}})}for(var colors=d[0].color,size=0,i=0;i<d.length;i++){var rowname=ArrToStr(d[i],categoryColName[0]),colname=ArrToStr(d[i],categoryColName[1]),x=($.inArray(colname,cols)+1/(n+1))/(cols.length+1),y=($.inArray(rowname,rows)+1/(n+1))/(rows.length+1);size=1/rows.length-.05-.45*n;var offset=[];offset=[i,titleOffset(.15*(i+1),y,size)+"%"];var o={name:lstr,type:"gauge",z:100-n,min:d[0].scale[0],max:d[0].scale[1],splitNumber:10,startAngle:180,endAngle:0,radius:size*100+"%",axisLine:{show:!0,lineStyle:{color:colors,width:30}},axisTick:{length:38,lineStyle:{color:"auto"}},splitLine:{length:35,lineStyle:{color:"auto"}},pointer:{width:4},title:{show:!0,offsetCenter:offset,textStyle:{fontWeight:"bolder",fontSize:20,fontStyle:"italic"}},detail:{formatter:"{value}",offsetCenter:[0,""+-20*(3-n)+"%"]},data:[{value:eval("d[i]."+dataColName),name:colname}]};series.push(o)}}return obj.series=series,obj.legend={selectedMode:!1,data:colors},obj}function ReservedDecimal(r,a){var e=r+"";return e.indexOf(".")<0?e:e.substring(0,e.indexOf(".")+a+1)}function ArrToStr(data,arr){return eval("data."+arr)}function fncSort(r,a){var e=parseInt(r),t=parseInt(a);return e!=t?e-t:r-a}function isArray(r){return Object.prototype.toString.call(r)==="[object Array]"}function titleOffset(r,a,e){return(r-a*2)/e*80}

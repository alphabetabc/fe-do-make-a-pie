const rnd=()=>.2*Math.random()-.1+.003,randomWalk=e=>{const t=[1];for(let l=1;l<e;l++)t[l]=Number((t[l-1]*(1+rnd())).toFixed(2));return t},prices=randomWalk(500);var data=prices.map((e,t)=>[t,e]);const markPoints=[],findMax=(e,t)=>{const l=e.length,i=[],n=[];for(let o=0;o<=t;o++)i[o]=Array(l+1-o).fill(0),n[o]=Array(l+1-o).fill(0);for(let o=1;o<=t;o++){const a=o%2===0?-1:1;for(let s=l-1-o;s>=0;s--)i[o-1][s+1]+a*e[s]>i[o][s+1]?(i[o][s]=i[o-1][s+1]+a*e[s],n[o][s]=n[o-1][s+1]+","+s):(i[o][s]=i[o][s+1],n[o][s]=n[o][s+1])}return{value:i[t][0],idxs:n[t][0].split(",").slice(1).map(Number)}},ret=findMax(prices,10);console.log(ret);const sIdxs=ret.idxs.filter((e,t)=>t%2===0),bIdxs=ret.idxs.filter((e,t)=>t%2===1);bIdxs.forEach(e=>{markPoints.push({name:"买点",coord:[e,data[e][1]],symbolOffset:[0,10],itemStyle:{color:"red"}})}),sIdxs.forEach(e=>{markPoints.push({name:"卖点",coord:[e,data[e][1]],symbolOffset:[0,-10],itemStyle:{color:"yellowgreen"}})});const biIdxs=ret.idxs,biData=biIdxs.map(e=>[e,data[e][1]]);biIdxs.includes(0)||biData.push([0,data[0][1]]);const len=prices.length;biIdxs.includes(len-1)||biData.unshift([len-1,data[len-1][1]]),option={backgroundColor:"#080b30",title:{text:"quan-K",textStyle:{color:"#fff"}},tooltip:{trigger:"axis"},grid:{left:64,right:16,bottom:80},toolbox:{feature:{dataZoom:{yAxisIndex:"none"},restore:{},saveAsImage:{}}},xAxis:{axisLine:{show:!0,lineStyle:{color:"rgba(255,255,255,0.3)"}},axisTick:{show:!1},splitLine:{show:!1}},yAxis:{axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"rgba(255,255,255,0.3)"},splitLine:{show:!0,lineStyle:{color:"rgba(255,255,255,0.3)"}}},dataZoom:[{type:"inside",start:0,end:1e3},{start:0,end:1e3,handleIcon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4v1.3h1.3v-1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7V23h6.6V24.4z M13.3,19.6H6.7v-1.4h6.6V19.6z",handleSize:"80%",handleStyle:{color:"#fff",shadowBlur:3,shadowColor:"rgba(0, 0, 0, 0.6)",shadowOffsetX:2,shadowOffsetY:2}}],series:[{type:"line",lineStyle:{color:"#6c50f3"},showSymbol:!1,symbolSize:1,markPoint:{symbol:"circle",symbolSize:10,data:markPoints},data},{type:"line",lineStyle:{color:"#fff"},data:biData}]};

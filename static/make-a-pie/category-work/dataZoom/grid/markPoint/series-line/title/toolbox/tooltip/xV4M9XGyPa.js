const rnd=()=>.2*Math.random()-.1+.003,randomWalk=o=>{const s=[1];for(let l=1;l<o;l++)s[l]=Number((s[l-1]*(1+rnd())).toFixed(2));return s},prices=randomWalk(1100);var data=prices.map((o,s)=>[s,o]);const markPoints=[],findMax=(o,s)=>{const l=o.length,i=[],n=[];for(let e=0;e<=s;e++)i[e]=Array(l+1-e).fill(0),n[e]=Array(l+1-e).fill(0);for(let e=1;e<=s;e++){const a=e%2===0?-1:1;for(let t=l-1-e;t>=0;t--)i[e-1][t+1]+a*o[t]>i[e][t+1]?(i[e][t]=i[e-1][t+1]+a*o[t],n[e][t]=n[e-1][t+1]+","+t):(i[e][t]=i[e][t+1],n[e][t]=n[e][t+1])}return{value:i[s][0],idxs:n[s][0].split(",").slice(1).map(Number)}},ret=findMax(prices,8);console.log(ret);const sIdxs=ret.idxs.filter((o,s)=>s%2===0),bIdxs=ret.idxs.filter((o,s)=>s%2===1);bIdxs.forEach(o=>{markPoints.push({name:"买点",coord:[o,data[o][1]],symbolOffset:[0,10],itemStyle:{color:"red"}})}),sIdxs.forEach(o=>{markPoints.push({name:"卖点",coord:[o,data[o][1]],symbolOffset:[0,-10],itemStyle:{color:"yellowgreen"}})});const biIdxs=ret.idxs,biData=biIdxs.map(o=>[o,data[o][1]]);biIdxs.includes(0)||biData.push([0,data[0][1]]);const len=prices.length;biIdxs.includes(len-1)||biData.unshift([len-1,data[len-1][1]]),option={backgroundColor:"#080b30",title:{text:"quan-infinity",textStyle:{color:"#fff"}},tooltip:{trigger:"axis"},grid:{left:64,right:16,bottom:80},toolbox:{feature:{dataZoom:{yAxisIndex:"none"},restore:{},saveAsImage:{}}},xAxis:{axisLine:{show:!0,lineStyle:{color:"rgba(255,255,255,0.3)"}},axisTick:{show:!1},splitLine:{show:!1}},yAxis:{axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"rgba(255,255,255,0.3)"},splitLine:{show:!0,lineStyle:{color:"rgba(255,255,255,0.3)"}}},dataZoom:[{type:"inside",start:0,end:1e3},{start:0,end:1e3,handleIcon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4v1.3h1.3v-1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7V23h6.6V24.4z M13.3,19.6H6.7v-1.4h6.6V19.6z",handleSize:"80%",handleStyle:{color:"#fff",shadowBlur:3,shadowColor:"rgba(0, 0, 0, 0.6)",shadowOffsetX:2,shadowOffsetY:2}}],series:[{type:"line",lineStyle:{color:"#6c50f3"},markPoint:{symbol:"circle",symbolSize:10,data:markPoints},data},{type:"line",lineStyle:{color:"#fff"},data:biData}]};

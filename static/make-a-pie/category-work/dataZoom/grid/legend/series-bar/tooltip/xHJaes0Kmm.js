app.title="堆叠条形图";const xdata=["2018/05/06","2018/05/06","2018/05/06","2018/05/06","2018/05/06","2018/05/06","2018/05/06"],ydata={energy:[320,302,301,334,390,330,320],other:[120,132,101,134,90,230,210]},toPercent=(e,a)=>{const t=e+a;return(Math.round(e/t*1e4)/100).toFixed(0)+"%"},formatDate=(e,a="YYYY/MM/DD")=>{if(!e)return"";const t=typeof e=="string"?new Date(e):e,o=t.getFullYear(),l=t.getMonth()+1,n=t.getDate(),i=t.getHours(),c=t.getMinutes(),s=t.getSeconds(),r=Array.apply(null,Array[10]).map((y,d)=>`0${d}`);return a.replace(/YYYY/g,o).replace(/MM/g,r[l]||l).replace(/DD/g,r[n]||n).replace(/hh/g,r[i]||i).replace(/mm/g,r[c]||c).replace(/ss/g,r[s]||s)};let sum=[];$.each(ydata.energy,(e,a)=>{sum[e]=a+ydata.other[e]}),option={tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(e){let a=toPercent(e[1].data,e[0].data),t=toPercent(e[0].data,e[1].data);return`
                ${formatDate(e[1].axisValueLabel,"YYYY年MM月DD日")} <br/>
                ${e[1].marker} ${e[1].seriesName}：${e[1].data}个 （${a}）<br/>
                ${e[0].marker} ${e[0].seriesName}：${e[0].data}个 （${t}）<br/>
            `}},legend:{data:["电源箱警报","其他运行设备警报"]},grid:{left:"3%",right:"4%",bottom:"7%",containLabel:!0},xAxis:{type:"category",data:xdata,axisLine:{lineStyle:{color:"#999"}},axisLabel:{color:"#999"}},yAxis:{type:"value",name:"单位/个",axisLine:{lineStyle:{color:"#999"}},splitLine:{lineStyle:{color:"#999"}},axisLabel:{color:"#999"}},dataZoom:[{id:"dataZoomX",type:"slider",xAxisIndex:[0],filterMode:"filter"},{type:"inside"}],series:[{name:"其他运行设备警报",type:"bar",stack:"当天报警总数",data:ydata.other,itemStyle:{color:"#4acffa"}},{name:"电源箱警报",type:"bar",stack:"当天报警总数",data:ydata.energy,itemStyle:{color:"#fa8c69"}},{name:"总报警数",type:"bar",barGap:"-100%",data:sum,show:!1,itemStyle:{color:"transparent"},label:{show:!0,position:"top",color:"#999"}}]};

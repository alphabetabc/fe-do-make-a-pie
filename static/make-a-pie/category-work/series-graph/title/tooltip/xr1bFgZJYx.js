var data=[{root:"service1",clients:["service11","service12"]},{root:"service2",clients:["service21","service22"],servers:["service12"]}];function get_nodes(e){var t=[],n=[];for(var r in e){n.push(e[r].root),t.push({name:e[r].root,x:100,y:(parseInt(r)+1)*100,label:{normal:{show:!0,textStyle:{color:"red",fontSize:8}}}});var o=e[r].clients,l=e[r].servers,s=parseInt(r)+1;for(var a in o)n.indexOf(o[a])>=0||(n.push(o[a]),t.push({name:o[a],x:(parseInt(r)+1)*200,y:(parseInt(s)+parseInt(a))*100,label:{normal:{show:!0,textStyle:{color:"red",fontSize:8}}}}),s+=1);for(var u in l)n.indexOf(l[u])>=0||(n.push(l[u]),t.push({name:l[u],x:(parseInt(r)+1)*200,y:(parseInt(s)+parseInt(u))*100,label:{normal:{show:!0,textStyle:{color:"red",fontSize:8}}}}),s+=1)}return t}function get_links(e){var t=[];for(var n in e){var r=e[n].clients,o=e[n].servers;for(var l in r)t.push({source:r[l],target:e[n].root});for(var s in o)t.push({source:e[n].root,target:o[s]})}return t}var option={title:{text:"调用关系构建"},tooltip:{},series:[{type:"graph",legendHoverLink:!0,layout:"none",focusNodeAdjacency:!0,symbolSize:50,roam:!0,label:{normal:{show:!0}},edgeSymbol:["circle","arrow"],edgeSymbolSize:[4,10],edgeLabel:{normal:{textStyle:{fontSize:8}}},itemStyle:{normal:{color:"#ccc",borderColor:"#1af"}},data:get_nodes(data),links:get_links(data),lineStyle:{normal:{color:"#1af",opacity:.9,width:2,curveness:.2}}}]};myChart.setOption(option);

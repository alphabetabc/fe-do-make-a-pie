let data=[{亚洲:[["北京",2]]},{亚洲:[["北京",1]],北京:[["end",0]]},{亚洲:[["广东",1]],北京:[["广东",1]]},{亚洲:[["北京",2]],北京:[["广东",1]],广东:[["end",0]]},{上海:[["广东",2]],亚洲:[["北京",1],["广东",4]],北京:[["end",0]],广东:[["end",0]]},{亚洲:[["广东",4],["上海",1]],北京:[["end",0]],广东:[["end",0]],日本:[["上海",1]]},{上海:[["end",0]],亚洲:[["北京",4],["广东",5]],北京:[["广东",1]],广东:[["end",0]],日本:[["北京",1]]},{亚洲:[["北京",3],["广东",4]],北京:[["广东",1]],广东:[["end",0]]},{亚洲:[["广东",5],["上海",2]],北京:[["end",0]],广东:[["end",0]],日本:[["广东",1]]},{上海:[["end",0]],亚洲:[["北京",3],["广东",1]],广东:[["end",0]]},{亚洲:[["北京",1],["广东",8]],北京:[["广东",1]],广东:[["end",0]]},{亚洲:[["北京",3],["广东",4],["上海",1]],北京:[["end",0]],广东:[["end",0]],日本:[["北京",1]]},{上海:[["广东",1]],亚洲:[["广东",1]],北京:[["end",0]],广东:[["end",0]]},{上海:[["广东",1]],亚洲:[["广东",2],["上海",1]],广东:[["end",0]],日本:[["上海",1]]},{上海:[["广东",2]],亚洲:[["广东",2]],广东:[["end",0]]},{亚洲:[["广东",2],["上海",1]],广东:[["end",0]]},{上海:[["end",0]],亚洲:[["广东",5]],广东:[["end",0]]},{亚洲:[["广东",1]],广东:[["end",0]]},{亚洲:[["广东",1]],广东:[["end",0]]},{亚洲:[["广东",1]],广东:[["end",0]]},{亚洲:[["广东",1]],广东:[["end",0]]},{亚洲:[["广东",1]],广东:[["end",0]]},{亚洲:[["广东",1]],广东:[["end",0]]},{亚洲:[["广东",1]],广东:[["end",0]]},{亚洲:[["广东",1]],广东:[["end",0]]}],timeline=["2020-03-16","2020-03-17","2020-03-19","2020-03-20","2020-03-21","2020-03-22","2020-03-24","2020-03-26","2020-03-27"];function connect2fill(e,l){return{source:e,target:l,value:0,lineStyle:{opacity:0},emphasis:{opacity:0}}}function connect(e,l,t,n){return{source:e+"-"+l,target:e+1+"-"+t,value:n,lineStyle:{color:new echarts.graphic.LinearGradient(0,0,1,0,[{offset:0,color:"#4e8ebf"},{offset:.5,color:"#dddddd"},{offset:1,color:"#c84641"}]),curveness:.3}}}let nodes=[{name:"level-0",itemStyle:{normal:{opacity:0}}}],links=[{source:"level-0",target:"level-1",value:0,lineStyle:{opacity:0},emphasis:{opacity:0}}],nodes_list=[],last_temp=[],last_list=[];function add_nodes(e,l){let t=e+"-"+l;nodes_list.indexOf(t)==-1&&(nodes.push({name:t}),nodes_list.push(t))}for(let e=0;e<data.length;e++){nodes.push({name:"level-"+(e+1),itemStyle:{normal:{opacity:0}},label:{show:!1}}),e>0&&links.push(connect2fill("level-"+e,"level-"+(e+1)));let l=data[e];for(let t in l){add_nodes(e,t),e>0&&last_list.indexOf(e+"-"+t)==-1&&(console.log(e+"----"+t),links.push(connect2fill("level-"+(e-1),e+"-"+t)));let n=l[t];for(let o=0;o<n.length;o++){let a=n[o][0],i=n[o][1];a=="end"?links.push(connect2fill(e+"-"+t,"level-"+(e+1))):(last_temp.push(e+1+"-"+a),e<data.length&&links.push(connect(e,t,a,i)),add_nodes(e+1,a))}}last_list=last_temp,last_temp=[]}option={backgroundColor:"#FFFFFF",grid:{left:"15%",right:"5%",top:"1%",bottom:"1%"},xAxis:{type:"category",position:"top",boundaryGap:!1,splitLine:{show:!1},axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"#293c55",inside:!1,align:"center",margin:-30,formatter:e=>e.substring(5,10)},z:10,data:timeline},yAxis:{show:!1,z:10},series:[{name:"sankey",type:"sankey",layout:"none",draggable:!1,left:"4.5%",right:"4.5%",top:"5%",bottom:"5%",data:nodes,links,itemStyle:{color:"#1f77b4",borderColor:"#1f77b4"},focusNodeAdjacency:!0,label:{color:"#fff",position:"inside",rotate:-90,fontFamily:"Arial",fontSize:18,formatter:e=>e.name.split("-")[1]}}],tooltip:{trigger:"item"}},myChart.setOption(option),myChart.on("click",e=>console.log(e));

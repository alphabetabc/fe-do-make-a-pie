var ROOT_PATH="https://cdn.jsdelivr.net/gh/apache/echarts-website@asf-site/examples";myChart.showLoading(),$.get(ROOT_PATH+"/data/asset/data/energy.json",function(r){myChart.hideLoading(),myChart.setOption(option={title:{text:"Sankey Diagram"},tooltip:{trigger:"item",triggerOn:"mousemove"},series:[{type:"sankey",data:r.nodes,links:r.links,emphasis:{focus:"adjacency"},lineStyle:{color:"source",curveness:.5}}]});let s=!1,l="";myChart.on("click",o=>{if(o.data.source)return;let{name:t}=o,{links:i,nodes:n}=_.cloneDeep(r),a=myChart.getOption();if(l!==t&&(s=!1),l=t,s)a.series[0].data=n,a.series[0].links=i,s=!1;else{let c=[],y=[];c=i.filter(e=>e.source===t||e.target===t).map(e=>[{name:e.source,itemStyle:{opacity:1},label:{fontSize:12}},{name:e.target,itemStyle:{opacity:1},label:{fontSize:12}}]).flat(),n=_.unionBy(c,n,"name").map(e=>(e.itemStyle||(e.itemStyle={opacity:.3},e.label={show:!1}),e)),y=i.map(e=>e.source===t||e.target===t?{...e,lineStyle:{opacity:.8}}:{...e,lineStyle:{color:"transparent",opacity:.3}}),a.series[0].data=n,a.series[0].links=y,s=!0}myChart.setOption(a)})});

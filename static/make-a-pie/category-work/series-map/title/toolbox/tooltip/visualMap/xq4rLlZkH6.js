$('<div class="back">返回</div>').appendTo($("#chart-panel")),$(".back").css({position:"absolute",left:"17px",top:"25px",color:"rgb(222,222,222)","font-size":"15px",cursor:"pointer","z-index":"100"}),$(".back").click(function(){parentCode.length!==1&&(parentCode.pop(),getGeoJson(parentCode[parentCode.length-1]))});var parentJson=null,cityName="全国",parentCode=[1e5];getGeoJson(1e5);function getGeoJson(e){var r=new AMap.Map("map",{resizeEnable:!0,center:[116.30946,39.937629],zoom:3});AMapUI.loadUI(["geo/DistrictExplorer"],o=>{var t=window.districtExplorer=new o({eventSupport:!0,map:r});t.loadAreaNode(e,function(l,n){if(l){console.error(l);return}let a=n.getSubFeatures();a.length>0&&a[0].properties.level=="district"?parentJson=a:a.length==0&&(a=parentJson.filter(i=>{if(i.properties.adcode==e)return i})),getMapData(a)})})}function getMapData(e){let r=e.map(t=>({name:t.properties.name,value:Math.random()*1e3,level:t.properties.level,cityCode:t.properties.adcode})),o={};o.features=e,initEcharts(r,o)}function initEcharts(e,r){echarts.registerMap("Map",r),myChart.setOption({backgroundColor:"rgb(20,28,52)",tooltip:{trigger:"item",formatter:o=>{let t=o.value;return window.isNaN(t)&&(t=0),o.name+"<br><hr>数值 : "+t.toFixed(2)}},title:{show:!0,x:"center",y:"top",text:cityName+"地图实现点击下钻",textStyle:{color:"#fff",fontSize:16}},toolbox:{feature:{dataView:{show:!1,readOnly:!0},magicType:{show:!1,type:["line","bar"]},restore:{show:!1},saveAsImage:{show:!0,name:cityName+"地图",pixelRatio:2}},iconStyle:{normal:{borderColor:"#41A7DE"}},itemSize:15,top:20,right:22},dataRange:{right:"2%",bottom:"3%",icon:"circle",align:"left",splitList:[{start:0,end:0,label:"未发生",color:"#6ead51"},{start:0,end:250,label:"0-150",color:"#92b733"},{start:250,end:500,label:"250-500",color:"#c4aa29"},{start:500,end:750,label:"500-750",color:"#ce6c2b"},{start:750,label:"750以上",color:"#c92626"}],textStyle:{color:"#0fccff",fontSize:16}},series:[{name:"地图",type:"map",map:"Map",roam:!0,zoom:1.1,data:e,itemStyle:{normal:{show:!0,areaColor:"rgba(0,0,0,0)",borderColor:"rgb(185, 220, 227)",borderWidth:"1"}},label:{normal:{show:!0,textStyle:{color:"rgb(249, 249, 249)",fontSize:12}},emphasis:{show:!0,textStyle:{color:"#000"}}}}]},!0),myChart.on("click",echartsMapClick)}function echartsMapClick(e){let r=e.data.cityCode;cityName=e.data.name,parentCode.push(r),getGeoJson(r)}

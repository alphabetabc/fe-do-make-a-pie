var oldData=[{COFFERS_NAME:"第一金库",DENOMINATION:"专用钞",CURRENCY_TYPE:"完整券",AMOUNT:412.35},{COFFERS_NAME:"第一金库",DENOMINATION:"专用钞",CURRENCY_TYPE:"残损券",AMOUNT:452.35},{COFFERS_NAME:"第一金库",DENOMINATION:"流通钞",CURRENCY_TYPE:"完整券",AMOUNT:122.35},{COFFERS_NAME:"第一金库",DENOMINATION:"流通钞",CURRENCY_TYPE:"残损券",AMOUNT:90.35},{COFFERS_NAME:"第二金库",DENOMINATION:"专用钞",CURRENCY_TYPE:"完整券",AMOUNT:212.35},{COFFERS_NAME:"第二金库",DENOMINATION:"专用钞",CURRENCY_TYPE:"残损券",AMOUNT:452.35},{COFFERS_NAME:"第二金库",DENOMINATION:"流通钞",CURRENCY_TYPE:"完整券",AMOUNT:122.35},{COFFERS_NAME:"第二金库",DENOMINATION:"流通钞",CURRENCY_TYPE:"残损券",AMOUNT:567.35},{COFFERS_NAME:"第三金库",DENOMINATION:"专用钞",CURRENCY_TYPE:"完整券",AMOUNT:225.35},{COFFERS_NAME:"第三金库",DENOMINATION:"专用钞",CURRENCY_TYPE:"残损券",AMOUNT:34.35},{COFFERS_NAME:"第三金库",DENOMINATION:"流通钞",CURRENCY_TYPE:"完整券",AMOUNT:422.35},{COFFERS_NAME:"第三金库",DENOMINATION:"流通钞",CURRENCY_TYPE:"残损券",AMOUNT:910.35}],datavalue={source:[["product"],["专用钞(完整券)"],["流通钞(完整券)"],["流通钞(残损券)"],["专用钞(残损券)"]]},interDate=[["product"],["完整券"],["残损券"]],coffersArr=[];oldData.forEach(e=>{coffersArr.indexOf(e.COFFERS_NAME)<0&&coffersArr.push(e.COFFERS_NAME)});for(let e=0;e<coffersArr.length;e++)datavalue.source[0][e+1]=coffersArr[e],interDate[0][e+1]=coffersArr[e];for(let e=0;e<oldData.length;e++){for(let r=1;r<datavalue.source[0].length;r++)for(let t=1;t<datavalue.source.length;t++)datavalue.source[0][r]==oldData[e].COFFERS_NAME&&datavalue.source[t][0].indexOf(oldData[e].DENOMINATION)!=-1&&datavalue.source[t][0].indexOf(oldData[e].CURRENCY_TYPE)!=-1&&(datavalue.source[t][r]=oldData[e].AMOUNT);for(var m=1;m<interDate[0].length;m++)for(var n=1;n<interDate.length;n++)interDate[0][m]==oldData[e].COFFERS_NAME&&interDate[n][0]==oldData[e].CURRENCY_TYPE&&((interDate[n][m]=="undefined"||isNaN(interDate[n][m]))&&(interDate[n][m]=0),interDate[n][m]+=parseFloat(oldData[e].AMOUNT))}setTimeout(function(){option={title:{text:"券别库存统计",subtext:"单位：万元",left:"0"},legend:{right:"0",orient:"vertical"},tooltip:{trigger:"axis",showContent:!0,position:"outside"},dataset:datavalue,xAxis:{type:"category"},yAxis:{gridIndex:0},grid:{top:"55%"},series:[{type:"line",smooth:!0,seriesLayoutBy:"row"},{type:"line",smooth:!0,seriesLayoutBy:"row"},{type:"line",smooth:!0,seriesLayoutBy:"row"},{type:"line",smooth:!0,seriesLayoutBy:"row"},{name:"outer",type:"pie",id:"outer",radius:["30%","20%"],center:["50%","30%"],label:{position:"outside",formatter:function(e){return e.data[1]+"万元"}},labelLine:{show:!0,length:50},encode:{itemName:"product",value:1,tooltip:1}},{name:"inner",type:"pie",id:"inner",radius:[0,"15%"],center:["50%","30%"],label:{position:"inner",formatter:function(e){return e.data[0]}},data:interDate,encode:{itemName:"product",value:1,tooltip:1}}]},myChart.on("updateAxisPointer",function(e){var r=e.axesInfo[0];if(r){var t=r.value+1;myChart.setOption({series:[{id:"outer",label:{formatter:function(N){return N.data[t]+"万元"}},encode:{value:t,tooltip:t}},{id:"inner",label:{formatter:function(N){return N.data[0]}},encode:{value:t,tooltip:t}}]})}}),myChart.setOption(option)});

function getParametricEquation(e,o,i,a,s,n){let h=(e+o)/2,p=e*Math.PI*2,d=o*Math.PI*2,t=h*Math.PI*2;e===0&&o===1&&(i=!1),s=typeof s<"u"?s:1/3;let r=i?Math.cos(t)*.1:0,f=i?Math.sin(t)*.1:0,c=a?.55:.5;return{u:{min:-Math.PI,max:Math.PI*3,step:Math.PI/32},v:{min:0,max:Math.PI*2,step:Math.PI/20},x:function(l,u){return l<p?r+Math.cos(p)*(1+Math.cos(u)*s)*c:l>d?r+Math.cos(d)*(1+Math.cos(u)*s)*c:r+Math.cos(l)*(1+Math.cos(u)*s)*c},y:function(l,u){return l<p?f+Math.sin(p)*(1+Math.cos(u)*s)*c:l>d?f+Math.sin(d)*(1+Math.cos(u)*s)*c:f+Math.sin(l)*(1+Math.cos(u)*s)*c},z:function(l,u){return l<-Math.PI*.5?Math.sin(l):l>Math.PI*2.5?Math.sin(l)*n*.1:Math.sin(u)>0?1*n*.1:-1}}}function getPie3D(e,o){let i=[],a=0,s=0,n=0,h=[],p=typeof o<"u"?(1-o)/(1+o):1/3;for(let t=0;t<e.length;t++){a+=e[t].value;let r={name:typeof e[t].name>"u"?`series${t}`:e[t].name,type:"surface",parametric:!0,wireframe:{show:!1},pieData:e[t],pieStatus:{selected:!1,hovered:!1,k:p}};if(typeof e[t].itemStyle<"u"){let f={};typeof e[t].itemStyle.color<"u"&&(f.color=e[t].itemStyle.color),typeof e[t].itemStyle.opacity<"u"&&(f.opacity=e[t].itemStyle.opacity),r.itemStyle=f}i.push(r)}for(let t=0;t<i.length;t++)n=s+i[t].pieData.value,i[t].pieData.startRatio=s/a,i[t].pieData.endRatio=n/a,i[t].parametricEquation=getParametricEquation(i[t].pieData.startRatio,i[t].pieData.endRatio,!1,!1,p,i[t].pieData.value),s=n,h.push(i[t].name);i.push({name:"mouseoutSeries",type:"surface",parametric:!0,wireframe:{show:!1},itemStyle:{opacity:0},parametricEquation:{u:{min:0,max:Math.PI*2,step:Math.PI/20},v:{min:0,max:Math.PI,step:Math.PI/20},x:function(t,r){return Math.sin(r)*Math.sin(t)+Math.sin(t)},y:function(t,r){return Math.sin(r)*Math.cos(t)+Math.cos(t)},z:function(t,r){return Math.cos(r)>0?.1:-.1}}});let d={xAxis3D:{min:-1,max:1},yAxis3D:{min:-1,max:1},zAxis3D:{min:-1,max:1},grid3D:{show:!1,boxHeight:10,viewControl:{alpha:40,rotateSensitivity:0,zoomSensitivity:0,panSensitivity:0,autoRotate:!1},postEffect:{enable:!0,bloom:{enable:!0,bloomIntensity:.1},SSAO:{enable:!0,quality:"medium",radius:1}}},series:i};return console.log("option",d),d}option=getPie3D([{name:"员工类型1",value:44,itemStyle:{color:"rgba(155,245,93,0.8)"}},{name:"员工类型2",value:28,itemStyle:{color:"rgba(221,149,38,0.8)"}},{name:"员工类型3",value:15,itemStyle:{color:"rgba(15,106,229,0.8)"}},{name:"员工类型4",value:13,itemStyle:{color:"rgba(30,209,175,0.8)"}}],0);let selectedIndex="",hoveredIndex="";myChart.on("click",function(e){let o=!option.series[e.seriesIndex].pieStatus.selected,i=option.series[e.seriesIndex].pieStatus.hovered,a=option.series[e.seriesIndex].pieStatus.k,s=option.series[e.seriesIndex].pieData.startRatio,n=option.series[e.seriesIndex].pieData.endRatio;selectedIndex!==""&&selectedIndex!==e.seriesIndex&&(option.series[selectedIndex].parametricEquation=getParametricEquation(option.series[selectedIndex].pieData.startRatio,option.series[selectedIndex].pieData.endRatio,!1,!1,a,option.series[selectedIndex].pieData.value),option.series[selectedIndex].pieStatus.selected=!1),option.series[e.seriesIndex].parametricEquation=getParametricEquation(s,n,o,i,a,option.series[selectedIndex].pieData.value),option.series[e.seriesIndex].pieStatus.selected=o,o&&(selectedIndex=e.seriesIndex),myChart.setOption(option)}),myChart.on("mouseover",function(e){let o,i,a,s,n;hoveredIndex!==e.seriesIndex&&(hoveredIndex!==""&&(o=option.series[hoveredIndex].pieStatus.selected,i=!1,a=option.series[hoveredIndex].pieData.startRatio,s=option.series[hoveredIndex].pieData.endRatio,n=option.series[hoveredIndex].pieStatus.k,option.series[hoveredIndex].parametricEquation=getParametricEquation(a,s,o,i,n,option.series[hoveredIndex].pieData.value),option.series[hoveredIndex].pieStatus.hovered=i,hoveredIndex=""),e.seriesName!=="mouseoutSeries"&&(o=option.series[e.seriesIndex].pieStatus.selected,i=!0,a=option.series[e.seriesIndex].pieData.startRatio,s=option.series[e.seriesIndex].pieData.endRatio,n=option.series[e.seriesIndex].pieStatus.k,option.series[e.seriesIndex].parametricEquation=getParametricEquation(a,s,o,i,n,option.series[e.seriesIndex].pieData.value+5),option.series[e.seriesIndex].pieStatus.hovered=i,hoveredIndex=e.seriesIndex),myChart.setOption(option))}),myChart.on("globalout",function(){hoveredIndex!==""&&(isSelected=option.series[hoveredIndex].pieStatus.selected,isHovered=!1,k=option.series[hoveredIndex].pieStatus.k,startRatio=option.series[hoveredIndex].pieData.startRatio,endRatio=option.series[hoveredIndex].pieData.endRatio,option.series[hoveredIndex].parametricEquation=getParametricEquation(startRatio,endRatio,isSelected,isHovered,k,option.series[hoveredIndex].pieData.value),option.series[hoveredIndex].pieStatus.hovered=isHovered,hoveredIndex=""),myChart.setOption(option)});

function getParametricEquation(t,o,i,n,s){let a=(t+o)/2,c=t*Math.PI*2,d=o*Math.PI*2,f=a*Math.PI*2;t===0&&o===1&&(i=!1),s=typeof s<"u"?s:1/3;let e=i?Math.cos(f)*.1:0,r=i?Math.sin(f)*.1:0,p=n?1.05:1;return{u:{min:-Math.PI,max:Math.PI*3,step:Math.PI/32},v:{min:0,max:Math.PI*2,step:Math.PI/20},x:function(l,u){return l<c?e+Math.cos(c)*(1+Math.cos(u)*s)*p:l>d?e+Math.cos(d)*(1+Math.cos(u)*s)*p:e+Math.cos(l)*(1+Math.cos(u)*s)*p},y:function(l,u){return l<c?r+Math.sin(c)*(1+Math.cos(u)*s)*p:l>d?r+Math.sin(d)*(1+Math.cos(u)*s)*p:r+Math.sin(l)*(1+Math.cos(u)*s)*p},z:function(l,u){return l<-Math.PI*.5||l>Math.PI*2.5?Math.sin(l):Math.sin(u)>0?1:-1}}}function getPie3D(t,o){let i=[],n=0,s=0,a=0,c=[],d=typeof o<"u"?(1-o)/(1+o):1/3;for(let e=0;e<t.length;e++){n+=t[e].value;let r={name:typeof t[e].name>"u"?`series${e}`:t[e].name,type:"surface",parametric:!0,wireframe:{show:!1},pieData:t[e],pieStatus:{selected:!1,hovered:!1,k:d}};if(typeof t[e].itemStyle<"u"){let p={};typeof t[e].itemStyle.color<"u"&&(p.color=t[e].itemStyle.color),typeof t[e].itemStyle.opacity<"u"&&(p.opacity=t[e].itemStyle.opacity),r.itemStyle=p}i.push(r)}for(let e=0;e<i.length;e++)a=s+i[e].pieData.value,i[e].pieData.startRatio=s/n,i[e].pieData.endRatio=a/n,i[e].parametricEquation=getParametricEquation(i[e].pieData.startRatio,i[e].pieData.endRatio,!1,!1,d),s=a,c.push(i[e].name);i.push({name:"mouseoutSeries",type:"surface",parametric:!0,wireframe:{show:!1},itemStyle:{opacity:0},parametricEquation:{u:{min:0,max:Math.PI*2,step:Math.PI/20},v:{min:0,max:Math.PI,step:Math.PI/20},x:function(e,r){return Math.sin(r)*Math.sin(e)+Math.sin(e)},y:function(e,r){return Math.sin(r)*Math.cos(e)+Math.cos(e)},z:function(e,r){return Math.cos(r)>0?.1:-.1}}});let f={tooltip:{formatter:e=>{if(e.seriesName!=="mouseoutSeries")return`${e.seriesName}<br/><span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:${e.color};"></span>${f.series[e.seriesIndex].pieData.value}`}},title:{text:"年审核问题分布情况",x:"center",top:"20",textStyle:{color:"#fff",fontSize:22}},backgroundColor:"#333",xAxis3D:{min:-1,max:1},yAxis3D:{min:-1,max:1},zAxis3D:{min:-1,max:1},grid3D:{show:!1,boxHeight:20,bottom:"50%",viewControl:{alpha:50,beta:-60}},series:i};return f}option=getPie3D([{name:"aa",value:11,itemStyle:{color:"#F1E402",opacity:.5}},{name:"cc",value:33,itemStyle:{color:"#138AF5",opacity:.5}},{name:"bb",value:22,itemStyle:{color:"#2DD7FE",opacity:.5}}]);let selectedIndex="",hoveredIndex="";myChart.on("click",function(t){let o=!option.series[t.seriesIndex].pieStatus.selected,i=option.series[t.seriesIndex].pieStatus.hovered,n=option.series[t.seriesIndex].pieStatus.k,s=option.series[t.seriesIndex].pieData.startRatio,a=option.series[t.seriesIndex].pieData.endRatio;selectedIndex!==""&&selectedIndex!==t.seriesIndex&&(option.series[selectedIndex].parametricEquation=getParametricEquation(option.series[selectedIndex].pieData.startRatio,option.series[selectedIndex].pieData.endRatio,!1,!1,n),option.series[selectedIndex].pieStatus.selected=!1),option.series[t.seriesIndex].parametricEquation=getParametricEquation(s,a,o,i,n),option.series[t.seriesIndex].pieStatus.selected=o,o&&(selectedIndex=t.seriesIndex),myChart.setOption(option)}),myChart.on("mouseover",function(t){let o,i,n,s,a;hoveredIndex!==t.seriesIndex&&(hoveredIndex!==""&&(o=option.series[hoveredIndex].pieStatus.selected,i=!1,n=option.series[hoveredIndex].pieData.startRatio,s=option.series[hoveredIndex].pieData.endRatio,a=option.series[hoveredIndex].pieStatus.k,option.series[hoveredIndex].parametricEquation=getParametricEquation(n,s,o,i,a),option.series[hoveredIndex].pieStatus.hovered=i,hoveredIndex=""),t.seriesName!=="mouseoutSeries"&&(o=option.series[t.seriesIndex].pieStatus.selected,i=!0,n=option.series[t.seriesIndex].pieData.startRatio,s=option.series[t.seriesIndex].pieData.endRatio,a=option.series[t.seriesIndex].pieStatus.k,option.series[t.seriesIndex].parametricEquation=getParametricEquation(n,s,o,i,a),option.series[t.seriesIndex].pieStatus.hovered=i,hoveredIndex=t.seriesIndex),myChart.setOption(option))}),myChart.on("globalout",function(){hoveredIndex!==""&&(isSelected=option.series[hoveredIndex].pieStatus.selected,isHovered=!1,k=option.series[hoveredIndex].pieStatus.k,startRatio=option.series[hoveredIndex].pieData.startRatio,endRatio=option.series[hoveredIndex].pieData.endRatio,option.series[hoveredIndex].parametricEquation=getParametricEquation(startRatio,endRatio,isSelected,isHovered,k),option.series[hoveredIndex].pieStatus.hovered=isHovered,hoveredIndex=""),myChart.setOption(option)});

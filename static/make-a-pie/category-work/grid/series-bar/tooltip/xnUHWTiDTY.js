const baseData=[{value:"贵阳市",children:[{value:"花溪区",num:.1},{value:"南明区",num:.15},{value:"观山湖区",num:.18}]},{value:"六盘水市",children:[{value:"钟山区",num:.25},{value:"六枝特区",num:.23}]},{value:"遵义市",children:[{value:"红花岗区",num:.32},{value:"汇川区",num:.33},{value:"遵义县",num:.36}]},{value:"安顺市",children:[{value:"西秀区",num:.57},{value:"平坝县",num:.72}]},{value:"铜仁市",children:[{value:"玉屏县",num:.45}]}],dLength=baseData.map(e=>e.children.length).reduce((e,a)=>e+a);let xData=[],yData=[],series=[{data:yData,type:"bar",label:{show:!0,position:"top",textStyle:{color:"#555"}},itemStyle:{color:e=>colorBg(e.dataIndex)},xAxisIndex:0,yAxisIndex:0}],baseObj={data:[{name:"",value:1}],label:{show:!0,position:"inside",formatter:"{b}",offset:[0,10],textStyle:{color:"#666"}},type:"bar",barGap:0,barWidth:"",itemStyle:{color:"",opacity:.8},animationEasing:"bounceOut",xAxisIndex:1,yAxisIndex:1};baseData.forEach((e,a)=>{let l=JSON.parse(JSON.stringify(baseObj));l.data[0].name=e.value,l.barWidth=e.children.length/dLength*100+"%",l.itemStyle.color=colorBg(a),series.push(l),e.children.forEach(t=>{xData.push({value:t.value,pName:e.value}),yData.push(t.num)})});function colorBg(e){return["#4150d8","#28bf7e","#ed7c2f","#f2a93b","#f9cf36","#4a5bdc","#4cd698","#f4914e","#fcb75b","#ffe180","#b6c2ff","#96edc1"][e]}myChart.setOption({tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:[{top:100,bottom:111},{height:60,bottom:50,tooltip:{show:!1}}],dataZoom:{type:"slider"},xAxis:[{type:"category",data:xData,gridIndex:0,axisLabel:{color:"#333"},axisLine:{lineStyle:{color:"#e7e7e7"}},axisTick:{lineStyle:{color:"#e7e7e7"}},zlevel:2},{type:"category",gridIndex:1,axisLine:{show:!1},axisLabel:{show:!1},axisTick:{show:!1},zlevel:1}],yAxis:[{type:"value",gridIndex:0,axisLabel:{color:"#333"},splitLine:{lineStyle:{type:"dashed"}},axisLine:{lineStyle:{color:"#ccc"}},axisTick:{lineStyle:{color:"#ccc"}}},{type:"value",gridIndex:1,axisLabel:{show:!1},axisLine:{show:!1},splitLine:{show:!1},axisTick:{show:!1}}],series}),myChart.on("dataZoom",e=>{const a=myChart.getModel().option.dataZoom[0],{startValue:l,endValue:t}=a;let n=xData.slice(l,t+1),r=[...new Set(n.map(o=>o.pName))];series.length=1,r.forEach((o,c)=>{let s=0;n.forEach(d=>{d.pName===o&&s++});let i=JSON.parse(JSON.stringify(baseObj));i.data[0].name=o,i.barWidth=s/n.length*100+"%",i.itemStyle.color=colorBg(c),series.push(i)}),myChart.setOption({series},{replaceMerge:"series"})});

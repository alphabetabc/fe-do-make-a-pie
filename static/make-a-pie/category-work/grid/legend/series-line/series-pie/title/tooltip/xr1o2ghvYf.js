var data=[30,20,54,21,90,30,10],gap=0,total=0,maxIndex,dataArray=function(){var e=Math.max.apply(Math,data),a=Math.min.apply(Math,data);gap=Math.round(e-a);for(var o=[{value:data[0]+gap,symbol:"none"}],t=0,l=data.length;t<l;t++)data[t]==e&&(maxIndex=t),total+=data[t],o.push(data[t]+gap);return o.push({value:data[data.length-1]+gap,symbol:"none"}),o}();option={backgroundColor:"#fff",title:{text:"折线饼图交互混搭实",subtext:"参考2.0版 http://echarts.baidu.com/echarts2/doc/example/mix12.html",x:"center"},legend:{data:["销量","占比"],x:"left",orient:"vertical",selectedMode:!1},tooltip:{trigger:"item",formatter:function(e){if(e.seriesName=="占比")return"总量 : "+total+"<br/>"+e.name+" : "+e.value+"<br/>占比 : "+e.percent+"%";if(e.name!="占位")return update(e),e.seriesName+"<br/>"+e.name+" : "+e.value},axisPointer:{type:"none"}},grid:{show:!0,backgroundColor:"#ccc",borderWidth:0,left:"250",right:"250",top:"200",bottom:"200"},xAxis:[{type:"category",boundaryGap:!1,show:!1,data:["占位","周一","周二","周三","周四","周五","周六","周日","占位"]}],yAxis:[{type:"value",boundaryGap:[0,.5],show:!1}],animation:!1,series:[{name:"销量",type:"line",symbol:"emptyCircle",symbolSize:6,showAllSymbol:!0,smooth:!0,itemStyle:{normal:{areaStyle:{type:"default"}}},data:dataArray},{name:"遮罩",type:"pie",clickable:!1,hoverOffset:0,tooltip:{show:!1},radius:[260,400],itemStyle:{normal:{color:"#fff",label:{show:!1},labelLine:{show:!1}},emphasis:{color:"rgba(255,255,255,1)"}},data:[{value:100,name:"直接访问"}],z:10},{name:"占比",type:"pie",clickable:!1,clockWise:!0,radius:[300,325],z:20,data:[{itemStyle:{normal:{label:{position:"inside",formatter:`
{b} : {c}

( {d}% )`,textStyle:{fontSize:15,baseline:"top",color:"#1e90ff"}},labelLine:{show:!1}}}},{name:"其他",tooltip:{show:!1},itemStyle:{normal:{color:"#fff",label:{show:!1},labelLine:{show:!1}}}}]}]};function changePieSeries(e){var a=e.value-gap;option.series[2].startAngle=-90+a/total*360/2,option.series[2].data[0].name=e.name,option.series[2].data[0].value=a,option.series[2].data[1].value=total-a}function update(e){changePieSeries(e),option.animation=!0,myChart.setOption(option)}changePieSeries({name:option.xAxis[0].data[maxIndex+1],value:option.series[0].data[maxIndex+1],dataIndex:maxIndex+1});

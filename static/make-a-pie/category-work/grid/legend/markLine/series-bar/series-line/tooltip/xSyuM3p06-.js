var myChart=echarts.init(document.getElementById("chart-panel")),selected={},xdata=["1","2","3","4","5","6","7","8","9","10"],ydata=["类别1","类别2","类别3","类别4"],vdata=[[27.5,28,26.4,25.1,24.6,22.8,24.7,24,24,23.6],[7.5,7.5,7.9,7.2,7.3,6.7,7,6.7,6.7,6.3],[45.2,44,42.3,46.8,39.4,42.3,38,52.3,46.2,47.4],[6,6.7,8.4,7.7,6.8,6.4,8.7,5.8,5.7,9.7]],series=[],legenddata=ydata,sumData=[];$.each(vdata[0],function(t,a){for(var e=0,r=0;r<vdata.length;r++)e+=vdata[r][t];sumData[t]=parseFloat(toDecimal(e))}),$.each(vdata,function(t,a){var e={name:ydata[t],type:"bar",smooth:!0,areaStyle:{normal:{}},data:a,barWidth:"40%",stack:"总量"};series.push(e)});var bs2={name:"总量",type:"line",data:sumData,label:{normal:{show:!0,position:"top"}},lineStyle:{normal:{color:"none"}},markLine:{lineStyle:{normal:{color:"#fc97af"}},label:{normal:{position:"start"}},data:[{name:"年平均",type:"average"}]}};series.push(bs2),option={tooltip:{trigger:"axis",axisPointer:{type:"shadow",crossStyle:{color:"#999"}},formatter:function(t){if(t.pop(),t[0]){for(var a=t[0].name+"<br/>",e=0;e<t.length;e++)a+=t[e].marker+t[e].seriesName+" : "+t[e].value+"<br/>";return a}}},legend:{data:legenddata,top:"6%",right:"3%"},xAxis:[{data:xdata}],yAxis:[{name:"",type:"value",axisLabel:{formatter:function(t){return t>=1e8?t/1e8+" 亿":t>=1e6?t/1e4+" 万":t+""}}}],grid:{top:"12%",left:"3%",right:"4%",bottom:"4%",containLabel:!0},series};function toDecimal(t){return parseFloat(t).toFixed(1)}myChart.on("legendselectchanged",function(t){selected=t.selected,$.each(vdata[0],function(a,e){var r=0;for(var n in selected)if(selected[n]){var o=ydata.indexOf(n);r+=vdata[o][a]}sumData[a]=parseFloat(toDecimal(r))}),myChart.setOption(option)}),myChart.setOption(option);

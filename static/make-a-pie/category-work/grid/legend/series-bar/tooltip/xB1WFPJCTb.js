var isper=!1,xdata=["周一","周二","周三","周四"],ydata=["自费1","医保1","自费2","医保2","医保3"],vdata=[[101,201,301,401],[111,211,311,411],[102,202,302,402],[112,212,312,412],[113,213,313,413]],category=[{name:"医保",data:["医保1","医保2","医保3"]}],arr_series=[];$.each(vdata,function(s,a){arr_series.push({name:ydata[s],type:"bar",stack:"all",data:a})}),option={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},toolbox:{feature:{myTool2:{show:!0,title:"自定义扩展方法",icon:"image://http://echarts.baidu.com/images/favicon.png",onclick:function(s,a){debugger;if(isper)echarts.getInstanceByDom(a.getDom()).setOption({series:arr_series,yAxis:{data:ydata},legend:{data:ydata}}),isper=!isper;else{var e=[],t=[],g=$.extend(!0,[],ydata),l=$.extend(!0,[],arr_series);$.each(category,function(v,o){var r=[],i=0;t.push(o.name),$.each(ydata,function(c,p){$.inArray(p,o.data)!=-1&&($.each(vdata[c],function(n,d){r[n]==null&&(r[n]=0),r[n]+=d}),g.splice(c-i,1),l.splice(c-i,1),i++)}),e.push({name:o.name,type:"bar",stack:"all",data:r})}),t=g.concat(t),e=l.concat(e),echarts.getInstanceByDom(a.getDom()).setOption({yAxis:{data:t},legend:{data:t}});var u=a.getOption();u.series=e,echarts.getInstanceByDom(a.getDom()).setOption(u,!0),isper=!isper}}}}},legend:{data:ydata},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:xdata},yAxis:{type:"value"},series:arr_series};

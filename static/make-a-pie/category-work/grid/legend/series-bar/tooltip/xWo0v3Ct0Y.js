let barColor=["#745ffd","#338cf9","#e0b932","#e03532"],oldData=[{clrDate:"2020",amount:371,currencyType:"计划",currencyCode:"计划"},{clrDate:"2020",amount:324,currencyType:"合并",currencyCode:"预测"},{clrDate:"2020",amount:0,currencyType:"合并",currencyCode:"黄色"},{clrDate:"2020",amount:0,currencyType:"合并",currencyCode:"红色"},{clrDate:"2021",amount:385,currencyType:"计划",currencyCode:"计划"},{clrDate:"2021",amount:346,currencyType:"合并",currencyCode:"预测"},{clrDate:"2021",amount:20,currencyType:"合并",currencyCode:"黄色"},{clrDate:"2021",amount:0,currencyType:"合并",currencyCode:"红色"},{clrDate:"2022",amount:392,currencyType:"计划",currencyCode:"计划"},{clrDate:"2022",amount:332,currencyType:"合并",currencyCode:"预测"},{clrDate:"2022",amount:0,currencyType:"合并",currencyCode:"黄色"},{clrDate:"2022",amount:0,currencyType:"合并",currencyCode:"红色"}],dateArr=[],currentTypeArr=[],currencyCodeArr=[],seriesArr;oldData.forEach(e=>{dateArr.indexOf(e.clrDate)<0&&dateArr.push(e.clrDate),currentTypeArr.indexOf(e.currencyType)<0&&currentTypeArr.push(e.currencyType),currencyCodeArr.indexOf(e.currencyCode)<0&&currencyCodeArr.push(e.currencyCode)}),seriesArr=currencyCodeArr.map(e=>({name:e,stack:"",type:"bar",data:[],itemStyle:{color:"#fff"}}));for(var i=0;i<seriesArr.length;i++){seriesArr[i].name=="计划"?seriesArr[i].stack="计划":seriesArr[i].stack="合并",seriesArr[i].itemStyle.color=barColor[i];for(var j=0;j<oldData.length;j++)for(var k=0;k<dateArr.length;k++)seriesArr[i].name==oldData[j].currencyCode&&seriesArr[i].stack==oldData[j].currencyType&&dateArr[k]==oldData[j].clrDate&&(seriesArr[i].data[k]=oldData[j].amount)}option={tooltip:{trigger:"axis",axisPointer:{type:"shadow"},textStyle:{rich:{}},formatter:function(e,l,u){for(var r="",c=0;c<e.length;c++)if(e[c].seriesName!="黄色"&&e[c].seriesName!="红色"){var t=e[c],y=t.name,n=t.seriesName,a=t.value;n=="预测"&&(a=a+20);var o=t.color;c===0?(r+=y+"<br/>",r+="<div>",r+=`<span style="display:inline-block;margin-right:5px;height:10px;width:10px;border-radius:3px;background:${o};"></span>`,r+=n+"："+a,r+="</div>"):(r+="<div>",r+=`<span style="display:inline-block;margin-right:5px;height:10px;width:10px;border-radius:3px;background:${o};"></span>`,r+=n+"："+a,r+="</div>")}return r}},legend:{type:"scroll",data:[currencyCodeArr[0],currencyCodeArr[1]],bottom:0,itemWidth:14,textStyle:{color:"#626262",fontSize:14}},grid:{top:"10%",bottom:"20%",left:"3%",right:"4%",containLabel:!0},xAxis:[{type:"category",data:dateArr,axisLabel:{color:"#626262"},axisTick:{show:!1},axisLine:{show:!1}}],yAxis:[{type:"value",axisTick:{show:!1},axisLabel:{color:"#626262"},axisLine:{show:!1},splitLine:{show:!0,lineStyle:{color:"#333",type:"dashed"}}}],series:seriesArr};

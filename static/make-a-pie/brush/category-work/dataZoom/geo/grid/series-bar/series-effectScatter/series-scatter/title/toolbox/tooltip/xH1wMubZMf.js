var geoCoordMap={南昌:[115.85,28.68],景德镇:[117.17,29.27],萍乡:[113.85,27.63],九江:[116,29.7],新余:[114.92,27.82],鹰潭:[117.07,28.27],赣州:[114.93,25.83],吉安:[114.98,27.12],宜春:[114.38,27.8],抚州:[116.35,28],上饶:[117.97,28.45]},data=[{name:"南昌",value:93.6},{name:"景德镇",value:87.8},{name:"萍乡",value:84.7},{name:"九江",value:81.6},{name:"新余",value:79.6},{name:"鹰潭",value:78.5},{name:"赣州",value:77.2},{name:"吉安",value:74.9},{name:"宜春",value:73.8},{name:"抚州",value:69.9},{name:"上饶",value:68.9}],convertData=function(e){for(var t=[],a=0;a<e.length;a++){var r=geoCoordMap[e[a].name];r&&t.push({name:e[a].name,value:r.concat(e[a].value)})}return t},convertedData=[convertData(data),convertData(data.sort(function(e,t){return t.value-e.value}).slice(0,6))];data.sort(function(e,t){return e.value-t.value});for(var selectedItems=[],categoryData=[],barData=[],sum=0,count=data.length,i=0;i<data.length;i++)categoryData.push(data[i].name),barData.push(data[i].value),sum+=data[i].value;console.log(categoryData),console.log(sum+"   "+count),option={backgroundColor:"#404a59",animation:!0,animationDuration:1e3,animationEasing:"cubicInOut",animationDurationUpdate:1e3,animationEasingUpdate:"cubicInOut",title:[{text:"各地中小学在校生投保率对比",subtext:"内部数据请勿外传",left:"center",textStyle:{color:"#fff"}},{id:"statistic",text:count?"平均: "+parseInt((sum/count).toFixed(4)):"",right:120,top:40,width:100,textStyle:{color:"#fff",fontSize:16}}],toolbox:{iconStyle:{normal:{borderColor:"#fff"},emphasis:{borderColor:"#b1e4ff"}},feature:{dataZoom:{},brush:{type:["rect","polygon","clear"]},saveAsImage:{show:!0}}},brush:{outOfBrush:{color:"#abc"},brushStyle:{borderWidth:2,color:"rgba(0,0,0,0.2)",borderColor:"rgba(0,0,0,0.5)"},seriesIndex:[0,1],throttleType:"debounce",throttleDelay:300,geoIndex:0},geo:{map:"china",left:"10",right:"35%",center:[117.98561551896913,31.205000490896193],zoom:1.5,label:{emphasis:{show:!1}},roam:!0,itemStyle:{normal:{areaColor:"#323c48",borderColor:"#111"},emphasis:{areaColor:"#2a333d"}}},tooltip:{trigger:"item"},grid:{right:40,top:100,bottom:40,width:"30%"},xAxis:{type:"value",scale:!0,position:"top",boundaryGap:!1,splitLine:{show:!1},axisLine:{show:!1},axisTick:{show:!1},axisLabel:{margin:2,textStyle:{color:"#aaa"}}},yAxis:{type:"category",nameGap:16,axisLine:{show:!0,lineStyle:{color:"#ddd"}},axisTick:{show:!1,lineStyle:{color:"#ddd"}},axisLabel:{interval:0,textStyle:{color:"#ddd"}},data:categoryData},series:[{type:"scatter",coordinateSystem:"geo",data:convertedData[0],symbolSize:function(e){return Math.max(e[2]/10,8)},label:{normal:{formatter:"{b}",position:"right",show:!1},emphasis:{show:!0}},itemStyle:{normal:{color:"#ddb926",position:"right",show:!0}}},{type:"effectScatter",coordinateSystem:"geo",data:convertedData[0],symbolSize:function(e){return Math.max(e[2]/10,8)},showEffectOn:"emphasis",rippleEffect:{brushType:"stroke"},hoverAnimation:!0,label:{normal:{formatter:"{b}",position:"right",show:!0}},itemStyle:{normal:{color:"#f4e925",shadowBlur:10,shadowColor:"#333"}},zlevel:1},{id:"bar",zlevel:2,type:"bar",symbol:"none",itemStyle:{normal:{color:"#ddb926"}},data}]};function renderBrushed(e){for(var t=e.batch[0].selected[0],a=[],r=[],n=[],m=30,s=0,l=0,o=0;o<t.dataIndex.length;o++){var c=t.dataIndex[o],u=convertedData[0][c],v=u.value[2];s+=v,l++,a.push(u)}a.sort(function(h,d){return h.value-d.value});for(var o=0;o<Math.min(a.length,m);o++)r.push(a[o].name),n.push(a[o].value[2]);this.setOption({yAxis:{data:r},xAxis:{axisLabel:{show:!!l}},title:{id:"statistic",text:l?"平均: "+(s/l).toFixed(4):""},series:{id:"bar",data:n}})}

var uploadedDataURL="/asset/get/s/data-1497966699001-HyX_djLQb.json";myChart.setOption(option={title:{text:"公交GPS可视化",subtext:"鼠标移动至右侧运行图可见效果",left:10,top:10,textStyle:{color:"rgba(18,89,147,1)",fontSize:40}},tooltip:{trigger:"item",transitionDuration:0,position:function(e,o,t,a,c){var l=20,s=30,m=30;if(Math.abs(e[0]-last_point[0])<l&&Math.abs(e[1]-last_point[1])<l&&counter>=2)return t_pos;if((Math.abs(e[0]-last_point[0])>=l||Math.abs(e[1]-last_point[1])>=l)&&(counter=0),counter+=1,counter==1&&(t_pos.left=e[0]+s,t_pos.top=e[1]+m,last_point=[e[0],e[1]]),counter==2){var i=$(t).position().left,n=$(t).position().top;t_pos.left+=e[0]-i+s,t_pos.top+=e[1]-n+m}return t_pos}},animation:!1,bmap:{center:[120.601206,36.203083],zoom:12,roam:!0,mapStyle:{styleJson:[{featureType:"all",elementType:"all",stylers:{lightness:10,saturation:-100}},{featureType:"subway",elementType:"labels.icon",stylers:{color:"#022338",visibility:"off"}},{featureType:"poi",elementType:"labels",stylers:{color:"#022338",visibility:"off"}},{featureType:"highway",elementType:"labels.icon",stylers:{color:"#022338",visibility:"off"}},{featureType:"all",elementType:"labels",stylers:{visibility:"off"}}]}},animation:!1,grid:[{right:40,bottom:"3%",top:"0",width:"28%"},{show:!0,left:null,right:0,height:"100%",width:"360px",bottom:"0%",backgroundColor:"rgba(255,255,255,0.9)"},{show:!0,left:0,top:0,height:"80px",width:"320px",bottom:"0%",backgroundColor:"rgba(255,255,255,0.8)",zlevel:-1}],dataZoom:[{type:"slider",yAxisIndex:0,start:0,end:80,filterMode:"empty",textStyle:{color:"#000"},borderColor:"#000",handleIcon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4v1.3h1.3v-1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7V23h6.6V24.4z M13.3,19.6H6.7v-1.4h6.6V19.6z",handleSize:"80%",handleStyle:{color:"#000",shadowBlur:3,shadowColor:"rgba(0, 0, 0, 0.6)",shadowOffsetX:2,shadowOffsetY:2}},{type:"inside",yAxisIndex:0,start:0,end:30,filterMode:"empty"}],tooltip:{trigger:"axis",formatter:function(e,o,t){return"时间"+e[0].axisValueLabel}},axisPointer:{type:"shadow",triggerTooltip:!1},xAxis:[{gridIndex:0,name:"时间",axisLine:{lineStyle:{color:"#000"}},axisLabel:{margin:2,textStyle:{color:"#000"}}}],yAxis:[{gridIndex:0,name:"时间",type:"time",axisLine:{lineStyle:{color:"#000"}},axisLabel:{margin:2,textStyle:{color:"#000"}}}],series:[]}),$.getJSON(uploadedDataURL,function(e){console.log(e[0]);for(var o=[{zlevel:2,type:"line",showSymbol:!1,lineStyle:{normal:{opacity:.8,width:3}},xAxisIndex:0,yAxisIndex:0,data:[]}],t=0;t<e[0].length;t+=1)try{var a=0;o.push({type:"scatter",coordinateSystem:"bmap",symbol:planePath,symbolSize:15,data:[{name:e[1][t],value:[e[0][t][a][0],e[0][t][a][1]]}]})}catch{o.push({type:"scatter"})}o.push({type:"lines",data:[{name:"busline",coords:e[0][1]}],zlevel:-1,coordinateSystem:"bmap",polyline:!0,lineStyle:{normal:{color:"rgba(18,89,147,0.5)",opacity:.8,width:1,shadowColor:"rgba(0, 0, 0, 0.9)",shadowBlur:10}},tooltip:{show:!1},progressiveThreshold:500,progressive:200}),o.push({zlevel:-1,type:"scatter",data:e[3],coordinateSystem:"bmap",symbolSize:8,itemStyle:{normal:{color:"rgba(18,89,147,0.5)"}},tooltip:{trigger:"item",formatter:function(i){return i.name}},label:{normal:{show:!1},emphasis:{show:!1}}}),myChart.setOption({series:o});for(var t=0;t<e[0].length;t+=1){for(var c=[],l=0;l<e[0][t].length;l+=1)c.push([e[0][t][l][3],e[0][t][l][2]]);o.push({name:e[1][t],zlevel:2,type:"line",showSymbol:!1,symbolSize:10,lineStyle:{normal:{opacity:.8,width:3}},xAxisIndex:0,yAxisIndex:0,data:c})}myChart.hideLoading();for(var s=[],t=0;t<e[0].length;t+=1)try{var m=params.dataByCoordSys[0].dataByAxis[0].value,a=100;s.push({type:"scatter",coordinateSystem:"bmap",symbol:"path://M1024 476.279467c0 0 0 33.4848 0 41.591467 0 72.362667 0 136.6528 0 136.6528 0 15.479467-12.100267 28.040533-27.016533 28.040533l-41.284267 0c0-56.610133-45.8752-102.5024-102.4512-102.5024s-102.4512 45.8752-102.4512 102.5024L290.304 682.564267c-0.017067-56.610133-45.8752-102.5024-102.468267-102.5024-56.558933 0-102.434133 45.8752-102.4512 102.5024L27.0336 682.564267c-14.916267 0-27.016533-12.544-27.016533-28.040533L0.017067 318.173867C0.017067 290.423467 17.988267 273.066667 44.100267 273.066667c0 0 811.3152 0 844.032 0s98.4576 43.281067 124.125867 101.870933C1025.655467 406.289067 1024 476.279467 1024 476.279467zM170.786133 324.317867 78.574933 324.317867c-15.086933 0-27.323733 12.219733-27.323733 27.306667l0 81.834667c0 15.086933 12.2368 27.2896 27.323733 27.2896l92.2112 0L170.786133 324.317867zM324.471467 324.317867l-119.534933 0 0 136.413867 119.534933 0L324.471467 324.317867zM477.610667 324.317867l-119.005867 0 0 136.413867 119.005867 0L477.610667 324.317867zM631.210667 324.317867l-119.005867 0 0 136.413867 119.005867 0L631.210667 324.317867zM784.896 324.317867l-119.534933 0 0 136.413867 119.534933 0L784.896 324.317867zM784.8448 524.919467c0-7.0144-7.645867-12.6976-17.083733-12.6976s-17.066667 5.6832-17.066667 12.6976l0 25.361067c0 7.0144 7.6288 12.6976 17.066667 12.6976s17.083733-5.6832 17.083733-12.6976L784.8448 524.919467zM966.024533 404.155733c-11.008-46.728533-71.3728-79.837867-88.1152-79.837867-41.0112 0-58.845867 0-58.845867 0l0 136.413867L971.741867 460.8C971.741867 460.8 974.848 441.719467 966.024533 404.155733zM187.835733 614.2464c37.717333 0 68.3008 30.600533 68.3008 68.352 0 37.7344-30.583467 68.334933-68.3008 68.334933-37.7344 0-68.3008-30.600533-68.3008-68.334933C119.534933 644.846933 150.101333 614.2464 187.835733 614.2464zM853.265067 614.2464c37.717333 0 68.3008 30.600533 68.3008 68.352 0 37.7344-30.583467 68.334933-68.3008 68.334933-37.7344 0-68.317867-30.600533-68.317867-68.334933C784.9472 644.846933 815.530667 614.2464 853.265067 614.2464z",symbolSize:25,data:[{name:e[1][t],value:[e[0][t][a][0],e[0][t][a][1]]}],zlevel:-1,itemStyle:{normal:{}},tooltip:{trigger:"item",formatter:function(r){return r.name}},label:{normal:{show:!1},emphasis:{show:!1}}})}catch{s.push({type:"scatter"})}myChart.setOption({series:o.concat(s)}),myChart.on("showtip",function(i){for(var n=[],r=0;r<e[0].length;r+=1)try{var u=i.dataByCoordSys[0].dataByAxis[0].value,h=e[0][r].findIndex(function(y,v,d){var b=Date.parse(y[2]);return b>u});n.push({type:"scatter",coordinateSystem:"bmap",symbol:"path://M1024 476.279467c0 0 0 33.4848 0 41.591467 0 72.362667 0 136.6528 0 136.6528 0 15.479467-12.100267 28.040533-27.016533 28.040533l-41.284267 0c0-56.610133-45.8752-102.5024-102.4512-102.5024s-102.4512 45.8752-102.4512 102.5024L290.304 682.564267c-0.017067-56.610133-45.8752-102.5024-102.468267-102.5024-56.558933 0-102.434133 45.8752-102.4512 102.5024L27.0336 682.564267c-14.916267 0-27.016533-12.544-27.016533-28.040533L0.017067 318.173867C0.017067 290.423467 17.988267 273.066667 44.100267 273.066667c0 0 811.3152 0 844.032 0s98.4576 43.281067 124.125867 101.870933C1025.655467 406.289067 1024 476.279467 1024 476.279467zM170.786133 324.317867 78.574933 324.317867c-15.086933 0-27.323733 12.219733-27.323733 27.306667l0 81.834667c0 15.086933 12.2368 27.2896 27.323733 27.2896l92.2112 0L170.786133 324.317867zM324.471467 324.317867l-119.534933 0 0 136.413867 119.534933 0L324.471467 324.317867zM477.610667 324.317867l-119.005867 0 0 136.413867 119.005867 0L477.610667 324.317867zM631.210667 324.317867l-119.005867 0 0 136.413867 119.005867 0L631.210667 324.317867zM784.896 324.317867l-119.534933 0 0 136.413867 119.534933 0L784.896 324.317867zM784.8448 524.919467c0-7.0144-7.645867-12.6976-17.083733-12.6976s-17.066667 5.6832-17.066667 12.6976l0 25.361067c0 7.0144 7.6288 12.6976 17.066667 12.6976s17.083733-5.6832 17.083733-12.6976L784.8448 524.919467zM966.024533 404.155733c-11.008-46.728533-71.3728-79.837867-88.1152-79.837867-41.0112 0-58.845867 0-58.845867 0l0 136.413867L971.741867 460.8C971.741867 460.8 974.848 441.719467 966.024533 404.155733zM187.835733 614.2464c37.717333 0 68.3008 30.600533 68.3008 68.352 0 37.7344-30.583467 68.334933-68.3008 68.334933-37.7344 0-68.3008-30.600533-68.3008-68.334933C119.534933 644.846933 150.101333 614.2464 187.835733 614.2464zM853.265067 614.2464c37.717333 0 68.3008 30.600533 68.3008 68.352 0 37.7344-30.583467 68.334933-68.3008 68.334933-37.7344 0-68.317867-30.600533-68.317867-68.334933C784.9472 644.846933 815.530667 614.2464 853.265067 614.2464z",symbolSize:25,data:[{name:e[1][r],value:[e[0][r][h][0],e[0][r][h][1]]}],zlevel:-1,itemStyle:{normal:{}},tooltip:{trigger:"item",formatter:function(y){return y.name}},label:{normal:{show:!1},emphasis:{show:!1}}})}catch{n.push({type:"scatter"})}for(var p=[],f=0;f<o.length;f+=1)p.push({});myChart.setOption({series:p.concat(n)})})});

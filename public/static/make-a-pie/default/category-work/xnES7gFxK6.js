var option={bmap:{center:[121.4693,31.2],zoom:10,roam:!0,enableMapClick:!1,mapStyle:{styleJson:[{featureType:"all",elementType:"all",stylers:{lightness:15,saturation:-50}},{featureType:"highway",elementType:"geometry.fill",stylers:{color:"#ffffff"}},{featureType:"poi",elementType:"labels.icon",stylers:{visibility:"off"}},{featureType:"road",elementType:"labels",stylers:{visibility:"off"}}]}},title:{x:"center",text:"上海日间照料设施热力图",subtext:"",textStyle:{color:"#696969",fontSize:25}}};myChart.setOption(option),setTimeout(init,0);function init(){initMap(),initMapv()}function getMap(){return myChart.getModel().getComponent("bmap").getBMap()}function initMap(){var M=new BMap.NavigationControl({type:BMAP_NAVIGATION_CONTROL_SMALL}),K=new BMap.ScaleControl({offset:new BMap.Size(100,50)}),U=getMap();return U.addControl(M),U.addControl(K),U.disableDoubleClickZoom(),U}function initMapv(){for(var M=getMap(),K=[],U=points.length;U--;){var a1=points[U];K.push({geometry:{type:"Point",coordinates:[a1[0],a1[1]]},count:a1[2]})}var t1=new mapv.DataSet(K),j={fillStyle:"#DC143C",strokeStyle:"black",lineWidth:1,size:15,globalAlpha:1,gradient:{.25:"rgb(0,0,255)",.5:"rgb(0,255,0)",.75:"yellow",1:"rgb(255,0,0)"},label:{show:!0,fillStyle:"white",average:!1},max:5,draw:"heatmap",methods:{click:function(n1){console.log(n1)}}},e1=new mapv.baiduMapLayer(M,t1,j)}var points=[[121.375419598552,31.794989911741,1],[121.472057510501,31.2489823712144,1],[121.437170197274,31.197221012831,1],[121.430838311226,31.1995756745814,1],[121.485709607751,31.2200419174149,1],[121.436097530665,31.2214746217424,1],[121.379664073222,31.0383065448668,1],[121.374151191172,31.0381839483837,1],[121.37691276197,31.034697073159,1],[121.563577671756,31.1984755660157,1],[121.375415556177,31.1200161877323,1],[121.38172875747,31.101746204597,1],[121.49688005159,31.2899050069843,1],[121.444127519551,31.2147024472189,1],[121.668695686533,31.2141451212896,1],[121.395045956995,30.8237645782608,1],[121.395362969009,31.3439578768374,1],[121.546845754276,30.8842458030581,1],[121.120384735453,30.9720784777697,1],[121.308435164708,31.4394007535013,1],[121.248022360279,30.8329210612252,1],[121.057075037687,31.1142535832699,1],[121.379243125463,31.2217764568648,1],[121.651424685137,30.9171331001925,1],[121.494601809579,31.2851591184254,1],[121.492811150732,30.8453967825606,1],[121.381213258565,31.1968148054537,1],[121.438395306329,31.2031216872021,1],[121.770161180326,30.9152771486046,1],[121.518296870355,31.1307312314605,1],[121.534253846621,31.3088182399269,1],[121.42238579536,31.2957851787363,1],[121.341453409592,31.3873787161201,1],[121.34682024603,31.4381201995952,1],[121.342295571007,31.4087056190161,1],[121.424615389636,31.2866341587868,1],[121.43136272222,31.3520811287837,1],[121.342263232009,31.3942647782779,1],[121.506260604183,31.3956055519956,1],[121.621167689458,31.5726935728513,1],[121.43204213044,31.6554855095312,1],[121.225376158322,31.7738289250939,1],[121.583184098596,31.6254814759569,1],[121.284987013082,31.8452230479431,1],[121.032870465212,31.0766650624522,1],[121.604561613801,30.9695740561199,1],[121.610006692649,30.9723573792117,1],[121.463270284205,30.914150563144,1],[121.561072038977,30.832646865634,1],[121.483703590488,30.8804019388552,1],[121.40302569467,30.8993422904721,1],[121.044938750586,31.019338930526,1],[121.044502802922,31.0534559570206,1],[121.479310427392,31.2931613917834,1],[121.476285468027,31.2905118118257,1],[121.471994088335,31.3031541756929,1],[121.494689687214,31.2906376668244,1],[121.164345022364,31.3005464092083,1],[121.500650026019,31.2160911638612,1],[121.50207600427,31.2115729354441,1],[121.479210535819,31.2207000383118,1],[121.482657962875,31.2185713484321,1],[121.481265230012,31.2232404750637,1],[121.480282304123,31.2453202079541,1],[121.488468719439,31.2378077475065,1],[121.475632764634,31.2434464806782,1],[121.485418006554,31.2434306577266,1],[121.473435778848,31.2439168456352,1],[121.504875842883,31.2273413445795,1],[121.497159847705,31.2361840048573,1],[121.495726062281,31.2264033019693,1],[121.494890291411,31.2222521655822,1],[121.414345601724,31.2526620846039,1],[121.50322709295,31.2255243851069,1],[121.204917543431,31.4115869040505,1],[121.253275471241,31.3714144166778,1],[121.257483493572,31.3940774443095,1],[121.024437891729,31.020110456019,1],[121.253501574737,31.3850711747581,1],[121.334384194381,31.2643521264968,1],[121.252619985795,31.4110252270937,1],[121.28926805777,31.3372830466235,1],[121.298705296136,31.3839425841505,1],[121.314514305314,31.2945215088285,1],[121.184240405341,31.3593950950005,1],[121.270863116346,31.3905777096785,1],[121.387312444859,30.7994416476357,1],[121.411092298489,30.8038169539484,1],[121.435572650755,30.81607420021,1],[121.081871636611,30.8735964388165,1],[121.041756413486,30.9061526218124,1],[121.344274987199,30.8648402519372,1],[121.385492657557,30.8562889671341,1],[121.342353253001,30.8533347135566,1],[121.283307710881,30.7707834252285,1],[121.320170126635,30.7504341135338,1],[121.319276043161,30.7322718633636,1],[121.255138287377,30.7806307584895,1],[121.202330501464,30.8046750468687,1],[121.1988845099,30.797033014634,1],[121.202442608195,30.8047666513497,1],[121.189066415151,30.7861260452923,1],[121.201393162783,30.7932997224104,1],[121.148241458809,30.8074443173766,1],[121.180994486177,30.8313525463332,1],[121.139000500197,30.9484907187308,1],[121.382612432279,30.7668267563722,1],[121.378580082573,30.7732441036199,1],[121.377416008887,30.7700205938079,1],[121.383019802149,30.7388671946375,1],[121.345429279236,30.7803221990066,1],[121.366414714628,30.7428850092894,1],[121.369571989004,30.7920498302599,1],[121.361590095395,30.7527116388023,1],[121.348389495926,30.730469494733,1],[121.515549239461,31.267087455716,1],[121.406671557413,31.2425431788205,1],[121.346871988428,30.7214486811635,1],[121.417718289761,30.8009584991072,1],[121.262529275621,30.8523108924913,1],[121.345376399584,30.8903490992557,1],[121.298857918242,30.8581895517137,1],[121.245877835535,30.9171261294049,1],[121.288679308339,30.8964804341677,1],[121.304621895547,30.8849817059168,1],[121.246720038273,30.8993458042536,1],[121.27192805124,30.8784218823146,1],[121.279863248233,30.7893047989385,1],[121.31688744881,30.799486316,1],[121.294759397556,30.8103355897258,1],[121.279024410548,30.8126439587694,1],[121.174711864102,30.891798786,1],[121.216118321448,30.8978746761695,1],[121.179200031091,30.9127097225313,1],[121.480162649829,31.2049094302128,1],[121.390833622797,31.1513182382084,1],[121.38929500512,31.1771248279827,1],[121.302127211315,31.2106071314423,1],[121.425933563141,31.0123413735272,1],[121.395340960524,31.0288816661045,1],[121.549489467392,31.061476548605,1],[121.536437806976,31.1049495382507,1],[121.509360004328,31.0352118819347,1],[121.479323093499,31.050405326571,1],[121.316921045436,31.2195158003406,1],[121.318340547803,31.2143507294212,1],[121.397648128871,31.0676878395846,1],[121.528365454003,31.1940658493762,1],[121.538872933553,31.1493744070405,1],[121.622184211973,31.3380557594464,1],[121.583783178541,31.2940441471092,1],[121.618422326786,31.3033771681635,1],[121.590800741185,31.3533112733688,1],[121.542931833576,31.206883079096,1],[121.5423303318,31.1941812247261,1],[121.574196766664,31.2317276783339,1],[121.9237855412,30.8891158557756,1],[121.692675592799,31.2506322167193,1],[121.530528753332,31.2160875326289,1],[121.523627970404,31.2179132451884,1],[121.826416060922,30.9777199195254,1],[121.522177207006,31.2319240389101,1],[121.531550935172,31.2311124110338,1],[121.531913940428,31.2253816423621,1],[121.525628227283,31.2252695478528,1],[121.527591294314,31.2277853887939,1],[121.530367148171,31.2240141882577,1],[121.54138962627,31.2348142384663,1],[121.628175338402,31.2184193161849,1],[121.633871795472,31.1922055373932,1],[121.502606274012,31.1785212361064,1],[121.413246704594,31.2412992430896,1],[121.446450269006,31.2694750898218,1],[121.42848484062,31.2590263118045,1],[121.40659115907,31.2817770884334,1],[121.392049119983,31.2795252601165,1],[121.418236682108,31.2746644478903,1],[121.447146957929,31.2657140521941,1],[121.428141508254,31.2357748910452,1],[121.40785462577,31.2356455180786,1],[121.421876456136,31.2415179904949,1],[121.421699489951,31.2390235913603,1],[121.420014178983,31.2296612053128,1],[121.404132407059,31.2361859346352,1],[121.440564695271,31.250848772482,1],[121.382859274955,31.2496604484661,1],[121.394763978895,31.2498831124834,1],[121.401353498964,31.2443067821027,1],[121.39476963822,31.2652756669229,1],[121.008257754816,31.0463712637795,1],[120.949014633992,31.0653896143891,1],[120.918683882041,31.1145828111003,1],[120.987158302895,31.0598702885706,1],[120.931198361151,31.1216263674827,1],[120.92432153154,31.0412896522956,1],[121.009104714979,31.0649154151535,1],[120.99028108234,31.0305222608236,1],[120.886904174082,31.1253183775044,1],[120.897765226681,31.1305220475555,1],[120.961300668621,31.0579350065899,1],[120.967505264779,31.0775518694411,1],[121.036627448347,31.0653016108627,1],[121.062234994367,31.0471155963203,1],[121.03370319442,31.0402473448415,1],[121.480162649829,31.2049094302128,1],[121.113978469708,31.2196766179414,1],[121.086190466724,31.0542941805459,1],[121.121454347823,31.0772147461363,1],[121.134156477565,31.1623186414293,1],[121.118824468612,31.1406505063882,1],[121.138964028993,31.1733998641639,1],[121.120042775697,31.1278674919014,1],[121.124064284652,31.1516024812223,1],[121.136256805678,31.1475636618446,1],[121.108635887518,31.1409961337527,1],[121.135380957806,31.1587238822911,1],[121.132088668111,31.1333311444973,1],[121.152629501564,31.1109751274552,1],[121.129551404199,31.1608978890574,1],[121.154726595777,31.1672295773118,1],[121.087834186146,31.228626766515,1],[121.103163462453,31.2232529874666,1],[121.151023960126,31.2085959246922,1],[121.142631990052,31.2175851183092,1],[121.11405987056,31.2211414282816,1],[121.139511245269,31.1901113368624,1],[121.076838028398,31.2236730357229,1],[121.300975853143,31.2076861864258,1],[121.277918506635,31.1827289493722,1],[121.277022985872,31.1663688765891,1],[121.602512101932,31.2727755702417,1],[121.488974847221,31.226743904159,1],[121.059785854224,31.1123138543646,1],[121.07634593664,31.1497448807704,1],[121.091342069162,31.0492043984565,1],[121.064543280205,31.1546889232586,1],[121.061715773782,31.1030240726179,1],[121.108326151778,31.06862380293,1],[121.099335461082,31.0825762553713,1],[121.05983085933,30.9998046692764,1],[121.054007144709,30.9827729033733,1],[121.41642365186,31.0112877915958,1],[121.432281978011,31.0215818456505,1],[121.714264569121,31.1154329677245,1],[121.516955177415,31.1957735290498,1],[121.71196409854,31.0321246890163,1],[121.769228836224,31.1273812381417,1],[121.385927886577,30.998372097765,1],[121.588213980638,31.1090964718926,1],[121.754668711552,31.1834096978904,1],[121.311102630818,30.9872168442536,1],[121.263142369132,31.0108197772187,1],[121.29298201207,30.9708520912223,1],[121.235276776805,31.0643545013448,1],[121.178928652996,30.9365916029082,1],[121.150497642927,30.9621920783263,1],[121.15021602415,31.0095223194021,1],[121.12676207576,31.0355660965884,1],[121.073868050721,30.9368255406353,1],[121.327718692937,30.9380634628659,1],[121.220758177204,31.0128112876486,1],[121.23934158678,30.9999183941088,1],[121.240136405699,31.0248151394829,1],[121.230748035153,31.0223318447647,1],[121.438462164513,31.1671821564765,1],[121.45759919169,31.1879113647835,1],[121.44119155172,31.1398052477888,1],[121.459914933465,31.1745419704071,1],[121.432270030548,31.1688358576446,1],[121.431877291379,31.1799717669106,1],[121.550941308757,31.2998763093661,1],[121.549851304851,31.3051391672929,1],[121.064620354818,31.1116389281464,1],[121.518778999905,31.2743478725111,1],[121.529326820559,31.2908640133474,1],[121.534455246716,31.2638202369183,1],[121.53034918206,31.2679868936721,1],[121.531196649767,31.2633588378543,1],[121.519207940786,31.2830999074743,1],[121.512397842698,31.3110390626612,1],[121.549065107869,31.3321741654561,1],[121.546425032891,31.2997888728225,1],[121.348252414505,30.7910411408837,1],[121.023059441924,31.0195125475228,1],[121.424990432187,31.206821378658,1],[121.409828382636,31.2189619309826,1],[121.432728580477,31.2105988817801,1],[121.423093390611,31.220045733051,1],[121.507927566362,30.901671174411,1],[121.741560395008,30.8718961454877,1],[121.447659835579,31.2374483194911,1],[121.447490166329,31.2213221290604,1],[121.463282231669,31.2264020667823,1],[121.453922483831,31.2433531922992,1],[121.463284567263,31.2634062752071,1],[121.4725849937,31.2548368445297,1],[121.441427013764,31.2417186831477,1],[121.370640520713,31.2439959231379,1],[121.276189250562,31.1756022413165,1],[121.046778395753,31.0663510989682,1],[121.339928535988,31.4826387089352,1],[121.334961535332,31.4944150519686,1],[121.470236463774,31.2251912668969,1],[121.305993967382,31.3084988394188,1],[121.501985814397,31.2124126830597,1],[121.556257660426,31.2366538660035,1],[121.743858615333,30.9722700629453,1],[121.597485977502,31.0854585128238,1],[121.491580202691,31.2394840984479,1],[121.406904488032,31.2487703273591,1],[121.439053943929,31.2647159722648,1],[121.429289790629,31.2428617648029,1],[121.539433981039,31.0648129217634,1],[121.535754783077,31.069461074739,1],[121.591183490298,31.0982612452597,1],[121.586555169684,31.1206846390352,1],[121.823464653016,31.0050102493191,1],[121.541148970224,31.1676558305883,1],[121.46446116782,30.9207832439319,1],[121.541648787409,30.8984822397649,1],[121.558590380175,30.9544234954605,1],[121.581741689439,30.8919961277782,1],[121.537433578634,30.8831820731996,1],[121.426192454789,30.8364894853941,1],[121.417982032259,31.382778219422,1],[121.39285975896,31.4338598236383,1],[121.486316132403,31.4093095995078,1],[121.561874405458,31.2895215868333,1],[121.548038703993,31.2796401443325,1],[121.537364588771,31.2857423068127,1],[121.535399055892,31.3404923199862,1],[121.465609741245,31.2144699402378,1],[121.460846476278,31.1278205955403,1],[121.399548803194,31.2433519288546,1],[121.641542765781,31.322033620977,1],[121.079477160156,30.9802365660803,1],[121.146212995137,31.14593484213,1],[121.111001664909,31.1198557401632,1],[121.481266963742,31.3186713097602,1],[121.464753296772,31.2632414428369,1],[121.476213339485,31.3318880031294,1],[121.539282740527,31.3349685780551,1],[121.545671040161,31.6822352216097,1],[121.625547827125,31.6111090954425,1],[121.459076400305,31.2001939628681,1],[121.581497170679,31.2532768014976,1],[121.540533630949,31.3647628509238,1],[121.623297540382,31.5412844270225,1],[121.486309574773,31.3053964562606,1],[121.400972617427,31.3119713067526,1],[121.910927180859,30.9066412519196,1],[121.570026527961,31.6341980597286,1],[121.441634685828,31.0196374215824,1],[121.474678854013,31.0498352994843,1],[121.453399972753,31.0489458337771,1],[121.473668260314,31.0530201366201,1],[121.449029087634,31.0616459892676,1],[121.469623460094,31.04733201217,1],[121.27861033842,31.2443338052108,1],[121.314397345937,31.2268871852175,1],[121.275878311093,31.2480721456423,1],[121.312106038072,31.2196551550227,1],[121.456016736704,31.0515905387446,1],[121.412954395981,31.0605528557625,1],[121.394714751753,31.0274249345604,1],[121.553095804692,30.9327885818001,1],[121.531743711534,30.9089717380852,1],[121.588725385965,30.9291127249356,1],[121.601003156184,30.9225184224981,1],[121.547546612235,30.9903833641573,1],[121.483269259774,31.2937606449325,1],[121.471781100099,31.3054198580803,1],[121.487190771156,31.3026620109559,1],[121.480154834571,31.3083537551755,1],[121.437044143452,31.2684296347361,1],[121.204555961737,31.0109188190674,1],[121.294634473802,31.7487668885026,1],[121.417334377342,31.2484405262687,1],[121.312878210709,31.3047007676288,1],[121.33095383513,31.3095796752196,1],[121.351336027829,31.3877656641306,1],[121.442010661718,31.2744855371862,1],[121.398376294419,31.2406710053385,1],[121.471408303312,31.2778273644854,1],[121.491794253623,31.2741855406701,1],[121.038713044249,30.8613188495721,1],[121.438135516375,31.2339199620129,1],[121.174462906814,30.9014825449207,1],[121.527736999468,31.036138375936,1],[121.311576397144,30.8559643069335,1],[121.084819922007,30.9419531307207,1],[121.400895991967,31.1602571490414,1],[121.400540622308,31.160848524266,1],[121.403017070938,30.830168371375,1],[121.410983064539,31.009034762209,1],[121.301735550112,30.8161519684901,1],[,,1],[121.358020713485,31.7202640796647,1],[121.792200836522,31.5421659584205,1],[121.381396160754,31.337172216529,1],[121.359877655601,31.3521386616133,1],[121.246480090092,31.4699070819214,1],[121.408339351423,30.9683069187347,1],[121.516656490833,30.8630765834352,1],[121.588725385965,30.9291127249356,1],[121.534133383852,30.9507171989043,1],[121.533108237604,30.9427308634825,1],[121.585280743657,30.9811869749117,1],[121.473318190657,31.220873978516,1],[121.726743261536,30.9448376798432,1],[121.738803131584,30.9027583236724,1],[121.426449459996,31.3694804766279,1],[121.494757958433,31.3309778453229,1],[121.579013104419,31.2618012972275,1],[121.526916487215,30.8803511873385,1],[121.430939280765,30.993488252327,1],[121.432767332478,31.2122743213375,1],[121.35729493743,31.2132188367737,1],[121.3556811217,31.215878833357,1],[121.361658989139,31.2188006574138,1],[121.482768813774,30.9912401807785,1],[121.432259215848,31.2281666731036,1],[121.371720376462,31.2528012355617,1],[121.478660519525,31.3143168757528,1],[121.329786217628,31.3412966616565,1],[121.282716715686,31.3561814500914,1],[121.421068250669,31.1517741546235,1],[121.222569592299,31.2733673673634,1],[121.442880802655,31.1706626014753,1],[121.230771652503,31.3122396124696,1],[121.403120825224,31.160778223814,1],[121.745152469013,31.0718674710274,1],[121.452313112917,31.2365490409351,1],[121.515919700654,31.2039321678747,1],[121.423883899459,31.0991677664041,1],[121.337412831408,31.769668405932,1],[121.465214935973,31.1792304387955,1],[121.555755597477,31.2476061259995,1],[121.543813344366,31.2900597632429,1],[121.635650440382,31.5453649654862,1],[121.452965282717,31.1400515859375,1],[121.49872637304,31.2528239386035,1],[121.706028556561,31.1960847058941,1],[121.181707471261,30.8329723032313,1],[121.450644727822,31.2569126811991,1],[121.454650144532,31.2236179138797,1],[121.464330194877,31.2677061674839,1],[121.463551094508,31.2461800290438,1],[121.479567252937,30.9043490529513,1],[121.450669932478,31.1798782322945,1],[121.469876782248,31.273721070047,1],[121.478999434024,31.2795290407276,1],[121.71677686014,31.5714662012807,1],[121.388644811592,31.0451776545436,1],[121.472665892399,31.2820143681501,1],[121.546845754276,30.8842458030581,1],[121.528485916772,31.1491919897198,1],[121.509128688863,31.391799400684,1],[121.336286446129,30.9694551538532,1],[121.533456348955,31.2902873183547,1],[121.575195377866,30.8818805394424,1],[121.428973069665,31.2490758081842,1],[121.421012016744,31.0242929242325,1],[121.739664897619,31.2158780073101,1],[121.510869157585,31.1505132517594,1],[121.500003254136,31.279784424511,1],[121.507171258699,31.2770354649283,1],[121.414561913691,31.1723057896537,1],[121.121517363955,31.0393932550249,1],[121.783298449257,31.557627877066,1],[121.72748484148,31.2450467461425,1],[121.505296471744,31.2728183761705,1],[121.553301372027,31.1781180034025,1],[121.365430171789,30.8138062538024,1],[121.721630128978,31.1870486414338,1],[121.776288252718,31.0498401721864,1],[121.758236923868,31.0544658639371,1],[121.188585976212,30.86629065447,1],[121.465467988636,31.1223618906381,1],[121.494884436255,31.2700104379951,1],[121.247506104103,31.3808738027498,1],[121.495141804377,31.2668828894747,1],[121.488696542292,31.2574312290438,1],[121.331443225684,31.1325951106451,1],[121.335418772837,31.4913986494108,1],[121.437025300595,31.1873939678411,1],[121.461633861719,31.193104504312,1],[121.468325588293,31.1982293113814,1],[121.291087036597,31.4750768878192,1],[121.58186080475,30.9343657196239,1],[121.406240686074,31.2819222291192,1],[121.243899137989,31.187891902589,1],[121.458180575016,31.1909826337903,1],[121.443003015323,31.2610767501236,1],[121.482461323798,31.0500012032459,1],[121.448035741401,31.2286574910561,1],[121.4286673763,31.2500346935075,1],[121.465941634589,31.2411835226494,1],[121.47488214055,31.214948326159,1],[121.140893586534,31.1513909887407,1],[121.1271191522,31.1493519236033,1],[121.242035693039,31.1869414166069,1],[121.510125719945,31.1779356880003,1],[121.507055850695,31.2199578743679,1],[121.122733714531,30.981279778389,1],[121.090367587345,31.1015769134168,1],[121.504345123988,31.2787991484811,1],[121.628175338402,31.2184193161849,1],[121.502638343519,31.2278469156163,1],[121.503298598069,31.285909876882,1],[121.237590518053,31.0232337080953,1],[121.366275477274,31.17683803613,1],[121.471235469332,31.2233013872603,1],[121.389026117128,31.17126239187,1],[121.342559582997,31.1621795877182,1],[121.430530478996,31.2421424221398,1],[121.477149599301,31.2254820907399,1],[121.393680981772,31.2590501580303,1],[121.48209804905,31.2132159800014,1],[121.420493335143,31.7681656763809,1],[121.582381642284,31.3485925969088,1],[121.486098960758,31.217478100135,1],[121.358581221089,31.1855487638508,1],[121.511496006848,31.2739677329719,1],[121.403994247671,31.2399168155794,1],[121.449071397823,31.6374379171314,1],[121.426679695698,31.2418508962029,1],[121.377091165445,31.3302020103217,1],[121.58110119761,31.3465038287535,1],[121.41755997689,31.2231337685343,1],[121.536099415291,31.2944450601459,1],[121.384180412868,31.1668200849803,1],[121.54864880435,31.2924318271243,1],[121.440578637871,31.22898581071,1],[121.728364821558,30.9045833801847,1],[121.420842596325,31.2039788073646,1],[121.596981091358,31.0539844118814,1],[121.340410926047,31.015626436798,1],[121.118431955816,31.21813667724,1],[121.402083905784,31.2663193097096,1],[121.485099835725,31.2107192821164,1],[121.586235462753,31.5698649329417,1],[121.349712071128,31.4210862417172,1],[121.179309804024,30.9848108094534,1],[121.322950112697,31.0147123531388,1],[121.389868483357,31.1492501685988,1],[121.398109987259,31.1572808257147,1],[121.506890023498,31.3139295019622,1],[121.221329751034,31.2696294876409,1],[121.345510425868,31.0660854046467,1],[121.368771958117,31.2148392302949,1],[121.044138450207,31.0102293927926,1],[121.561195979984,31.1910475233022,1],[121.161017417585,31.2393889098273,1],[121.374229002395,31.6845129694279,1],[121.440467158157,31.3250633380773,1],[121.32840237799,31.1315730248588,1],[121.196337454457,31.2107589691386,1],[121.399970469597,31.2566826607024,1],[121.519492620989,31.1821871429284,1],[121.71609702253,31.3912639216569,1],[121.454571164613,31.1274657497915,1],[121.298530665544,31.2995041924452,1],[121.501285585252,31.4129823235069,1],[121.330682996019,31.4892259473356,1],[121.542613028544,31.3402368577107,1],[121.49629495916,31.4139449169937,1],[121.397906769891,31.0652244313931,1],[121.390762656662,31.1924916644135,1],[121.452702977508,31.0478478347915,1],[121.369393495699,31.3591024174287,1],[121.314397345937,31.2268871852175,1],[121.476644576435,31.3127884455024,1],[121.366948487762,31.1223582582483,1],[121.409174506056,31.14956802707,1],[121.501846648009,31.2960255004953,1],[121.308208916583,31.3267052965769,1],[121.482569300121,31.2866841516211,1]],mapv={};(function(M,K){K(mapv)})(window,function(M){"use strict";var K="2.0.13",U=function(e){e&&e.clearRect&&e.clearRect(0,0,e.canvas.width,e.canvas.height)},a1=function(e){var t=window.devicePixelRatio;e.canvas.width=e.canvas.width*t,e.canvas.height=e.canvas.height*t,e.canvas.style.width=e.canvas.width/t+"px",e.canvas.style.height=e.canvas.height/t+"px",e.scale(t,t)};function t1(){this._subscribers={}}t1.prototype.on=function(e,t){var r=this._subscribers[e];r||(r=[],this._subscribers[e]=r),r.push({callback:t})},t1.prototype.off=function(e,t){var r=this._subscribers[e];if(r)for(var n=0;n<r.length;n++)r[n].callback==t&&(r.splice(n,1),n--)},t1.prototype._trigger=function(e,t,r){if(e=="*")throw new Error("Cannot trigger event *");var n=[];e in this._subscribers&&(n=n.concat(this._subscribers[e])),"*"in this._subscribers&&(n=n.concat(this._subscribers["*"]));for(var a=0,i=n.length;a<i;a++){var o=n[a];o.callback&&o.callback(e,t,r||null)}};var j=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e1=function(){function e(t,r){for(var n=0;n<r.length;n++){var a=r[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),n1=function e(t,r,n){t===null&&(t=Function.prototype);var a=Object.getOwnPropertyDescriptor(t,r);if(a===void 0){var i=Object.getPrototypeOf(t);return i===null?void 0:e(i,r,n)}else{if("value"in a)return a.value;var o=a.get;return o===void 0?void 0:o.call(n)}},m1=function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},w1=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e};function A(e,t){this._options=t||{},this._data=[],e&&this.add(e)}A.prototype=new t1,A.prototype.add=function(e,t){if(Array.isArray(e))for(var r=0,n=e.length;r<n;r++){if(e[r].time&&e[r].time.length==14&&e[r].time.substr(0,2)=="20"){var a=e[r].time;e[r].time=new Date(a.substr(0,4)+"-"+a.substr(4,2)+"-"+a.substr(6,2)+" "+a.substr(8,2)+":"+a.substr(10,2)+":"+a.substr(12,2)).getTime()}this._data.push(e[r])}else if(e instanceof Object)this._data.push(e);else throw new Error("Unknown dataType")},A.prototype.get=function(e){e=e||{};var r=new Date,t=this._data,r=new Date;if(e.filter){for(var n=[],a=0;a<t.length;a++)e.filter(t[a])&&n.push(t[a]);t=n}return e.transferCoordinate&&(t=this.transferCoordinate(t,e.transferCoordinate,e.fromColumn,e.toColumn)),t},A.prototype.set=function(e){this._set(e),this._trigger("change")},A.prototype._set=function(e){this.clear(),this.add(e)},A.prototype.clear=function(e){this._data=[]},A.prototype.remove=function(e){},A.prototype.update=function(e){},A.prototype.transferCoordinate=function(e,t,r,n){n=n||"_coordinates",r=r||"coordinates";for(var a=0;a<e.length;a++){var i=e[a].geometry,o=i[r];switch(i.type){case"Point":i[n]=t(o);break;case"LineString":for(var l=[],s=0;s<o.length;s++)l.push(t(o[s]));i[n]=l;break;case"Polygon":var l=v(o);i[n]=l;break;case"MultiPolygon":for(var l=[],f=0;f<o.length;f++){var d=o[f],d=v(d);l.push(d)}i[n]=l;break}}function v(c){for(var y=[],g=0;g<c.length;g++){for(var w=c[g],x=[],p=0;p<w.length;p++)x.push(t(w[p]));y.push(x)}return y}return e},A.prototype.initGeometry=function(e){e?this._data.forEach(function(t){t.geometry=e(t)}):this._data.forEach(function(t){!t.geometry&&t.lng&&t.lat&&(t.geometry={type:"Point",coordinates:[t.lng,t.lat]})})},A.prototype.getMax=function(e){var t=this._data;if(!(!t||t.length<=0)){for(var r=parseFloat(t[0][e]),n=1;n<t.length;n++){var a=parseFloat(t[n][e]);a>r&&(r=a)}return r}},A.prototype.getSum=function(e){var t=this._data;if(!(!t||t.length<=0)){for(var r=0,n=0;n<t.length;n++)t[n][e]&&(r+=parseFloat(t[n][e]));return r}},A.prototype.getMin=function(e){var t=this._data;if(!(!t||t.length<=0)){for(var r=parseFloat(t[0][e]),n=1;n<t.length;n++){var a=parseFloat(t[n][e]);a<r&&(r=a)}return r}};var i1={drawDataSet:function(t,r,n){for(var a=r instanceof A?r.get():r,i=0,o=a.length;i<o;i++){var s=a[i];this.draw(t,s,n)}},draw:function(t,r,n){var a=r.geometry.type,i=r.geometry._coordinates||r.geometry.coordinates,o=n.symbol||"circle";switch(a){case"Point":var s=r._size||r.size||n._size||n.size||5;n.symbol==="rect"?t.rect(i[0]-s/2,i[1]-s/2,s,s):(n.bigData==="Point"&&t.moveTo(i[0],i[1]),t.arc(i[0],i[1],s,0,Math.PI*2));break;case"LineString":for(var l=0;l<i.length;l++){var f=i[l][0],d=i[l][1];l==0?t.moveTo(f,d):t.lineTo(f,d)}break;case"Polygon":this.drawPolygon(t,i);break;case"MultiPolygon":for(var v=0;v<i.length;v++){var c=i[v];this.drawPolygon(t,c)}t.closePath();break;default:console.log("type"+a+"is not support now!");break}},drawPolygon:function(t,r){for(var n=0;n<r.length;n++){var a=r[n];t.moveTo(a[0][0],a[0][1]);for(var i=1;i<a.length;i++)t.lineTo(a[i][0],a[i][1]);t.lineTo(a[0][0],a[0][1])}}},_1={draw:function(t,r,n){var a=r instanceof A?r.get():r;t.save();for(var i in n)t[i]=n[i];if(n.bigData){t.save(),t.beginPath();for(var o=0,s=a.length;o<s;o++){var l=a[o];i1.draw(t,l,n)}var f=n.bigData;f=="Point"||f=="Polygon"||f=="MultiPolygon"?(t.fill(),(l.strokeStyle||n.strokeStyle)&&n.lineWidth&&t.stroke()):f=="LineString"&&t.stroke(),t.restore()}else for(var o=0,s=a.length;o<s;o++){var l=a[o];t.save(),l.fillStyle&&(t.fillStyle=l.fillStyle),l.strokeStyle&&(t.strokeStyle=l.strokeStyle);var f=l.geometry.type;t.beginPath(),i1.draw(t,l,n),f=="Point"||f=="Polygon"||f=="MultiPolygon"?(t.fill(),(l.strokeStyle||n.strokeStyle)&&n.lineWidth&&t.stroke()):f=="LineString"&&t.stroke(),t.restore()}t.restore()}};function h1(e,t){var r;if(typeof document>"u"){var n=require("canvas");r=new n(e,t)}else{var r=document.createElement("canvas");e&&(r.width=e),t&&(r.height=t)}return r}function k(e){e=e||{},this.gradient=e.gradient||{.25:"rgba(0, 0, 255, 1)",.55:"rgba(0, 255, 0, 1)",.85:"rgba(255, 255, 0, 1)",1:"rgba(255, 0, 0, 1)"},this.maxSize=e.maxSize||35,this.minSize=e.minSize||0,this.max=e.max||100,this.min=e.min||0,this.initPalette()}k.prototype.setMax=function(e){this.max=e||100},k.prototype.setMin=function(e){this.min=e||0},k.prototype.setMaxSize=function(e){this.maxSize=e||35},k.prototype.setMinSize=function(e){this.minSize=e||0},k.prototype.initPalette=function(){var e=this.gradient,t=new h1(256,1),r=this.paletteCtx=t.getContext("2d"),n=r.createLinearGradient(0,0,256,1);for(var a in e)n.addColorStop(parseFloat(a),e[a]);r.fillStyle=n,r.fillRect(0,0,256,1)},k.prototype.getColor=function(e){var t=this.getImageData(e);return"rgba("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]/256+")"},k.prototype.getImageData=function(e){var t=this.paletteCtx.getImageData(0,0,256,1).data;if(e===void 0)return t;var r=this.max,n=this.min;e>r&&(e=r),e<n&&(e=n);var a=Math.floor((e-n)/(r-n)*(256-1))*4;return[t[a],t[a+1],t[a+2],t[a+3]]},k.prototype.getSize=function(e){var t=0,r=this.max,n=this.min,a=this.maxSize,i=this.minSize;return e>r&&(e=r),e<n&&(e=n),t=i+(e-n)/(r-n)*(a-i),t},k.prototype.getLegend=function(e){var t=this.gradient,r=e.width||20,n=e.height||180,a=new h1(r,n),i=a.getContext("2d"),o=i.createLinearGradient(0,n,0,0);for(var s in t)o.addColorStop(parseFloat(s),t[s]);return i.fillStyle=o,i.fillRect(0,0,r,n),a};var q1=typeof window>"u"?{}:window,E1=q1.devicePixelRatio;function G1(e){var t=e/2,r=e+t,n=1e4,a=new h1(r*2,r*2),i=a.getContext("2d");return i.shadowBlur=t,i.shadowColor="black",i.shadowOffsetX=i.shadowOffsetY=n,i.beginPath(),i.arc(r-n,r-n,e,0,Math.PI*2,!0),i.closePath(),i.fill(),a}function $1(e,t,r){for(var n=r.maxOpacity||.8,a=3,i=e.length,o;a<i;a+=4)o=e[a]*4,e[a]/256>n&&(e[a]=256*n),e[a-3]=t[o],e[a-2]=t[o+1],e[a-1]=t[o+2]}function Y1(e,t,r){var n=r.max||100,a=r.min||0,i=r._size;i==null&&(i=r.size,i==null&&(i=13));var o=new k({gradient:r.gradient,max:n,min:a}),s=G1(i),l=s.width/2,f=s.height/2,d=t,v={};d.forEach(function(g,w){var x=g.count===void 0?1:g.count,p=Math.min(1,x/n).toFixed(2);v[p]=v[p]||[],v[p].push(g)});for(var c in v)if(!isNaN(c)){var y=v[c];e.beginPath(),r.withoutAlpha||(e.globalAlpha=c),e.strokeStyle=o.getColor(c*n),y.forEach(function(g,w){if(!!g.geometry){var x=g.geometry._coordinates||g.geometry.coordinates,p=g.geometry.type;if(p==="Point"){var _=g.count===void 0?1:g.count;e.globalAlpha=_/n,e.drawImage(s,x[0]-l,x[1]-f)}else if(p==="LineString"){var _=g.count===void 0?1:g.count;e.globalAlpha=_/n,e.beginPath(),i1.draw(e,g,r),e.stroke()}}})}}function V1(e,t,r){var n=r.strength||.3;e.strokeStyle="rgba(0,0,0,"+n+")";var a=new h1(e.canvas.width,e.canvas.height),i=a.getContext("2d");i.scale(E1,E1),r=r||{};var o=t instanceof A?t.get():t;e.save();var s=new k({gradient:r.gradient});if(Y1(i,o,r),!r.absolute){var l=i.getImageData(0,0,e.canvas.width,e.canvas.height);$1(l.data,s.getImageData(),r),e.putImageData(l,0,0),e.restore()}s=null,a=null}var P1={draw:V1},I1={draw:function(t,r,n){t.save();for(var a=r instanceof A?r.get():r,i={},o={},s=n._size||n.size||50,l=n.offset||{x:0,y:0},f=0;f<a.length;f++){var d=a[f].geometry._coordinates||a[f].geometry.coordinates,v=Math.floor((d[0]-l.x)/s)+","+Math.floor((d[1]-l.y)/s);i[v]||(i[v]=0,o[v]=[]);var c=~~(a[f].count||1);i[v]+=c,o[v].push(a[f])}for(var v in i){var y=i[v];o[v].forEach(_=>{_.total=y,_.average=parseInt(y/o[v].length)})}var g=new k({max:n.max||100,gradient:n.gradient});for(var v in i){v=v.split(","),t.beginPath(),t.rect(v[0]*s+.5+l.x,v[1]*s+.5+l.y,s,s);var w=i[v];n.label.average&&(w=parseInt(i[v]/o[v].length)),t.fillStyle=g.getColor(w),t.fill(),n.strokeStyle&&n.lineWidth&&t.stroke()}if(n.label&&n.label.show!==!1){t.fillStyle=n.label.fillStyle||"white",n.label.font&&(t.font=n.label.font),n.label.shadowColor&&(t.shadowColor=n.label.shadowColor),n.label.shadowBlur&&(t.shadowBlur=n.label.shadowBlur);for(var v in i){v=v.split(",");var w=i[v];n.label.average&&(w=parseInt(w/o[v].length));var x=t.measureText(w).width;t.fillText(w,v[0]*s+.5+l.x+s/2-x/2,v[1]*s+.5+l.y+s/2+5)}}t.restore()}};function J1(e,t,r){var n=60*r+30,a=Math.PI/180*n;return[e.x+t*Math.cos(a),e.y+t*Math.sin(a)]}var z1={draw:function(t,r,n){t.save();var a=r instanceof A?r.get():r;for(var i in n)t[i]=n[i];var o={},s=n.offset||{x:10,y:10},l=n._size||n.size||40;l=l/2/Math.sin(Math.PI/3);for(var f=l*2*Math.sin(Math.PI/3),d=l*1.5,v={},c=0;c<a.length;c++){var y=a[c].geometry._coordinates||a[c].geometry.coordinates,g=(y[1]-s.y)/d,w=Math.round(g),x=(y[0]-s.x)/f-(w&1?.5:0),p=Math.round(x),_=g-w;if(Math.abs(_)*3>1){var F=x-p,z=p+(x<p?-1:1)/2,m=w+(g<w?-1:1),C=x-z,R=g-m;F*F+_*_>C*C+R*R&&(p=z+(w&1?1:-1)/2,w=m)}var Y=p+"-"+w,q=v[Y];q?q.push(a[c]):(q=v[Y]=[a[c]],q.i=p,q.j=w,q.x=(p+(w&1?1/2:0))*f,q.y=w*d)}var N=new k({max:n.max||100,maxSize:l,gradient:n.gradient});for(var i in v){var G=v[i];t.beginPath();for(var V=0;V<6;V++){var r1=l,y1=J1({x:G.x+s.x,y:G.y+s.y},r1,V);t.lineTo(y1[0],y1[1])}t.closePath();for(var v1=0,c=0;c<G.length;c++)v1+=G[c].count||1;G.count=v1,t.fillStyle=N.getColor(v1),t.fill(),n.strokeStyle&&n.lineWidth&&t.stroke()}if(n.label&&n.label.show!==!1){t.fillStyle=n.label.fillStyle||"white",n.label.font&&(t.font=n.label.font),n.label.shadowColor&&(t.shadowColor=n.label.shadowColor),n.label.shadowBlur&&(t.shadowBlur=n.label.shadowBlur);for(var i in v){var G=v[i],J=G.count;J<0?J=J.toFixed(2):J=~~J;var g1=t.measureText(J).width;t.fillText(J,G.x+s.x-g1/2,G.y+s.y+5)}}t.restore()}};function O1(e,t,r){var n=e.createShader(r);return e.shaderSource(n,t),e.compileShader(n),n}function x1(e,t,r){var n=O1(e,t,e.VERTEX_SHADER),a=O1(e,r,e.FRAGMENT_SHADER),i=e.createProgram();return e.attachShader(i,n),e.attachShader(i,a),e.linkProgram(i),e.useProgram(i),i}function b1(e){var t=document.createElement("canvas"),r=t.getContext("2d");return t.width=1,t.height=1,r.fillStyle=e,r.fillRect(0,0,1,1),r.getImageData(0,0,1,1).data}var X1=["attribute vec4 a_Position;","void main() {","gl_Position = a_Position;","gl_PointSize = 30.0;","}"].join(""),K1=["precision mediump float;","uniform vec4 u_FragColor;","void main() {","gl_FragColor = u_FragColor;","}"].join("");function j1(e,t,r){if(!!t){var n=x1(e,X1,K1);e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE),e.clear(e.COLOR_BUFFER_BIT);var a=e.canvas.width/2,i=e.canvas.height/2,o=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,o);var s=e.getAttribLocation(n,"a_Position");e.vertexAttribPointer(s,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(s);var l=e.getUniformLocation(n,"u_FragColor"),f=b1(r.strokeStyle||"red");e.uniform4f(l,f[0]/255,f[1]/255,f[2]/255,f[3]/255),e.lineWidth(r.lineWidth||1);for(var d=0,v=t.length;d<v;d++){for(var c=t[d].geometry._coordinates,y=[],g=0;g<c.length;g++){var w=c[g],x=(w[0]-a)/a,p=(i-w[1])/i;y.push(x,p)}var _=new Float32Array(y);e.bufferData(e.ARRAY_BUFFER,_,e.STATIC_DRAW),e.drawArrays(e.LINE_STRIP,0,c.length)}}}var T1={draw:j1},Q1=["attribute vec4 a_Position;","attribute float a_PointSize;","void main() {","gl_Position = a_Position;","gl_PointSize = a_PointSize;","}"].join(""),tt=["precision mediump float;","uniform vec4 u_FragColor;","void main() {","gl_FragColor = u_FragColor;","}"].join("");function et(e,t,r){if(!!t){var n=x1(e,Q1,tt),a=e.getAttribLocation(n,"a_Position"),i=e.getAttribLocation(n,"a_PointSize"),o=e.getUniformLocation(n,"u_FragColor");e.clear(e.COLOR_BUFFER_BIT);for(var s=e.canvas.width/2,l=e.canvas.height/2,f=[],d=0,v=0;v<t.length;v++){var c=t[v].geometry._coordinates,y=(c[0]-s)/s,g=(l-c[1])/l;y<-1||y>1||g<-1||g>1||(f.push(y,g),d++)}var w=new Float32Array(f),x=d,p=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,p),e.bufferData(e.ARRAY_BUFFER,w,e.STATIC_DRAW),e.vertexAttribPointer(a,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(a),e.vertexAttrib1f(i,r._size);var _=b1(r.fillStyle||"red");e.uniform4f(o,_[0]/255,_[1]/255,_[2]/255,_[3]/255),e.drawArrays(e.POINTS,0,x)}}var R1={draw:et};function c1(e,t,r){r=r||2;var n=t&&t.length,a=n?t[0]*r:e.length,i=F1(e,0,a,r,!0),o=[];if(!i)return o;var s,l,f,d,v,c,y;if(n&&(i=ot(e,t,i,r)),e.length>80*r){s=f=e[0],l=d=e[1];for(var g=r;g<a;g+=r)v=e[g],c=e[g+1],v<s&&(s=v),c<l&&(l=c),v>f&&(f=v),c>d&&(d=c);y=Math.max(f-s,d-l)}return s1(i,o,r,s,l,y),o}function F1(e,t,r,n,a){var i,o;if(a===L1(e,t,r,n)>0)for(i=t;i<r;i+=n)o=U1(i,e[i],e[i+1],o);else for(i=r-n;i>=t;i-=n)o=U1(i,e[i],e[i+1],o);return o&&Q(o,o.next)&&(u1(o),o=o.next),o}function o1(e,t){if(!e)return e;t||(t=e);var r=e,n;do if(n=!1,!r.steiner&&(Q(r,r.next)||Z(r.prev,r,r.next)===0)){if(u1(r),r=t=r.prev,r===r.next)return null;n=!0}else r=r.next;while(n||r!==t);return t}function s1(e,t,r,n,a,i,o){if(!!e){!o&&i&&ft(e,n,a,i);for(var s=e,l,f;e.prev!==e.next;){if(l=e.prev,f=e.next,i?rt(e,n,a,i):nt(e)){t.push(l.i/r),t.push(e.i/r),t.push(f.i/r),u1(e),e=f.next,s=f.next;continue}if(e=f,e===s){o?o===1?(e=at(e,t,r),s1(e,t,r,n,a,i,2)):o===2&&it(e,t,r,n,a,i):s1(o1(e),t,r,n,a,i,1);break}}}}function nt(e){var t=e.prev,r=e,n=e.next;if(Z(t,r,n)>=0)return!1;for(var a=e.next.next;a!==e.prev;){if(d1(t.x,t.y,r.x,r.y,n.x,n.y,a.x,a.y)&&Z(a.prev,a,a.next)>=0)return!1;a=a.next}return!0}function rt(e,t,r,n){var a=e.prev,i=e,o=e.next;if(Z(a,i,o)>=0)return!1;for(var s=a.x<i.x?a.x<o.x?a.x:o.x:i.x<o.x?i.x:o.x,l=a.y<i.y?a.y<o.y?a.y:o.y:i.y<o.y?i.y:o.y,f=a.x>i.x?a.x>o.x?a.x:o.x:i.x>o.x?i.x:o.x,d=a.y>i.y?a.y>o.y?a.y:o.y:i.y>o.y?i.y:o.y,v=C1(s,l,t,r,n),c=C1(f,d,t,r,n),y=e.nextZ;y&&y.z<=c;){if(y!==e.prev&&y!==e.next&&d1(a.x,a.y,i.x,i.y,o.x,o.y,y.x,y.y)&&Z(y.prev,y,y.next)>=0)return!1;y=y.nextZ}for(y=e.prevZ;y&&y.z>=v;){if(y!==e.prev&&y!==e.next&&d1(a.x,a.y,i.x,i.y,o.x,o.y,y.x,y.y)&&Z(y.prev,y,y.next)>=0)return!1;y=y.prevZ}return!0}function at(e,t,r){var n=e;do{var a=n.prev,i=n.next.next;!Q(a,i)&&B1(a,n,n.next,i)&&l1(a,i)&&l1(i,a)&&(t.push(a.i/r),t.push(n.i/r),t.push(i.i/r),u1(n),u1(n.next),n=e=i),n=n.next}while(n!==e);return n}function it(e,t,r,n,a,i){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&ct(o,s)){var l=D1(o,s);o=o1(o,o.next),l=o1(l,l.next),s1(o,t,r,n,a,i),s1(l,t,r,n,a,i);return}s=s.next}o=o.next}while(o!==e)}function ot(e,t,r,n){var a=[],i,o,s,l,f;for(i=0,o=t.length;i<o;i++)s=t[i]*n,l=i<o-1?t[i+1]*n:e.length,f=F1(e,s,l,n,!1),f===f.next&&(f.steiner=!0),a.push(ht(f));for(a.sort(st),i=0;i<a.length;i++)lt(a[i],r),r=o1(r,r.next);return r}function st(e,t){return e.x-t.x}function lt(e,t){if(t=ut(e,t),t){var r=D1(t,e);o1(r,r.next)}}function ut(e,t){var r=t,n=e.x,a=e.y,i=-1/0,o;do{if(a<=r.y&&a>=r.next.y){var s=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=n&&s>i){if(i=s,s===n){if(a===r.y)return r;if(a===r.next.y)return r.next}o=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!o)return null;if(n===i)return o.prev;var l=o,f=o.x,d=o.y,v=1/0,c;for(r=o.next;r!==l;)n>=r.x&&r.x>=f&&d1(a<d?n:i,a,f,d,a<d?i:n,a,r.x,r.y)&&(c=Math.abs(a-r.y)/(n-r.x),(c<v||c===v&&r.x>o.x)&&l1(r,e)&&(o=r,v=c)),r=r.next;return o}function ft(e,t,r,n){var a=e;do a.z===null&&(a.z=C1(a.x,a.y,t,r,n)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next;while(a!==e);a.prevZ.nextZ=null,a.prevZ=null,vt(a)}function vt(e){var t,r,n,a,i,o,s,l,f=1;do{for(r=e,e=null,i=null,o=0;r;){for(o++,n=r,s=0,t=0;t<f&&(s++,n=n.nextZ,!!n);t++);for(l=f;s>0||l>0&&n;)s===0?(a=n,n=n.nextZ,l--):l===0||!n||r.z<=n.z?(a=r,r=r.nextZ,s--):(a=n,n=n.nextZ,l--),i?i.nextZ=a:e=a,a.prevZ=i,i=a;r=n}i.nextZ=null,f*=2}while(o>1);return e}function C1(e,t,r,n,a){return e=32767*(e-r)/a,t=32767*(t-n)/a,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function ht(e){var t=e,r=e;do t.x<r.x&&(r=t),t=t.next;while(t!==e);return r}function d1(e,t,r,n,a,i,o,s){return(a-o)*(t-s)-(e-o)*(i-s)>=0&&(e-o)*(n-s)-(r-o)*(t-s)>=0&&(r-o)*(i-s)-(a-o)*(n-s)>=0}function ct(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!dt(e,t)&&l1(e,t)&&l1(t,e)&&pt(e,t)}function Z(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function Q(e,t){return e.x===t.x&&e.y===t.y}function B1(e,t,r,n){return Q(e,t)&&Q(r,n)||Q(e,n)&&Q(r,t)?!0:Z(e,t,r)>0!=Z(e,t,n)>0&&Z(r,n,e)>0!=Z(r,n,t)>0}function dt(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&B1(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function l1(e,t){return Z(e.prev,e,e.next)<0?Z(e,t,e.next)>=0&&Z(e,e.prev,t)>=0:Z(e,t,e.prev)<0||Z(e,e.next,t)<0}function pt(e,t){var r=e,n=!1,a=(e.x+t.x)/2,i=(e.y+t.y)/2;do r.y>i!=r.next.y>i&&a<(r.next.x-r.x)*(i-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next;while(r!==e);return n}function D1(e,t){var r=new M1(e.i,e.x,e.y),n=new M1(t.i,t.x,t.y),a=e.next,i=t.prev;return e.next=t,t.prev=e,r.next=a,a.prev=r,n.next=r,r.prev=n,i.next=n,n.prev=i,n}function U1(e,t,r,n){var a=new M1(e,t,r);return n?(a.next=n.next,a.prev=n,n.next.prev=a,n.next=a):(a.prev=a,a.next=a),a}function u1(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function M1(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}c1.deviation=function(e,t,r,n){var a=t&&t.length,i=a?t[0]*r:e.length,o=Math.abs(L1(e,0,i,r));if(a)for(var s=0,l=t.length;s<l;s++){var f=t[s]*r,d=s<l-1?t[s+1]*r:e.length;o-=Math.abs(L1(e,f,d,r))}var v=0;for(s=0;s<n.length;s+=3){var c=n[s]*r,y=n[s+1]*r,g=n[s+2]*r;v+=Math.abs((e[c]-e[g])*(e[y+1]-e[c+1])-(e[c]-e[y])*(e[g+1]-e[c+1]))}return o===0&&v===0?0:Math.abs((v-o)/o)};function L1(e,t,r,n){for(var a=0,i=t,o=r-n;i<r;i+=n)a+=(e[o]-e[i])*(e[i+1]+e[o+1]),o=i;return a}c1.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,a=0;a<e.length;a++){for(var i=0;i<e[a].length;i++)for(var o=0;o<t;o++)r.vertices.push(e[a][i][o]);a>0&&(n+=e[a-1].length,r.holes.push(n))}return r};var yt=["attribute vec4 a_Position;","void main() {","gl_Position = a_Position;","gl_PointSize = 30.0;","}"].join(""),gt=["precision mediump float;","uniform vec4 u_FragColor;","void main() {","gl_FragColor = u_FragColor;","}"].join("");function mt(e,t,r){if(!!t){e.clear(e.COLOR_BUFFER_BIT),e.viewport(0,0,e.canvas.width,e.canvas.height);var n=x1(e,yt,gt);e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE);var a=e.canvas.width/2,i=e.canvas.height/2;e.bindBuffer(e.ARRAY_BUFFER,e.createBuffer()),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,e.createBuffer());var o=e.getAttribLocation(n,"a_Position");e.vertexAttribPointer(o,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(o);var s=e.getUniformLocation(n,"u_FragColor"),l=b1(r.fillStyle||"red");e.uniform4f(s,l[0]/255,l[1]/255,l[2]/255,l[3]/255),e.lineWidth(r.lineWidth||1);for(var f=[],d=[],v=65536,c=0,y=0,g=t.length;y<g;y++){var w=c1.flatten(t[y].geometry._coordinates||t[y].geometry.coordinates),x=w.vertices;c=f.length/2;for(var p=0;p<x.length;p+=2)x[p]=(x[p]-a)/a,x[p+1]=(i-x[p+1])/i;(f.length+x.length)/2>v&&(e.bufferData(e.ARRAY_BUFFER,new Float32Array(f),e.STATIC_DRAW),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(d),e.STATIC_DRAW),e.drawElements(e.TRIANGLES,d.length,e.UNSIGNED_SHORT,0),f.length=0,d.length=0,c=0);for(var p=0;p<x.length;p++)f.push(x[p]);for(var _=c1(x,w.holes,w.dimensions),p=0;p<_.length;p++)d.push(_[p]+c)}e.bufferData(e.ARRAY_BUFFER,new Float32Array(f),e.STATIC_DRAW),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(d),e.STATIC_DRAW),e.drawElements(e.TRIANGLES,d.length,e.UNSIGNED_SHORT,0),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)}}var k1={draw:mt},Z1={draw:function(t,r,n){var a=r instanceof A?r.get():r;a.length>0&&(a[0].geometry.type=="LineString"?T1.draw(t,a,n):a[0].geometry.type=="Polygon"||a[0].geometry.type=="MultiPolygon"?k1.draw(t,a,n):R1.draw(t,a,n))}};function S1(e){var t=e.split("|");return t[0]=t[0].split(","),{lng:parseFloat(t[0][0]),lat:parseFloat(t[0][1])}}var wt={getCenterByCityName:function(t){for(var r=0;r<citycenter.municipalities.length;r++)if(citycenter.municipalities[r].n==t)return S1(citycenter.municipalities[r].g);for(var n=citycenter.provinces,r=0;r<n.length;r++){if(n[r].n==t)return S1(n[r].g);for(var a=n[r].cities,i=0;i<a.length;i++)if(a[i].n==t)return S1(a[i].g)}return null}};function _t(e){for(var t=[],r=0;r<e.length-1;r++){var n=xt(e[r],e[r+1]);n&&n.length>0&&(t=t.concat(n))}return t}function xt(e,t){if(!e||!t)return null;var r=function(R){return 1-2*R+R*R},n=function(R){return 2*R-2*R*R},a=function(R){return R*R},i=[],o=40,s=!1,l,f,d,v,c,y,g,w=[],x=0,p=0;if(typeof t>"u"){typeof i<"u"&&(i=[]);return}var _=parseFloat(e.lat),F=parseFloat(t.lat),z=parseFloat(e.lng),m=parseFloat(t.lng);for(m>z&&parseFloat(m-z)>180&&z<0&&(z=parseFloat(180+180+z)),z>m&&parseFloat(z-m)>180&&m<0&&(m=parseFloat(180+180+m)),y=0,g=0,F==_?(l=0,f=z-m):m==z?(l=Math.PI/2,f=_-F):(l=Math.atan((F-_)/(m-z)),f=(F-_)/Math.sin(l)),g==0&&(g=l+Math.PI/5),d=f/2,c=d*Math.cos(g)+z,v=d*Math.sin(g)+_,x=0;x<o+1;x++)i.push([z*r(p)+c*n(p)+m*a(p),_*r(p)+v*n(p)+F*a(p)]),p=p+1/o;return i}var bt={getPoints:_t},Ct=function(){var t={},r=[],n=[],a=[],i=.1,o=.1,s=1,l=2,f=6,d=70,v=.6666667,c=.6,y=!1,g=1e-8;function w(u,h){return u.x*h.x+u.y*h.y}function x(u){return{x:t[u.target].x-t[u.source].x,y:t[u.target].y-t[u.source].y}}function p(u){return Math.sqrt(Math.pow(t[u.source].x-t[u.target].x,2)+Math.pow(t[u.source].y-t[u.target].y,2))}function _(u){return Math.sqrt(Math.pow(u.source.x-u.target.x,2)+Math.pow(u.source.y-u.target.y,2))}function F(u){var h=(t[u.source].x+t[u.target].x)/2,b=(t[u.source].y+t[u.target].y)/2;return{x:h,y:b}}function z(u){for(var h=0,b=1;b<a[u].length;b++){var L=m(a[u][b],a[u][b-1]);h+=L}return h}function m(u,h){return Math.sqrt(Math.pow(u.x-h.x,2)+Math.pow(u.y-h.y,2))}function C(u,h){var b=Math.sqrt((h.target.x-h.source.x)*(h.target.x-h.source.x)+(h.target.y-h.source.y)*(h.target.y-h.source.y)),L=((h.source.y-u.y)*(h.source.y-h.target.y)-(h.source.x-u.x)*(h.target.x-h.source.x))/(b*b);return{x:h.source.x+L*(h.target.x-h.source.x),y:h.source.y+L*(h.target.y-h.source.y)}}function R(){for(var u=0;u<r.length;u++)s==1?a[u]=[]:(a[u]=[],a[u].push(t[r[u].source]),a[u].push(t[r[u].target]))}function Y(){for(var u=0;u<r.length;u++)n[u]=[]}function q(u){for(var h=[],b=0;b<u.length;b++)t[u[b].source].x!=t[u[b].target].x&&t[u[b].source].y!=t[u[b].target].y&&h.push(u[b]);return h}function N(u,h,b){var L=a[u][h-1],O=a[u][h+1],E=a[u][h],S=L.x-E.x+O.x-E.x,D=L.y-E.y+O.y-E.y;return S*=b,D*=b,{x:S,y:D}}function G(u,h,b){for(var L={x:0,y:0},O=n[u],E=0;E<O.length;E++){var S={x:a[O[E]][h].x-a[u][h].x,y:a[O[E]][h].y-a[u][h].y};if(Math.abs(S.x)>g||Math.abs(S.y)>g){var D=1/Math.pow(_({source:a[O[E]][h],target:a[u][h]}),1);L.x+=S.x*D,L.y+=S.y*D}}return L}function V(u,h,b){for(var L=i/(p(r[u])*(h+1)),O=[{x:0,y:0}],E=1;E<h+1;E++){var S={x:0,y:0},D=N(u,E,L),$=G(u,E,b);S.x=b*(D.x+$.x),S.y=b*(D.y+$.y),O.push(S)}return O.push({x:0,y:0}),O}function r1(u){for(var h=0;h<r.length;h++)if(u==1)a[h].push(t[r[h].source]),a[h].push(F(r[h])),a[h].push(t[r[h].target]);else{var b=z(h),L=b/(u+1),O=L,E=[];E.push(t[r[h].source]);for(var S=1;S<a[h].length;S++){for(var D=m(a[h][S],a[h][S-1]);D>O;){var $=O/D,X=a[h][S-1].x,W1=a[h][S-1].y;X+=$*(a[h][S].x-a[h][S-1].x),W1+=$*(a[h][S].y-a[h][S-1].y),E.push({x:X,y:W1}),D-=O,O=L}O-=D}E.push(t[r[h].target]),a[h]=E}}function y1(u,h){var b=Math.abs(w(x(u),x(h))/(p(u)*p(h)));return b}function v1(u,h){var b=(p(u)+p(h))/2,L=2/(b/Math.min(p(u),p(h))+Math.max(p(u),p(h))/b);return L}function J(u,h){var b=(p(u)+p(h))/2,L={x:(t[u.source].x+t[u.target].x)/2,y:(t[u.source].y+t[u.target].y)/2},O={x:(t[h.source].x+t[h.target].x)/2,y:(t[h.source].y+t[h.target].y)/2},E=b/(b+m(L,O));return E}function g1(u,h){var b=C(t[h.source],{source:t[u.source],target:t[u.target]}),L=C(t[h.target],{source:t[u.source],target:t[u.target]}),O={x:(b.x+L.x)/2,y:(b.y+L.y)/2},E={x:(t[u.source].x+t[u.target].x)/2,y:(t[u.source].y+t[u.target].y)/2},S=Math.max(0,1-2*m(E,O)/m(b,L));return S}function Rt(u,h){return Math.min(g1(u,h),g1(h,u))}function Ft(u,h){var b=y1(u,h)*v1(u,h)*J(u,h)*Rt(u,h);return b}function Bt(u,h){return Ft(u,h)>=c}function Dt(){for(var u=0;u<r.length-1;u++)for(var h=u+1;h<r.length;h++)u!=h&&Bt(r[u],r[h])&&(n[u].push(h),n[h].push(u))}var B=function(){var h=o,b=d,L=s;R(),Y(),r1(L),Dt();for(var O=0;O<f;O++){for(var E=0;E<b;E++){for(var S=[],D=0;D<r.length;D++)S[D]=V(D,L,h);for(var $=0;$<r.length;$++)for(var X=0;X<L+1;X++)a[$][X].x+=S[$][X].x,a[$][X].y+=S[$][X].y}h=h/2,L=L*2,b=v*b,r1(L)}return a};return B.nodes=function(u){return arguments.length==0?t:(t=u,B)},B.edges=function(u){return arguments.length==0?r:(r=q(u),B)},B.bundling_stiffness=function(u){return arguments.length==0?i:(i=u,B)},B.step_size=function(u){return arguments.length==0?o:(o=u,B)},B.cycles=function(u){return arguments.length==0?f:(f=u,B)},B.iterations=function(u){return arguments.length==0?d:(d=u,B)},B.iterations_rate=function(u){return arguments.length==0?v:(v=u,B)},B.subdivision_points_seed=function(u){return arguments.length==0?P:(P=u,B)},B.subdivision_rate=function(u){return arguments.length==0?l:(l=u,B)},B.compatbility_threshold=function(u){return arguments.length==0?compatbility_threshold:(c=u,B)},B};function p1(e){this.splitList=e||{other:1}}p1.prototype.get=function(e){var t=this.splitList,r=t.other;for(var n in t)if(e==n){r=t[n];break}return r},p1.prototype.generateByDataSet=function(e){var t=["rgba(255, 255, 0, 0.8)","rgba(253, 98, 104, 0.8)","rgba(255, 146, 149, 0.8)","rgba(255, 241, 193, 0.8)","rgba(110, 176, 253, 0.8)","rgba(52, 139, 251, 0.8)","rgba(17, 102, 252, 0.8)"],r=e.get();this.splitList={};for(var n=0,a=0;a<r.length&&(this.splitList[r[a].count]===void 0&&(this.splitList[r[a].count]=t[n],n++),!(n>=t.length-1));a++);this.splitList.other=t[t.length-1]};function f1(e){this.splitList=e||[{start:0,value:"red"}]}f1.prototype.get=function(e){for(var t=this.splitList,r=!1,n=0;n<t.length;n++)if((t[n].start===void 0||t[n].start!==void 0&&e>=t[n].start)&&(t[n].end===void 0||t[n].end!==void 0&&e<t[n].end)){r=t[n].value;break}return r},f1.prototype.generateByDataSet=function(e){var t=e.getMin("count"),r=e.getMax("count");this.generateByMinMax(t,r)},f1.prototype.generateByMinMax=function(e,t){var r=["rgba(255, 255, 0, 0.8)","rgba(253, 98, 104, 0.8)","rgba(255, 146, 149, 0.8)","rgba(255, 241, 193, 0.8)","rgba(110, 176, 253, 0.8)","rgba(52, 139, 251, 0.8)","rgba(17, 102, 252, 0.8)"],n=(t-e)/7,a=e;this.splitList=[];for(var i=0;a<t;)this.splitList.push({start:a,end:a+n,value:r[i]}),i++,a+=n};var Mt=function(){function e(t,r,n){if(j(this,e),!t||!r)return console.warn("id 和 type 为必填项"),!1;if(r=="baidu"){if(!BMap)return console.warn("请先引入百度地图JS API"),!1}else console.warn("暂不支持你的地图类型");this.type=r;var a=n&&n.center?n.center:[106.962497,38.208726],i=n&&n.zoom?n.zoom:5,o=this.map=new BMap.Map(t,{enableMapClick:!1});o.centerAndZoom(new BMap.Point(a[0],a[1]),i),o.enableScrollWheelZoom(!0),o.setMapStyle({style:"light"})}return e1(e,[{key:"addLayer",value:function(r,n){if(this.type=="baidu")return new mapv.baiduMapLayer(this.map,dataSet,n)}},{key:"getMap",value:function(){return this.map}}]),e}();function W(e){this.options=e||{},this.paneName=this.options.paneName||"mapPane",this.context=this.options.context||"2d",this.zIndex=this.options.zIndex||0,this.mixBlendMode=this.options.mixBlendMode||null,this.enableMassClear=this.options.enableMassClear,this._map=e.map,this._lastDrawTime=null,this.show()}var H1=typeof window>"u"?{}:window;H1.BMap&&(W.prototype=new BMap.Overlay,W.prototype.initialize=function(e){this._map=e;var t=this.canvas=document.createElement("canvas");t.style.cssText="position:absolute;left:0;top:0;z-index:"+this.zIndex+";user-select:none;",t.style.mixBlendMode=this.mixBlendMode,this.adjustSize(),e.getPanes()[this.paneName].appendChild(t);var r=this;return e.addEventListener("resize",function(){r.adjustSize(),r._draw()}),this.canvas},W.prototype.adjustSize=function(){var e=this._map.getSize(),t=this.canvas,r=this.devicePixelRatio=H1.devicePixelRatio;t.width=e.width*r,t.height=e.height*r,this.context=="2d"&&t.getContext(this.context).scale(r,r),t.style.width=e.width+"px",t.style.height=e.height+"px"},W.prototype.draw=function(){var e=this;clearTimeout(e.timeoutID),e.timeoutID=setTimeout(function(){e._draw()},15)},W.prototype._draw=function(){var e=this._map,t=e.getSize(),r=e.getCenter();if(r){var n=e.pointToOverlayPixel(r);this.canvas.style.left=n.x-t.width/2+"px",this.canvas.style.top=n.y-t.height/2+"px",this.dispatchEvent("draw"),this.options.update&&this.options.update.call(this)}},W.prototype.getContainer=function(){return this.canvas},W.prototype.show=function(){this.canvas||this._map.addOverlay(this),this.canvas.style.display="block"},W.prototype.hide=function(){this.canvas.style.display="none"},W.prototype.setZIndex=function(e){this.canvas.style.zIndex=e},W.prototype.getZIndex=function(){return this.zIndex});var T=T||function(){var e=[];return{getAll:function(){return e},removeAll:function(){e=[]},add:function(r){e.push(r)},remove:function(r){var n=e.indexOf(r);n!==-1&&e.splice(n,1)},update:function(r,n){if(e.length===0)return!1;var a=0;for(r=r!==void 0?r:T.now();a<e.length;)e[a].update(r)||n?a++:e.splice(a,1);return!0}}}();typeof window>"u"&&typeof process<"u"?T.now=function(){var e=process.hrtime();return e[0]*1e3+e[1]/1e6}:typeof window<"u"&&window.performance!==void 0&&window.performance.now!==void 0?T.now=window.performance.now.bind(window.performance):Date.now!==void 0?T.now=Date.now:T.now=function(){return new Date().getTime()},T.Tween=function(e){var t=e,r={},n={},a={},i=1e3,o=0,s,l=!1,f=!1,d=!1,v=0,c=null,y=T.Easing.Linear.None,g=T.Interpolation.Linear,w=[],x=null,p=!1,_=null,F=null,z=null;this.to=function(m,C){return n=m,C!==void 0&&(i=C),this},this.start=function(m){T.add(this),f=!0,p=!1,c=m!==void 0?m:T.now(),c+=v;for(var C in n){if(n[C]instanceof Array){if(n[C].length===0)continue;n[C]=[t[C]].concat(n[C])}t[C]!==void 0&&(r[C]=t[C],r[C]instanceof Array||(r[C]*=1),a[C]=r[C]||0)}return this},this.stop=function(){return f?(T.remove(this),f=!1,z!==null&&z.call(t,t),this.stopChainedTweens(),this):this},this.end=function(){return this.update(c+i),this},this.stopChainedTweens=function(){for(var m=0,C=w.length;m<C;m++)w[m].stop()},this.delay=function(m){return v=m,this},this.repeat=function(m){return o=m,this},this.repeatDelay=function(m){return s=m,this},this.yoyo=function(m){return l=m,this},this.easing=function(m){return y=m,this},this.interpolation=function(m){return g=m,this},this.chain=function(){return w=arguments,this},this.onStart=function(m){return x=m,this},this.onUpdate=function(m){return _=m,this},this.onComplete=function(m){return F=m,this},this.onStop=function(m){return z=m,this},this.update=function(m){var C,R,Y;if(m<c)return!0;p===!1&&(x!==null&&x.call(t,t),p=!0),R=(m-c)/i,R=R>1?1:R,Y=y(R);for(C in n)if(r[C]!==void 0){var q=r[C]||0,N=n[C];N instanceof Array?t[C]=g(N,Y):(typeof N=="string"&&(N.charAt(0)==="+"||N.charAt(0)==="-"?N=q+parseFloat(N):N=parseFloat(N)),typeof N=="number"&&(t[C]=q+(N-q)*Y))}if(_!==null&&_.call(t,Y),R===1)if(o>0){isFinite(o)&&o--;for(C in a){if(typeof n[C]=="string"&&(a[C]=a[C]+parseFloat(n[C])),l){var G=a[C];a[C]=n[C],n[C]=G}r[C]=a[C]}return l&&(d=!d),s!==void 0?c=m+s:c=m+v,!0}else{F!==null&&F.call(t,t);for(var V=0,r1=w.length;V<r1;V++)w[V].start(c+i);return!1}return!0}},T.Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return .5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return t===0?0:Math.pow(1024,t-1)},Out:function(t){return t===1?1:1-Math.pow(2,-10*t)},InOut:function(t){return t===0?0:t===1?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(-Math.pow(2,-10*(t-1))+2)}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return t===0?0:t===1?1:-Math.pow(2,10*(t-1))*Math.sin((t-1.1)*5*Math.PI)},Out:function(t){return t===0?0:t===1?1:Math.pow(2,-10*t)*Math.sin((t-.1)*5*Math.PI)+1},InOut:function(t){return t===0?0:t===1?1:(t*=2,t<1?-.5*Math.pow(2,10*(t-1))*Math.sin((t-1.1)*5*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin((t-1.1)*5*Math.PI)+1)}},Back:{In:function(t){var r=1.70158;return t*t*((r+1)*t-r)},Out:function(t){var r=1.70158;return--t*t*((r+1)*t+r)+1},InOut:function(t){var r=2.5949095;return(t*=2)<1?.5*(t*t*((r+1)*t-r)):.5*((t-=2)*t*((r+1)*t+r)+2)}},Bounce:{In:function(t){return 1-T.Easing.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?T.Easing.Bounce.In(t*2)*.5:T.Easing.Bounce.Out(t*2-1)*.5+.5}}},T.Interpolation={Linear:function(t,r){var n=t.length-1,a=n*r,i=Math.floor(a),o=T.Interpolation.Utils.Linear;return r<0?o(t[0],t[1],a):r>1?o(t[n],t[n-1],n-a):o(t[i],t[i+1>n?n:i+1],a-i)},Bezier:function(t,r){for(var n=0,a=t.length-1,i=Math.pow,o=T.Interpolation.Utils.Bernstein,s=0;s<=a;s++)n+=i(1-r,a-s)*i(r,s)*t[s]*o(a,s);return n},CatmullRom:function(t,r){var n=t.length-1,a=n*r,i=Math.floor(a),o=T.Interpolation.Utils.CatmullRom;return t[0]===t[n]?(r<0&&(i=Math.floor(a=n*(1+r))),o(t[(i-1+n)%n],t[i],t[(i+1)%n],t[(i+2)%n],a-i)):r<0?t[0]-(o(t[0],t[0],t[1],t[1],-a)-t[0]):r>1?t[n]-(o(t[n],t[n],t[n-1],t[n-1],a-n)-t[n]):o(t[i?i-1:0],t[i],t[n<i+1?n:i+1],t[n<i+2?n:i+2],a-i)},Utils:{Linear:function(t,r,n){return(r-t)*n+t},Bernstein:function(t,r){var n=T.Interpolation.Utils.Factorial;return n(t)/n(r)/n(t-r)},Factorial:function(){var e=[1];return function(t){var r=1;if(e[t])return e[t];for(var n=t;n>1;n--)r*=n;return e[t]=r,r}}(),CatmullRom:function(t,r,n,a,i){var o=(n-t)*.5,s=(a-r)*.5,l=i*i,f=i*l;return(2*r-2*n+o+s)*f+(-3*r+3*n-2*o-s)*l+o*i+r}}};var Lt={draw:function(t,r,n){var a=r instanceof A?r.get():r;t.save();for(var i in n)t[i]=n[i];var o=n.offset||{x:0,y:0},s=[],l=n._size||n.size;l?t.font="bold "+l+"px Arial":l=12;var f=n.textKey||"text";if(t.textAlign="center",t.textBaseline="middle",n.avoid)for(var d=0,v=a.length;d<v;d++){var c=a[d].geometry._coordinates||a[d].geometry.coordinates,y=c[0]+o.x,g=c[1]+o.y,w=a[d][f],x=t.measureText(w).width,p=y-x/2,_=g-l/2,F={sw:{x:p,y:_+l},ne:{x:p+x,y:_}};St(s,F)||(s.push(F),p=p+x/2,_=_+l/2,t.fillText(w,p,_))}else for(var d=0,v=a.length;d<v;d++){var c=a[d].geometry._coordinates||a[d].geometry.coordinates,y=c[0]+o.x,g=c[1]+o.y,w=a[d][f];t.fillText(w,y,g)}t.restore()}};function St(e,t){for(var r=0;r<e.length;r++)if(At(e[r],t))return!0;return!1}function At(e,t){var r=Math.min(e.ne.x,t.ne.x),n=Math.min(e.sw.y,t.sw.y),a=Math.max(e.sw.x,t.sw.x),i=Math.max(e.ne.y,t.ne.y);return r>a&&n>i}var Et={draw:function(t,r,n){var a=r instanceof A?r.get():r;t.fillStyle="white",t.textAlign="center",t.textBaseline="middle";for(var i=n.offset||{x:0,y:0},o=0,s=a.length;o<s;o++)if(a[o].geometry){var l=a[o].deg||n.deg,f=a[o].icon||n.icon,d=a[o].geometry._coordinates||a[o].geometry.coordinates,v=d[0],c=d[1];l&&(t.save(),t.translate(v,c),t.rotate(l*Math.PI/180),t.translate(-v,-c));var y=n._width||n.width||f.width,g=n._height||n.height||f.height;v=v-y/2+i.x,c=c-g/2+i.y,n.sx&&n.sy&&n.swidth&&n.sheight&&n.width&&n.height?t.drawImage(f,n.sx,n.sy,n.swidth,n.sheight,v,c,y,g):n.width&&n.height?t.drawImage(f,v,c,y,g):t.drawImage(f,v,c),l&&t.restore()}}};typeof window<"u"&&requestAnimationFrame(N1);function N1(e){requestAnimationFrame(N1),T.update(e)}var A1=function(){function e(t,r,n){j(this,e),r instanceof A||(r=new A(r)),this.dataSet=r,this.map=t}return e1(e,[{key:"getDefaultContextConfig",value:function(){return{globalAlpha:1,globalCompositeOperation:"source-over",imageSmoothingEnabled:!0,strokeStyle:"#000000",fillStyle:"#000000",shadowOffsetX:0,shadowOffsetY:0,shadowBlur:0,shadowColor:"rgba(0, 0, 0, 0)",lineWidth:1,lineCap:"butt",lineJoin:"miter",miterLimit:10,lineDashOffset:0,font:"10px sans-serif",textAlign:"start",textBaseline:"alphabetic"}}},{key:"initDataRange",value:function(r){var n=this;if(n.intensity=new k({maxSize:n.options.maxSize,minSize:n.options.minSize,gradient:n.options.gradient,max:n.options.max||this.dataSet.getMax("count")}),n.category=new p1(n.options.splitList),n.choropleth=new f1(n.options.splitList),n.options.splitList===void 0&&n.category.generateByDataSet(this.dataSet),n.options.splitList===void 0){var a=n.options.min||this.dataSet.getMin("count"),i=n.options.max||this.dataSet.getMax("count");n.choropleth.generateByMinMax(a,i)}}},{key:"getLegend",value:function(r){var n=this.options.draw,a=null;if(self.options.draw=="intensity"||self.options.draw=="heatmap")return this.intensity.getLegend(r)}},{key:"processData",value:function(r){var n=this,a=n.options.draw;if(a=="bubble"||a=="intensity"||a=="category"||a=="choropleth"||a=="simple")for(var i=0;i<r.length;i++){var o=r[i];n.options.draw=="bubble"?r[i]._size=n.intensity.getSize(o.count):r[i]._size=void 0;var s="fillStyle";(r[i].geometry.type==="LineString"||n.options.styleType==="stroke")&&(s="strokeStyle"),n.options.draw=="intensity"?r[i][s]=n.intensity.getColor(o.count):n.options.draw=="category"?r[i][s]=n.category.get(o.count):n.options.draw=="choropleth"&&(r[i][s]=n.choropleth.get(o.count))}}},{key:"isEnabledTime",value:function(){var r=this.options.animation,n=r&&r.enabled!==!1;return n}},{key:"argCheck",value:function(r){r.draw=="heatmap"&&r.strokeStyle&&console.warn("[heatmap] options.strokeStyle is discard, pleause use options.strength [eg: options.strength = 0.1]")}},{key:"drawContext",value:function(r,n,a,i){var o=this;switch(o.options.draw){case"heatmap":P1.draw(r,n,o.options);break;case"grid":case"honeycomb":o.options.offset={x:i.x,y:i.y},o.options.draw=="grid"?I1.draw(r,n,o.options):z1.draw(r,n,o.options);break;case"text":Lt.draw(r,n,o.options);break;case"icon":Et.draw(r,n,o.options);break;case"clip":r.save(),r.fillStyle=o.options.fillStyle||"rgba(0, 0, 0, 0.5)",r.fillRect(0,0,r.canvas.width,r.canvas.height),_1.draw(r,n,o.options),r.beginPath(),i1.drawDataSet(r,n,o.options),r.clip(),U(r),r.restore();break;default:o.options.context=="webgl"?Z1.draw(o.canvasLayer.canvas.getContext("webgl"),n,o.options):_1.draw(r,n,o.options)}}},{key:"isPointInPath",value:function(a,n){for(var a=this.canvasLayer.canvas.getContext(this.context),i=this.dataSet.get(),o=0;o<i.length;o++)if(a.beginPath(),i1.draw(a,i[o],this.options),a.isPointInPath(n.x*this.canvasLayer.devicePixelRatio,n.y*this.canvasLayer.devicePixelRatio))return i[o]}},{key:"clickEvent",value:function(r,n){var a=this.isPointInPath(this.getContext(),r);a?this.options.methods.click(a,n):this.options.methods.click(null,n)}},{key:"mousemoveEvent",value:function(r,n){var a=this.isPointInPath(this.getContext(),r);a?this.options.methods.mousemove(a,n):this.options.methods.mousemove(null,n)}},{key:"update",value:function(r,n){var a=this,i=r.options,o=a.options;for(var s in i)o[s]=i[s];a.init(o),n!==!1&&a.draw()}},{key:"setOptions",value:function(r){var n=this;n.init(r),n.draw()}},{key:"set",value:function(r){var n=this,a=this.getContext(),i=this.getDefaultContextConfig();for(var o in i)a[o]=i[o];n.init(r.options),n.draw()}},{key:"destroy",value:function(){this.unbindEvent(),this.hide()}},{key:"initAnimator",value:function(){var r=this,n=r.options.animation;if(r.options.draw=="time"||r.isEnabledTime()){n.stepsRange||(n.stepsRange={start:this.dataSet.getMin("time")||0,end:this.dataSet.getMax("time")||0}),this.steps={step:n.stepsRange.start},r.animator=new T.Tween(this.steps).onUpdate(function(){r._canvasUpdate(this.step)}).repeat(1/0),this.addAnimatorEvent();var a=n.duration*1e3||5e3;r.animator.to({step:n.stepsRange.end},a),r.animator.start()}else r.animator&&r.animator.stop()}},{key:"addAnimatorEvent",value:function(){}},{key:"animatorMovestartEvent",value:function(){var r=this.options.animation;this.isEnabledTime()&&this.animator&&(this.steps.step=r.stepsRange.start,this.animator.stop())}},{key:"animatorMoveendEvent",value:function(){this.isEnabledTime()&&this.animator&&this.animator.start()}}]),e}(),Pt=function(e){m1(t,e);function t(r,n,a){j(this,t);var i=w1(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r,n,a));i.map=r,i.options=a||{},i.dataSet=n,i.init(a);var o=new W({map:r,update:i._canvasUpdate.bind(i)});i.transferToMercator();var s=i;return n.on("change",function(){s.transferToMercator(),o.draw()}),i.ctx=o.canvas.getContext("2d"),i.start(),i}return e1(t,[{key:"init",value:function(n){var a=this;a.options=n,this.initDataRange(n),this.context=a.options.context||"2d",a.options.zIndex&&this.canvasLayer&&this.canvasLayer.setZIndex(a.options.zIndex),a.options.max&&this.intensity.setMax(a.options.max),a.options.min&&this.intensity.setMin(a.options.min),this.initAnimator()}},{key:"transferToMercator",value:function(){var n=this.map.getMapType().getProjection();if(this.options.coordType!=="bd09mc"){var a=this.dataSet.get();a=this.dataSet.transferCoordinate(a,function(i){var o=n.lngLatToPoint({lng:i[0],lat:i[1]});return[o.x,o.y]},"coordinates","coordinates_mercator"),this.dataSet._set(a)}}},{key:"_canvasUpdate",value:function(){var n=this.ctx;if(!!n){var a=this.map,i=Math.pow(2,18-a.getZoom()),o=a.getMapType().getProjection(),s=o.lngLatToPoint(a.getCenter()),l=new BMap.Pixel(s.x-a.getSize().width/2*i,s.y+a.getSize().height/2*i);U(n);var f={fromColumn:this.options.coordType=="bd09mc"?"coordinates":"coordinates_mercator",transferCoordinate:function(v){if(!!v){var c=(v[0]-l.x)/i,y=(l.y-v[1])/i;return[c,y]}}};this.data=this.dataSet.get(f),this.processData(this.data),this.drawAnimation()}}},{key:"drawAnimation",value:function(){var n=this.ctx,a=this.data;if(!!a){n.save(),n.globalCompositeOperation="destination-out",n.fillStyle="rgba(0, 0, 0, .1)",n.fillRect(0,0,n.canvas.width,n.canvas.height),n.restore(),n.save(),this.options.shadowColor&&(n.shadowColor=this.options.shadowColor),this.options.shadowBlur&&(n.shadowBlur=this.options.shadowBlur),this.options.globalAlpha&&(n.globalAlpha=this.options.globalAlpha),this.options.globalCompositeOperation&&(n.globalCompositeOperation=this.options.globalCompositeOperation);for(var i=this.options,o=0;o<a.length;o++)if(a[o].geometry.type==="Point"){n.beginPath();var s=a[o].size||this.options.size,l=a[o].minSize||this.options.minSize||0;a[o]._size===void 0&&(a[o]._size=l),n.arc(a[o].geometry._coordinates[0],a[o].geometry._coordinates[1],a[o]._size,0,Math.PI*2,!0),n.closePath(),a[o]._size++,a[o]._size>s&&(a[o]._size=l),n.lineWidth=1,n.strokeStyle=a[o].strokeStyle||i.strokeStyle||"yellow",n.stroke();var f=a[o].fillStyle||i.fillStyle;f&&(n.fillStyle=f,n.fill())}else if(a[o].geometry.type==="LineString"){n.beginPath();var d=a[o].size||this.options.size||5,l=a[o].minSize||this.options.minSize||0;a[o]._index===void 0&&(a[o]._index=0);var v=a[o]._index;n.arc(a[o].geometry._coordinates[v][0],a[o].geometry._coordinates[v][1],d,0,Math.PI*2,!0),n.closePath(),a[o]._index++,a[o]._index>=a[o].geometry._coordinates.length&&(a[o]._index=0),n.lineWidth=i.lineWidth||1;var c=a[o].strokeStyle||i.strokeStyle,f=a[o].fillStyle||i.fillStyle||"yellow";n.fillStyle=f,n.fill(),c&&(n.strokeStyle=c,n.stroke())}n.restore()}}},{key:"animate",value:function(){this.drawAnimation();var n=this.options.animateTime||100;this.timeout=setTimeout(this.animate.bind(this),n)}},{key:"start",value:function(){this.stop(),this.animate()}},{key:"stop",value:function(){clearTimeout(this.timeout)}}]),t}(A1),It=function(e){m1(t,e);function t(r,n,a){j(this,t);var i=w1(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r,n,a)),o=i,s=null;a=a||{},o.init(a),o.argCheck(a),o.transferToMercator();var l=i.canvasLayer=new W({map:r,context:i.context,paneName:a.paneName,mixBlendMode:a.mixBlendMode,enableMassClear:a.enableMassClear,zIndex:a.zIndex,update:function(){o._canvasUpdate()}});return n.on("change",function(){o.transferToMercator(),l.draw()}),i.clickEvent=i.clickEvent.bind(i),i.mousemoveEvent=i.mousemoveEvent.bind(i),i.bindEvent(),i}return e1(t,[{key:"clickEvent",value:function(n){var a=n.pixel;n1(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"clickEvent",this).call(this,a,n)}},{key:"mousemoveEvent",value:function(n){var a=n.pixel;n1(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"mousemoveEvent",this).call(this,a,n)}},{key:"bindEvent",value:function(n){var a=this.map;this.options.methods&&(this.options.methods.click&&(a.setDefaultCursor("default"),a.addEventListener("click",this.clickEvent)),this.options.methods.mousemove&&a.addEventListener("mousemove",this.mousemoveEvent))}},{key:"unbindEvent",value:function(n){var a=this.map;this.options.methods&&(this.options.methods.click&&a.removeEventListener("click",this.clickEvent),this.options.methods.mousemove&&a.removeEventListener("mousemove",this.mousemoveEvent))}},{key:"transferToMercator",value:function(){var n=this.map.getMapType().getProjection();if(this.options.coordType!=="bd09mc"){var a=this.dataSet.get();a=this.dataSet.transferCoordinate(a,function(i){var o=n.lngLatToPoint({lng:i[0],lat:i[1]});return[o.x,o.y]},"coordinates","coordinates_mercator"),this.dataSet._set(a)}}},{key:"getContext",value:function(){return this.canvasLayer.canvas.getContext(this.context)}},{key:"_canvasUpdate",value:function(n){if(!!this.canvasLayer){var a=this,i=a.options.animation,o=this.canvasLayer._map,s=Math.pow(2,18-o.getZoom()),l=o.getMapType().getProjection(),f=l.lngLatToPoint(o.getCenter()),d=new BMap.Pixel(f.x-o.getSize().width/2*s,f.y+o.getSize().height/2*s),v=this.getContext();if(a.isEnabledTime()){if(n===void 0){U(v);return}this.context=="2d"&&(v.save(),v.globalCompositeOperation="destination-out",v.fillStyle="rgba(0, 0, 0, .1)",v.fillRect(0,0,v.canvas.width,v.canvas.height),v.restore())}else U(v);if(this.context=="2d")for(var c in a.options)v[c]=a.options[c];else v.clear(v.COLOR_BUFFER_BIT);if(!(a.options.minZoom&&o.getZoom()<a.options.minZoom||a.options.maxZoom&&o.getZoom()>a.options.maxZoom)){var y=1;this.context!="2d"&&(y=this.canvasLayer.devicePixelRatio);var g={fromColumn:a.options.coordType=="bd09mc"?"coordinates":"coordinates_mercator",transferCoordinate:function(_){var F=(_[0]-d.x)/s*y,z=(d.y-_[1])/s*y;return[F,z]}};n!==void 0&&(g.filter=function(p){var _=i.trails||10;return!!(n&&p.time>n-_&&p.time<n)});var w=a.dataSet.get(g);this.processData(w);var x=o.pointToPixel(new BMap.Point(0,0));a.options.unit=="m"?(a.options.size&&(a.options._size=a.options.size/s),a.options.width&&(a.options._width=a.options.width/s),a.options.height&&(a.options._height=a.options.height/s)):(a.options._size=a.options.size,a.options._height=a.options.height,a.options._width=a.options.width),this.drawContext(v,w,a.options,x),a.options.updateCallback&&a.options.updateCallback(n)}}}},{key:"init",value:function(n){var a=this;a.options=n,this.initDataRange(n),this.context=a.options.context||"2d",a.options.zIndex&&this.canvasLayer&&this.canvasLayer.setZIndex(a.options.zIndex),a.options.max&&this.intensity.setMax(a.options.max),a.options.min&&this.intensity.setMin(a.options.min),this.initAnimator()}},{key:"addAnimatorEvent",value:function(){this.map.addEventListener("movestart",this.animatorMovestartEvent.bind(this)),this.map.addEventListener("moveend",this.animatorMoveendEvent.bind(this))}},{key:"show",value:function(){this.map.addOverlay(this.canvasLayer)}},{key:"hide",value:function(){this.map.removeOverlay(this.canvasLayer)}},{key:"draw",value:function(){this.canvasLayer.draw()}}]),t}(A1);function I(e){this.isAdded_=!1,this.isAnimated_=!1,this.paneName_=I.DEFAULT_PANE_NAME_,this.updateHandler_=null,this.resizeHandler_=null,this.topLeft_=null,this.centerListener_=null,this.resizeListener_=null,this.needsResize_=!0,this.requestAnimationFrameId_=null;var t=document.createElement("canvas");t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.pointerEvents="none",this.canvas=t,this.canvasCssWidth_=300,this.canvasCssHeight_=150,this.resolutionScale_=1;function r(n,a){return function(){a.apply(n)}}this.repositionFunction_=r(this,this.repositionCanvas_),this.resizeFunction_=r(this,this.resize_),this.requestUpdateFunction_=r(this,this.update_),e&&this.setOptions(e)}var H=typeof window>"u"?{}:window;H.google&&H.google.maps&&(I.prototype=new google.maps.OverlayView,I.DEFAULT_PANE_NAME_="overlayLayer",I.CSS_TRANSFORM_=function(){for(var e=document.createElement("div"),t=["transform","WebkitTransform","MozTransform","OTransform","msTransform"],r=0;r<t.length;r++){var n=t[r];if(e.style[n]!==void 0)return n}return t[0]}(),I.prototype.requestAnimFrame_=H.requestAnimationFrame||H.webkitRequestAnimationFrame||H.mozRequestAnimationFrame||H.oRequestAnimationFrame||H.msRequestAnimationFrame||function(e){return H.setTimeout(e,1e3/60)},I.prototype.cancelAnimFrame_=H.cancelAnimationFrame||H.webkitCancelAnimationFrame||H.mozCancelAnimationFrame||H.oCancelAnimationFrame||H.msCancelAnimationFrame||function(e){},I.prototype.setOptions=function(e){e.animate!==void 0&&this.setAnimate(e.animate),e.paneName!==void 0&&this.setPaneName(e.paneName),e.updateHandler!==void 0&&this.setUpdateHandler(e.updateHandler),e.resizeHandler!==void 0&&this.setResizeHandler(e.resizeHandler),e.resolutionScale!==void 0&&this.setResolutionScale(e.resolutionScale),e.map!==void 0&&this.setMap(e.map)},I.prototype.setAnimate=function(e){this.isAnimated_=!!e,this.isAnimated_&&this.scheduleUpdate()},I.prototype.isAnimated=function(){return this.isAnimated_},I.prototype.setPaneName=function(e){this.paneName_=e,this.setPane_()},I.prototype.getPaneName=function(){return this.paneName_},I.prototype.setPane_=function(){if(!!this.isAdded_){var e=this.getPanes();if(!e[this.paneName_])throw new Error('"'+this.paneName_+'" is not a valid MapPane name.');e[this.paneName_].appendChild(this.canvas)}},I.prototype.setResizeHandler=function(e){this.resizeHandler_=e},I.prototype.setResolutionScale=function(e){typeof e=="number"&&(this.resolutionScale_=e,this.resize_())},I.prototype.setUpdateHandler=function(e){this.updateHandler_=e},I.prototype.onAdd=function(){this.isAdded_||(this.isAdded_=!0,this.setPane_(),this.resizeListener_=google.maps.event.addListener(this.getMap(),"resize",this.resizeFunction_),this.centerListener_=google.maps.event.addListener(this.getMap(),"center_changed",this.repositionFunction_),this.resize_(),this.repositionCanvas_())},I.prototype.onRemove=function(){!this.isAdded_||(this.isAdded_=!1,this.topLeft_=null,this.canvas.parentElement.removeChild(this.canvas),this.centerListener_&&(google.maps.event.removeListener(this.centerListener_),this.centerListener_=null),this.resizeListener_&&(google.maps.event.removeListener(this.resizeListener_),this.resizeListener_=null),this.requestAnimationFrameId_&&(this.cancelAnimFrame_.call(H,this.requestAnimationFrameId_),this.requestAnimationFrameId_=null))},I.prototype.resize_=function(){if(!!this.isAdded_){var e=this.getMap(),t=e.getDiv().offsetWidth,r=e.getDiv().offsetHeight,n=t*this.resolutionScale_,a=r*this.resolutionScale_,i=this.canvas.width,o=this.canvas.height;(i!==n||o!==a)&&(this.canvas.width=n,this.canvas.height=a,this.needsResize_=!0,this.scheduleUpdate()),(this.canvasCssWidth_!==t||this.canvasCssHeight_!==r)&&(this.canvasCssWidth_=t,this.canvasCssHeight_=r,this.canvas.style.width=t+"px",this.canvas.style.height=r+"px")}},I.prototype.draw=function(){this.repositionCanvas_()},I.prototype.repositionCanvas_=function(){var e=this.getMap(),t=e.getBounds().getNorthEast().lat(),r=e.getCenter(),n=Math.pow(2,e.getZoom()),a=r.lng()-this.canvasCssWidth_*180/(256*n);this.topLeft_=new google.maps.LatLng(t,a);var i=this.getProjection(),o=i.fromLatLngToDivPixel(r),s=-Math.round(this.canvasCssWidth_/2-o.x),l=-Math.round(this.canvasCssHeight_/2-o.y);this.canvas.style[I.CSS_TRANSFORM_]="translate("+s+"px,"+l+"px)",this.scheduleUpdate()},I.prototype.update_=function(){this.requestAnimationFrameId_=null,this.isAdded_&&(this.isAnimated_&&this.scheduleUpdate(),this.needsResize_&&this.resizeHandler_&&(this.needsResize_=!1,this.resizeHandler_()),this.updateHandler_&&this.updateHandler_())},I.prototype.getTopLeft=function(){return this.topLeft_},I.prototype.scheduleUpdate=function(){this.isAdded_&&!this.requestAnimationFrameId_&&(this.requestAnimationFrameId_=this.requestAnimFrame_.call(H,this.requestUpdateFunction_))});var zt=function(e){m1(t,e);function t(r,n,a){j(this,t);var i=w1(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r,n,a)),o=i,s=null;a=a||{},o.init(a),o.argCheck(a);var l={map:r,animate:!1,updateHandler:function(){o._canvasUpdate()},resolutionScale},f=i.canvasLayer=new I(l);return i.clickEvent=i.clickEvent.bind(i),i.mousemoveEvent=i.mousemoveEvent.bind(i),i.bindEvent(),i}return e1(t,[{key:"clickEvent",value:function(n){var a=n.pixel;n1(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"clickEvent",this).call(this,a,n)}},{key:"mousemoveEvent",value:function(n){var a=n.pixel;n1(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"mousemoveEvent",this).call(this,a,n)}},{key:"bindEvent",value:function(n){var a=this.map;this.options.methods&&(this.options.methods.click&&(a.setDefaultCursor("default"),a.addListener("click",this.clickEvent)),this.options.methods.mousemove&&a.addListener("mousemove",this.mousemoveEvent))}},{key:"unbindEvent",value:function(n){var a=this.map;this.options.methods&&(this.options.methods.click&&a.removeListener("click",this.clickEvent),this.options.methods.mousemove&&a.removeListener("mousemove",this.mousemoveEvent))}},{key:"getContext",value:function(){return this.canvasLayer.canvas.getContext(this.context)}},{key:"_canvasUpdate",value:function(n){if(!!this.canvasLayer){var a=this,i=a.options.animation,o=this.getContext();if(a.isEnabledTime()){if(n===void 0){U(o);return}this.context=="2d"&&(o.save(),o.globalCompositeOperation="destination-out",o.fillStyle="rgba(0, 0, 0, .1)",o.fillRect(0,0,o.canvas.width,o.canvas.height),o.restore())}else U(o);if(this.context=="2d")for(var s in a.options)o[s]=a.options[s];else o.clear(o.COLOR_BUFFER_BIT);if(!(a.options.minZoom&&l.getZoom()<a.options.minZoom||a.options.maxZoom&&l.getZoom()>a.options.maxZoom)){var d=1;this.context!="2d"&&(d=this.canvasLayer.devicePixelRatio);var l=this.map,f=l.getProjection(),d=Math.pow(2,l.zoom)*resolutionScale,v=f.fromLatLngToPoint(this.canvasLayer.getTopLeft()),c={transferCoordinate:function(_){var F=new google.maps.LatLng(_[1],_[0]),z=f.fromLatLngToPoint(F),m={x:(z.x-v.x)*d,y:(z.y-v.y)*d};return[m.x,m.y]}};n!==void 0&&(c.filter=function(p){var _=i.trails||10;return!!(n&&p.time>n-_&&p.time<n)});var y=a.dataSet.get(c);this.processData(y);var g=new google.maps.LatLng(0,0),w=f.fromLatLngToPoint(g),x={x:(w.x-v.x)*d,y:(w.y-v.y)*d};a.options.unit=="m"&&a.options.size?a.options._size=a.options.size/zoomUnit:a.options._size=a.options.size,this.drawContext(o,new A(y),a.options,x),a.options.updateCallback&&a.options.updateCallback(n)}}}},{key:"init",value:function(n){var a=this;a.options=n,this.initDataRange(n),this.context=a.options.context||"2d",a.options.zIndex&&this.canvasLayer&&this.canvasLayer.setZIndex(a.options.zIndex),this.initAnimator()}},{key:"addAnimatorEvent",value:function(){this.map.addListener("movestart",this.animatorMovestartEvent.bind(this)),this.map.addListener("moveend",this.animatorMoveendEvent.bind(this))}},{key:"show",value:function(){this.map.addOverlay(this.canvasLayer)}},{key:"hide",value:function(){this.map.removeOverlay(this.canvasLayer)}},{key:"draw",value:function(){self.canvasLayer.draw()}}]),t}(A1),Ot={getDataSet:function(t){for(var r=[],n=t.features,a=0;a<n.length;a++){var i=n[a],o=i.geometry,s=i.properties,l={};for(var f in s)l[f]=s[f];l.geometry=o,r.push(l)}return new A(r)}},Tt={CSVToArray:function(t,r){r=r||",";for(var n=new RegExp("(\\"+r+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+r+"\\r\\n]*))","gi"),a=[[]],i=null;i=n.exec(t);){var o=i[1];o.length&&o!==r&&a.push([]);var s;i[2]?s=i[2].replace(new RegExp('""',"g"),'"'):s=i[3],a[a.length-1].push(s)}return a},getDataSet:function(t){for(var r=this.CSVToArray(t,","),n=[],a=r[0],i=1;i<r.length-1;i++){for(var o=r[i],s={},l=0;l<o.length;l++){var f=o[l];a[l]=="geometry"&&(f=JSON.parse(f)),s[a[l]]=f}n.push(s)}return new A(n)}};M.version=K,M.canvasClear=U,M.canvasResolutionScale=a1,M.canvasDrawSimple=_1,M.canvasDrawHeatmap=P1,M.canvasDrawGrid=I1,M.canvasDrawHoneycomb=z1,M.webglDrawSimple=Z1,M.webglDrawPoint=R1,M.webglDrawLine=T1,M.webglDrawPolygon=k1,M.utilCityCenter=wt,M.utilCurve=bt,M.utilForceEdgeBundling=Ct,M.utilDataRangeIntensity=k,M.utilDataRangeCategory=p1,M.utilDataRangeChoropleth=f1,M.Map=Mt,M.baiduMapCanvasLayer=W,M.baiduMapAnimationLayer=Pt,M.baiduMapLayer=It,M.googleMapCanvasLayer=I,M.googleMapLayer=zt,M.DataSet=A,M.geojson=Ot,M.csv=Tt,Object.defineProperty(M,"__esModule",{value:!0})});

const rnd=()=>.2*Math.random()-.1,randomWalk=e=>{const t=[1];for(let l=1;l<e;l++)t[l]=Number((t[l-1]*(1+rnd())).toFixed(2));return t},prices=randomWalk(101),profit=e=>{if(console.log("start======================>"),!e||!e.length)return[0,0];const t=[],l=[];let i=0,n=0,a=0;console.log("buy=====>",0,e[0]);let r=-e[0];for(let o=1;o<e.length;o++){const s=e[o],d=a;r+s>a&&(console.log("sell=====>",o,s),t.includes(i)||t.push(i),n=o,a=r+s),d-s>r&&(console.log("buy=====>",o,s),!l.includes(n)&&n>0&&l.push(n),i=o,r=d-s)}return l[l.length-1]<n&&l.push(n),[t,l,t.length,l.length]},profit2=e=>{if(!e.length)return[];const t=[],l=o=>{t.push({buyIndex:o,sellIndex:-1})},i=o=>{const s=t[t.length-1];s&&(s.sellIndex=o)};let n=e[0],a=0;for(let o=0;o<e.length;o++){const s=e[o],d=s-n;a<=0&&d>0&&(l(o-1),a=1),a>=0&&d<0&&(i(o-1),a=-1),n=s}const r=t[t.length-1];return r.sellIndex===-1&&(r.sellIndex,e.length-1),console.log(t),t},[bIdxs,sIdxs]=profit(prices);profit2(prices);const data=prices.map((e,t)=>[t,e]),markPoints=[];bIdxs.forEach(e=>{markPoints.push({name:"买点",coord:[e,data[e][1]],symbolOffset:[0,10],itemStyle:{color:"red"}})}),sIdxs.forEach(e=>{markPoints.push({name:"卖点",coord:[e,data[e][1]],symbolOffset:[0,-10],itemStyle:{color:"yellowgreen"}})}),option={backgroundColor:"#080b30",title:{text:"quan-infinity",textStyle:{color:"#fff"}},tooltip:{trigger:"axis"},grid:{left:64,right:16,bottom:80},toolbox:{feature:{dataZoom:{yAxisIndex:"none"},restore:{},saveAsImage:{}}},xAxis:{axisLine:{show:!0,lineStyle:{color:"rgba(255,255,255,0.3)"}},axisTick:{show:!1},splitLine:{show:!1}},yAxis:{axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"rgba(255,255,255,0.3)"},splitLine:{show:!0,lineStyle:{color:"rgba(255,255,255,0.3)"}}},dataZoom:[{type:"inside",start:0,end:1e3},{start:0,end:1e3,handleIcon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4v1.3h1.3v-1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7V23h6.6V24.4z M13.3,19.6H6.7v-1.4h6.6V19.6z",handleSize:"80%",handleStyle:{color:"#fff",shadowBlur:3,shadowColor:"rgba(0, 0, 0, 0.6)",shadowOffsetX:2,shadowOffsetY:2}}],series:[{type:"line",lineStyle:{color:"#6c50f3"},markPoint:{symbol:"circle",symbolSize:10,data:markPoints},data}]};

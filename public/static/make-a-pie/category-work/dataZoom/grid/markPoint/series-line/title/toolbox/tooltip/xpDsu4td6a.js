const rnd=()=>.2*Math.random()-.1,randomWalk=e=>{const l=[1];for(let n=1;n<e;n++)l[n]=Number((l[n-1]*(1+rnd())).toFixed(2));return l},prices=randomWalk(11),profit=(e,l)=>{if(console.log("start======================>"),!e||!e.length)return[0,0];const n=[],r=[];for(let o=0;o<e.length;o++){const t=e[o];n[o]=[],r[o]=[];for(let s=l;s>=1;s--){if(o===0){n[o][s]=0,r[o][s]=-t;continue}r[o-1][s]+t>n[o-1][s]?(console.log("sell======>",o,s,t),n[o][s]=r[o-1][s]+t):n[o][s]=n[o-1][s],n[o-1][s-1]-t>r[o-1][s]?(console.log("buy======>",o,s,t),r[o][s]=n[o-1][s-1]-t):r[o][s]=r[o-1][s]}}return console.log("vvv",n[e.length-1][l]),[[],[]]},[bIdxs,sIdxs]=profit(prices,2),findValleyPeaks=e=>{if(!e.length)return[];const l=[],n=i=>{l.push({buyIndex:i,buyPrice:e[i],sellIndex:-1,sellPrice:-1/0})},r=i=>{const c=l[l.length-1];c&&(c.sellIndex=i,c.sellPrice=e[i])};let o=e[0],t=0;for(let i=0;i<e.length;i++){const c=e[i],f=c-o;t<=0&&f>0&&(n(i-1),t=1),t>=0&&f<0&&(r(i-1),t=-1),o=c}const s=l[l.length-1];return s.sellIndex===-1&&(s.sellIndex,e.length-1,s.sellPrice,e[e.length-1]),l},mergeTrade=(e,l)=>l.buyPrice>e.buyPrice&&l.sellPrice>e.sellPrice?{buyIndex:e.buyIndex,buyPrice:e.buyPrice,sellIndex:l.sellIndex,sellPrice:l.sellPrice}:e.sellPrice-e.buyPrice>l.sellPrice-l.buyPrice?{buyIndex:e.buyIndex,buyPrice:e.buyPrice,sellIndex:e.sellIndex,sellPrice:e.sellPrice}:{buyIndex:l.buyIndex,buyPrice:l.buyPrice,sellIndex:l.sellIndex,sellPrice:l.sellPrice},profit2=(e,l)=>{const n=findValleyPeaks(e);if(l>=n.length)return n},data=prices.map((e,l)=>[l,e]),markPoints=[];bIdxs.forEach(e=>{markPoints.push({name:"买点",coord:[e,data[e][1]],symbolOffset:[0,10],itemStyle:{color:"red"}})}),sIdxs.forEach(e=>{markPoints.push({name:"卖点",coord:[e,data[e][1]],symbolOffset:[0,-10],itemStyle:{color:"yellowgreen"}})}),option={backgroundColor:"#080b30",title:{text:"quan-infinity",textStyle:{color:"#fff"}},tooltip:{trigger:"axis"},grid:{left:64,right:16,bottom:80},toolbox:{feature:{dataZoom:{yAxisIndex:"none"},restore:{},saveAsImage:{}}},xAxis:{axisLine:{show:!0,lineStyle:{color:"rgba(255,255,255,0.3)"}},axisTick:{show:!1},splitLine:{show:!1}},yAxis:{axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"rgba(255,255,255,0.3)"},splitLine:{show:!0,lineStyle:{color:"rgba(255,255,255,0.3)"}}},dataZoom:[{type:"inside",start:0,end:1e3},{start:0,end:1e3,handleIcon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4v1.3h1.3v-1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7V23h6.6V24.4z M13.3,19.6H6.7v-1.4h6.6V19.6z",handleSize:"80%",handleStyle:{color:"#fff",shadowBlur:3,shadowColor:"rgba(0, 0, 0, 0.6)",shadowOffsetX:2,shadowOffsetY:2}}],series:[{type:"line",lineStyle:{color:"#6c50f3"},markPoint:{symbol:"circle",symbolSize:10,data:markPoints},data}]};

$(function(){var r=1,e=setInterval(function(){r++,refreshEcharts(r),r>241&&clearInterval(e)},1e3)});function refreshEcharts(r){var e=2e3,i=[],l=[],u,s,m=["日","一","二","三","四","五",""],n=autoTimeline("9:30","11:30"),a=autoTimeline("13:00","15:00");n.splice(n.length-1,1),a[0]="11:30/13:00";for(var x=n.concat(a),d=0;d<241;d++){var y=Math.floor(Math.random()*200);i.push(2100-y)}u=((Math.min.apply(Math,i)-e)/e*100).toFixed(2),s=((Math.max.apply(Math,i)-e)/e*100).toFixed(2);for(var d=0;d<241;d++){var y=Math.floor(Math.random()*100);l.push(2050-y)}myChart.setOption(option={title:{text:"股票分时刷新图"},dataZoom:[{type:"inside"}],tooltip:{trigger:"axis",formatter:function(t){var o=new Date;todays=o.getFullYear()+"/"+(o.getMonth()+1<10?"0"+(o.getMonth()+1):o.getMonth()+1)+"/"+(o.getDate()<10?"0"+o.getDate():o.getDate());var f=t[0].name&&t[0].name.length>0?"<span >"+option.title.text+"<br />"+todays+"/"+m[o.getDay()]+" "+t[0].name+"<br />"+t[0].seriesName+': <span style="color:'+c(t[0].data-e)+'">'+t[0].data.toFixed(2)+"</span><br />"+t[1].seriesName+': <span style="color:red">'+t[1].data.toFixed(2)+'</span><br />涨跌: <span style="color:'+c(t[0].data-e)+'">'+(t[0].data-e).toFixed(2)+"("+((t[0].data-e)/e*100).toFixed(2)+"%)</span></span>":"";function c(h){return h>0?"#FF0000":"#00FF00"}return f}},toolbox:{show:!0,feature:{mark:{show:!0},restore:{show:!0},saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",boundaryGap:!1,axisLabel:{interval:59},data:x}],yAxis:[{type:"value",scale:!0,min:"dataMin",max:"dataMax",axisLabel:{formatter:function(t){return t.toFixed(2)},textStyle:{color:function(t){return t.split(",").join("")<e?"green":"red"}}}},{type:"value",scale:!0,min:u,max:s,axisLabel:{formatter:function(t){return t+"%"},textStyle:{color:function(t){return t.split(",").join("")<0?"green":"red"}}}}],series:[{name:"价格",itemStyle:{normal:{color:"blue"}},lineStyle:{normal:{width:1}},animation:!1,smooth:!0,type:"line",data:i,markPoint:{data:[{type:"max",name:"最大值"},{type:"min",name:"最小值"}]},markLine:{silent:!0,label:{normal:{position:"start"}},data:[{yAxis:e.toFixed(2)}]}},{name:"均值",itemStyle:{normal:{color:"black"}},lineStyle:{normal:{width:1}},animation:!1,smooth:!0,type:"line",data:l}]})}function autoTimeline(r,e){for(var i=[],l=r.split(":")[0]*1,u=r.split(":")[1]*1,s=e.split(":")[0]*1,m=e.split(":")[1]*1,n=l;n<=s;n++)for(var r=n==l?u:"0",e=n==s?m:"59",a=r;a<=e;a++)a=a<10?"0"+a:a,i.push(n+":"+a);return i}

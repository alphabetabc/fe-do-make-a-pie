var uploadedDataURL="/asset/get/s/data-1554349414632-EoKmzIc1h.json";function str2month(r){var e=r.split("");e.splice(4,0,"-"),e.splice(7,0,"-"),e.splice(10);var a=e.join(""),s=new Date(a).toDateString().split(" ")[1];return s}var dims={time:0,levels:1,R:2},arrowSize=16;function renderArrow(r,e){var a=e.coord([e.value(dims.time),e.value(dims.levels)]);return{type:"path",shape:{pathData:"M22 6 L10 6 L10 16 L22 16 L10 16 L10 46",x:-arrowSize/2,y:-arrowSize/2,width:arrowSize,height:arrowSize},rotation:Math.PI/180*e.value(dims.R),position:a,style:e.style({stroke:"blue",fill:"none",lineWidth:1})}}function makeSeries(r,e){var a=r.data;let s=echarts.util.map(a.tt,function(t){let i=t.value<0?"dotted":"solid";var o=[],n=0;return echarts.util.map(t.pointdata,(l,d)=>{l&&l[0]>=n+12&&(o.push({xAxis:l[0],yAxis:l[1],value:t.value}),n=l[0])}),o.length==0&&o.push({xAxis:t.pointdata[Math.floor(t.pointdata.length/2)][0],yAxis:t.pointdata[Math.floor(t.pointdata.length/2)][1],value:t.pointdata.value}),echarts.util.merge({name:"温度",type:"line",smooth:!0,symbol:"none",symbolSize:0,lineStyle:{type:i,width:1},data:t.pointdata,markPoint:{symbol:"circle",symbolSize:"10",label:{color:"red",backgroundColor:"#fff"},itemStyle:{color:"transparent"},data:o}},e||{},!0)}),y=echarts.util.map(a.rh,function(t){let i=t.value>=95||t.value>=90?"#11a20f":t.value>=80?"#96f48c":t.value>=70?"#c8fcbe":"#11b41d";return t.pointdata.push([t.pointdata[0][0],t.pointdata[0][1]]),echarts.util.merge({name:"湿度",type:"line",smooth:!0,symbol:"none",symbolSize:0,lineStyle:{width:0},areaStyle:{color:i,opacity:".6"},data:t.pointdata},e||{},!0)}),p=[];echarts.util.map(a.wd,function(t,i){echarts.util.map(t,function(o,n){p.push([n,r.levels[i],o])})});let h={type:"custom",name:"风向",renderItem:renderArrow,encode:{x:dims.time,y:dims.levels},data:p},u=s.concat(y);return u.push(h),u}$.getJSON(uploadedDataURL,function(r){var e=r.stPLan,a={title:"Ec模式单点3小时间隔综合廓线图",lat:"35.24",lon:"113.6",time:"2017092912",baseTime:"000",offset:"072",timeZone:"北京时",seriesItem:e,nameY:"(单位：hPa）"},{title:s,lat:y,lon:p,time:h,baseTime:u,offset:t,timeZone:i,seriesItem:o,nameY:n}=a;option={title:[{text:s,left:"center"},{text:`lat:+${y} lon:${p}`,textStyle:{fontWeight:"normal",color:"red"},top:30,left:70},{text:h,textStyle:{fontWeight:"normal",color:"blue"},top:30,left:"center"},{text:`${u}-${t}`,textStyle:{fontWeight:"normal",color:"blue"},top:30,right:"70"},{text:str2month(h),textStyle:{fontWeight:"normal",color:"red"},bottom:15,left:"70"},{text:i,textStyle:{fontWeight:"normal"},bottom:15,right:"70"}],grid:{show:!0,top:"70px",left:"50px",right:"50px"},graphic:[{type:"group",bounding:"raw",left:0,top:60,z:100,width:40,height:480,children:[{type:"rect",z:100,shape:{width:40,height:480},style:{fill:"rgba(255,255,255,1)"}},{type:"text",z:100,right:"5",top:"-15",style:{fill:"#333",text:"hpa"}},{type:"text",z:100,right:"10",top:"1%",style:{fill:"#333",text:"100"}},{type:"text",z:100,right:"10",top:"11%",style:{fill:"#333",text:"200"}},{type:"text",z:100,right:"10",top:"41%",style:{fill:"#333",text:"500"}},{type:"text",z:100,right:"10",top:"61%",style:{fill:"#333",text:"700"}},{type:"text",z:100,right:"10",top:"76%",style:{fill:"#333",text:"850"}},{type:"text",z:100,right:"10",top:"86%",style:{fill:"#333",text:"950"}},{type:"text",z:100,right:"10",top:"91%",style:{fill:"#333",text:"1000"}}]},{type:"group",bounding:"raw",right:0,top:60,z:100,width:50,height:480,children:[{type:"rect",z:100,shape:{width:50,height:480},style:{fill:"rgba(255,255,255,1)"}},{type:"image",z:100,left:"12",top:"center",style:{image:"/images/legent.jpg",width:36,height:175}}]}],xAxis:{type:"category",boundaryGap:!1,data:e.vtis,axisLabel:{formatter:function(l){return echarts.format.formatTime("ddhh",new Date(+l))}}},yAxis:{type:"value",show:!1,name:n,inverse:!0,nameLocation:"center",nameGap:"40",min:function(l){return e.levels[e.levels.length-1]},max:function(l){return e.levels[0]+100}},dataZoom:{type:"inside",showDetail:!1,filterMode:"none",start:0,end:30,zoomLock:!0},series:makeSeries(o)},myChart.setOption(option)});

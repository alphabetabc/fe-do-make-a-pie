var baseImg="/asset/get/s/data-1571295640429-3Co5rpLX.png",scanImg="/asset/get/s/data-1571295559348-whnsd6fi.jpg",config={lineWidth:.5,color:"#00FFC2",levels:1,intensity:3,threshold:.01},canvas=document.createElement("canvas");canvas.width=4096,canvas.height=2048,context=canvas.getContext("2d"),context.lineWidth=config.lineWidth,context.strokeStyle=config.color,context.fillStyle=config.color,context.shadowColor=config.color,image(scanImg).then(function(e){for(var n=e.height,t=e.width,a=new Array(t*n),r=d3.contours().size([t,n]).smooth(!0),f=d3.geoIdentity().scale(canvas.width/t),v=d3.geoPath(f,context),s=0,l=0;s<n;++s)for(var c=0;c<t;++c,++l)a[l]=e.data[l<<2]/255;var d={image:canvas},g=[];function u(i,o){context.clearRect(0,0,canvas.width,canvas.height);for(var m=[],h=0;h<o;h++)m.push((i+1/o*h)%1);g=r.thresholds(m)(a),p()}function p(){g.forEach(function(i,o){context.beginPath(),v(i),context.globalAlpha=1,context.stroke(),o>config.levels/5*3&&(context.globalAlpha=.01,context.fill())}),d.onupdate()}d3.timer(function(i){var o=i%1e4/1e4;u(o,1)}),initCharts(d),u(config.threshold,config.levels)});function image(e){return new Promise(function(n){var t=new Image;t.src=e,t.onload=function(){var a=document.createElement("canvas");a.width=t.width/8,a.height=t.height/8;var r=a.getContext("2d");r.drawImage(t,0,0,a.width,a.height),n(r.getImageData(0,0,a.width,a.height))}})}function initCharts(e){var n=echarts.init(document.createElement("canvas"),null,{width:4096,height:2048}),t=new echarts.graphic.Image({style:{image:e.image,x:-1,y:-1,width:e.image.width+2,height:e.image.height+2}});n.getZr().add(t),e.onupdate=function(){t.dirty()},myChart.setOption({backgroundColor:"#000",globe:{baseTexture:baseImg,displacementScale:.05,displacementQuality:"high",shading:"realistic",realisticMaterial:{roughness:.2,metalness:0},postEffect:{enable:!0,depthOfField:{}},light:{ambient:{intensity:1},main:{intensity:0,shadow:!1}},viewControl:{center:[0,0,0],alpha:30,beta:160,autoRotate:!0,autoRotateAfterStill:10,distance:240,autoRotateSpeed:4},layers:[{type:"blend",blendTo:"emission",texture:n,intensity:config.intensity}]},series:[{type:"scatter3D",blendMode:"lighter",coordinateSystem:"globe",showEffectOn:"render",zlevel:2,effectType:"ripple",symbolSize:15,rippleEffect:{period:4,scale:4,brushType:"fill"},hoverAnimation:!0,itemStyle:{normal:{color:"rgba(235, 232, 6, 0.8)"}},data:[[51.511744,25.292405],[28.047305,-26.204103],[30.5234,50.450099],[15.981919,45.815008],[19.940063,50.100353],[6.143158,46.204389],[8.541694,47.376888],[-8.629105,41.157944],[-9.139337,38.722253],[4.352033,50.849644],[24.940524,60.170675],[19.040235,47.497913],[16.373819,48.208176],[30.30604,59.933177],[37.61501,55.75696],[-79.383184,43.653226]]}]})}

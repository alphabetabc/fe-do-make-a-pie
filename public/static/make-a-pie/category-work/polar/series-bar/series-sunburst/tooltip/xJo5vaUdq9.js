function hexToRgba(e,a){return"rgba("+parseInt("0x"+e.slice(1,3))+","+parseInt("0x"+e.slice(3,5))+","+parseInt("0x"+e.slice(5,7))+","+a+")"}var cw=document.body.clientHeight/70,tooltipAxis={trigger:"axis",padding:10,borderRadius:4,textStyle:{fontSize:12},axisPointer:{type:"none"},formatter:e=>{let a=e[2];return a?a.name+":"+a.value:""}},datalist=[{value:670,name:"环境资源"},{value:111,name:"安保资源"},{value:270,name:"消防资源"},{value:550,name:"监控资源"},{value:190,name:"物联网设备"},{value:190,name:"应急资源"}];let data2=[],data3=[],data4=[],data5=[],data6=[],total=0,valueArr=[],dataArr=JSON.parse(JSON.stringify(datalist));for(var j=0;j<datalist.length;j++)dataArr.push({value:0,name:""}),valueArr.push(datalist[j].value),total+=datalist[j].value;let max=Math.max.apply(null,valueArr),min=Math.min.apply(null,valueArr);valueArr.forEach((e,a)=>{data2.push(max/14),data3.push(max/30),data6.push(max/10),data4.push(total-e),data5.push({value:1,name:"111",index:a})}),data5.push({value:valueArr.length,name:"",itemStyle:{color:"transparent"}});let child={name:"",value:1},n=0;function xun(e,a,t){a++,!(a>11)&&(e.itemStyle?e.children=[{name:"",value:1}]:e.children=[{name:"",value:1,itemStyle:{color:"rgba(141, 192, 235, 0.1)"}}],xun(e.children[0],a))}xun(child,n),data5.forEach(e=>{e.name&&(e.children=[child])});let color=["#00ffff","#008cff","#8400ff","#00ff2a","#d9ff00","#ffd000","#ff5100"],serlist=[{type:"bar",data:data3,coordinateSystem:"polar",barWidth:"96%",name:"领用总量",stack:"a",itemStyle:{color:e=>color[e.dataIndex]},z:0},{type:"bar",data:data6,coordinateSystem:"polar",name:"领用总量",stack:"a",itemStyle:{color:"transparent"},z:0},{type:"bar",data:dataArr,coordinateSystem:"polar",name:"存储总量",stack:"a",itemStyle:{color:e=>e.name!=""?hexToRgba(color[e.dataIndex],.4):"transparent"},z:5},{type:"bar",data:data2,coordinateSystem:"polar",name:"领用总量",stack:"a",itemStyle:{color:e=>color[e.dataIndex]},z:5},{type:"bar",data:data4,coordinateSystem:"polar",name:"总量",stack:"a",itemStyle:{color:e=>"rgba(255,255,255,0.07)"},z:5},{type:"sunburst",startAngle:0,nodeClick:!1,center:["50%","60%"],radius:["10%","58%"],data:data5,label:{show:!1,color:"#fff",fontSize:14,rotate:"number",position:"top",formatter:e=>{if(e.data.name=="111")return(dataArr[e.data.index].value*100/total).toFixed(1)+"%"}},itemStyle:{color:"rgba(255,255,255,0)",borderWidth:2,borderColor:"rgba(0,0,0,0)"},z:-1}];option={backgroundColor:"rgba(0,0,0,1)",tooltip:tooltipAxis,grid:{top:0,bottom:0},angleAxis:{type:"category",startAngle:180,data:dataArr,splitLine:{show:!1,lineStyle:{width:1,type:"solid"}},axisLine:{show:!1,lineStyle:{color:"rgba(207,238,252,0.2)",width:1,type:"solid"}},axisTick:{show:!1,inside:!1,length:5,lineStyle:{color:"transparent",width:1}},axisLabel:{show:!0,formatter:(e,a)=>a<=datalist.length-1?(e*100/total).toFixed(1)+"%":"",color:"#fff",margin:-30,fontSize:16}},radiusAxis:{axisLine:{show:!1},splitLine:{show:!1,lineStyle:{type:"solid"}},axisLabel:{show:!1,color:"#fff",fontSize:1.2*cw},axisTick:{show:!1,inside:!1,length:5,lineStyle:{color:"transparent",width:1}}},polar:{z:0,center:["50%","60%"],radius:["10%","70%"]},series:serlist};

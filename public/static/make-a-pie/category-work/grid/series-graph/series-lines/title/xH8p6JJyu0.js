for(var nodes=[{x:"5",y:"5",name:"服务器",img:"data-1547632686885-o5Rfi3tyk.png",alarm:"产生告警了哦"},{x:"3",y:"0",name:"存储设备1",img:"data-1547633192258-2EYYUDdcd.png"},{x:"7",y:"0",name:"存储设备2",img:"data-1547633192258-2EYYUDdcd.png"},{x:"0",y:"10",name:"防火墙",img:"data-1547633094304-08Q_2YEvH.png"},{x:"5",y:"10",name:"网络设备1",img:"data-1547632915872-WZMUphq72.png",alarm:"产生告警了哦"},{x:"12",y:"12",name:"网络设备2",img:"data-1547632915872-WZMUphq72.png"}],links=[{source:"存储设备2",target:"存储设备1",name:"数据传输"},{source:"存储设备1",target:"服务器",name:"数据传输"},{source:"服务器",target:"防火墙",name:"访问"},{source:"防火墙",target:"网络设备1",name:"访问"},{source:"网络设备1",target:"网络设备2",name:"访问"}],charts={nodes:[],links:[],linesData:[]},dataMap=new Map,j=0;j<nodes.length;j++){var x=parseInt(nodes[j].x),y=parseInt(nodes[j].y),node={name:nodes[j].name,value:[x,y],symbolSize:50,alarm:nodes[j].alarm,symbol:"image:///asset/get/s/"+nodes[j].img,itemStyle:{normal:{color:"#12b5d0"}}};dataMap.set(nodes[j].name,[x,y]),charts.nodes.push(node)}for(var i=0;i<links.length;i++){var link={source:links[i].source,target:links[i].target,label:{normal:{show:!0,formatter:links[i].name}},lineStyle:{normal:{color:"#00FFFF"}}};charts.links.push(link);var lines=[{coord:dataMap.get(links[i].source)},{coord:dataMap.get(links[i].target)}];charts.linesData.push(lines)}option={title:{text:"网络拓扑图",textStyle:{fontWeight:"normal",color:"#00FFFF"}},backgroundColor:"#1b2735",xAxis:{show:!1,type:"value"},yAxis:{show:!1,type:"value"},series:[{type:"graph",layout:"none",coordinateSystem:"cartesian2d",symbolSize:50,label:{normal:{show:!0,position:"bottom",color:"#00FFFF"}},lineStyle:{normal:{width:2,shadowColor:"none"}},edgeSymbolSize:8,data:charts.nodes,links:charts.links,itemStyle:{normal:{label:{show:!0,formatter:function(e){return e.data.name}}}}},{name:"A",type:"lines",coordinateSystem:"cartesian2d",effect:{show:!0,trailLength:0,symbol:"arrow",color:"#00FFFF",symbolSize:8},data:charts.linesData}]},setInterval(()=>{for(var e=[],t=0;t<nodes.length;t++){var o=nodes[t].alarm;o!==null&&o!==""&&o!==void 0&&(option.series[0].data[t].symbolSize=60,option.series[0].data[t].label={normal:{color:"#DC143C"}},option.series[0].itemStyle.normal.label.formatter=function(a){return a.data.alarm!==void 0?a.data.name+`
[ `+a.data.alarm+" ]":a.data.name},e.push(t))}myChart.setOption(option),setTimeout(()=>{for(var a=0;a<e.length;a++)option.series[0].data[e[a]].symbolSize=50,option.series[0].data[e[a]].label={normal:{color:"#00FFFF"}},option.series[0].itemStyle.normal.label.formatter=function(r){return r.data.name};myChart.setOption(option)},500)},1e3);

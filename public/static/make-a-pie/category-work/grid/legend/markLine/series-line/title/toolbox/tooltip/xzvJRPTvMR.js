var threeMonthRate=[{ThreeMonthRate:[{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8},{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8},{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8}]},{ThreeMonthRate:[{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8},{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8},{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8}]},{ThreeMonthRate:[{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8},{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8},{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8}]},{ThreeMonthRate:[{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8},{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8},{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8}]},{ThreeMonthRate:[{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8},{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8},{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8}]},{ThreeMonthRate:[{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8},{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8},{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8}]},{ThreeMonthRate:[{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8},{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8},{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8}]},{ThreeMonthRate:[{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8},{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8},{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8}]},{ThreeMonthRate:[{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8},{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8},{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8}]},{ThreeMonthRate:[{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8},{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8},{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8}]},{ThreeMonthRate:[{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8},{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8},{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8}]},{ThreeMonthRate:[{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8},{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8},{yield:Math.random()*.1+.9,outputrate:Math.random()*.2+.8}]}],productnames=["产品1","产品2","产品3","产品4","产品5","产品6","产品7","产品8","产品9","产品10","产品11","产品12"],grids=[],xAxes=[],yAxes=[],series=[],titles=[],datas=[],aGradeRates=[],count=0,zh_month=new Array(3),now=new Date,currentMonth=now.getMonth()+1,productsnum=productnames.length,monthFontSize=12,monthRorate=0;productnames.length<6?(monthFontSize=12,monthRorate=0):productnames.length>6&&(monthFontSize=9,monthRorate=-90);for(var i=0;i<3;i++){var month=currentMonth-2+i;switch(month){case 1:zh_month[i]="一月";break;case 2:zh_month[i]="二月";break;case 3:zh_month[i]="三月";break;case 4:zh_month[i]="四月";break;case 5:zh_month[i]="五月";break;case 6:zh_month[i]="六月";break;case 7:zh_month[i]="七月";break;case 8:zh_month[i]="八月";break;case 9:zh_month[i]="九月";break;case 10:zh_month[i]="十月";break;case-1:case 11:zh_month[i]="十一月";break;case 0:case 12:zh_month[i]="十二月";break;default:break}}for(var i=0;i<productsnum;i++){threeMonthRate[i].ThreeMonthYield;for(var data=new Array(3),outputRate=new Array(3),j=0;j<3;j++)data[j]=threeMonthRate[i].ThreeMonthRate[j].yield*100,outputRate[j]=threeMonthRate[i].ThreeMonthRate[j].outputrate*100;i===0?grids.push({left:"4%",show:!0,borderWidth:0,backgroundColor:"#fff",shadowColor:"rgba(0, 0, 0, 0.3)",shadowBlur:1,height:"70%",top:"20%",width:1/productsnum*(100-4)+"%",right:100-4-1/productsnum*(100-4)+"%"}):grids.push({left:4+i/productsnum*(100-4)+"%",show:!0,borderWidth:0,backgroundColor:"#fff",shadowColor:"rgba(0, 0, 0, 0.3)",shadowBlur:1,height:"70%",top:"20%",Width:1/productsnum*(100-4)+"%",right:100-4-i/productsnum*(100-4)-1/productsnum*(100-4)+"%"}),titles.push({text:"最近三个月各产品良率和出货率变化趋势",left:"0%",top:"6%"}),xAxes.push({gridIndex:i,type:"category",data:zh_month,axisTick:{alignWithLabel:!1},textStyle:{fontSize:20,color:"red"},axisLabel:{show:!0,interval:0,rotate:monthRorate,margin:4,fontSize:monthFontSize},position:"bottom"}),xAxes.push({gridIndex:i,type:"category",position:"bottom",name:productnames[i],nameLocation:"center",nameTextStyle:{fontWeight:"bold"},nameGap:-5,offset:40,data:[""],axisTick:{length:40,inside:!0,show:!0},axisLabel:{inside:!1,show:!0},axisLine:{show:!1,onZero:!1}}),i==0?yAxes.push({gridIndex:i,type:"value",interval:20,max:100,min:0,axisTick:{inside:!1},name:"百分比 (%)",axisLabel:{show:!0,formatter:"{value} "},position:"left"}):yAxes.push({gridIndex:i,type:"value",interval:20,max:100,min:0,axisTick:{show:!1},axisLine:{show:!1,onZero:!0},axisLabel:{show:!1}}),series.push({xAxisIndex:i*2,yAxisIndex:i,name:"良率",type:"line",data,markLine:{data:[{type:"average",name:"良率均值"}]}}),series.push({xAxisIndex:i*2,yAxisIndex:i,name:"出货率",type:"line",data:outputRate,markLine:{data:[{type:"average",name:"出货率均值"}]}})}myChart.on("legendselectchanged",function(s){for(var a=myChart.getOption(),r=100,d=s.selected,t=0;t<a.series.length;t++){var o=100;for(var h in d)if(d[h]&&a.series[t].name==h){for(var e=0;e<a.series[t].data.length;e++)a.series[t].data[e]>0&&o>a.series[t].data[e]&&(o=a.series[t].data[e]);break}r>o&&(r=o)}for(var n=0;n<a.series.length;n++)a.yAxis[a.series[n].yAxisIndex].min=Math.floor((r-1)/2)*2>0?Math.floor((r-1)/2)*2:0;myChart.setOption(a)}),option={title:titles,tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:["良率","出货率"],top:"10%"},toolbox:{top:"10%",show:!0,feature:{dataView:{readOnly:!1},magicType:{type:["line","bar"]},restore:{title:"Refresh"},saveAsImage:{title:"Save"}}},grid:grids,xAxis:xAxes,yAxis:yAxes,series};for(var minall=100,b=0;b<option.series.length;b++){for(var minm=100,c=0;c<option.series[b].data.length;c++)option.series[b].data[c]>0&&minm>option.series[b].data[c]&&(minm=option.series[b].data[c]);minall>minm&&(minall=minm)}for(var b=0;b<option.series.length;b++)option.yAxis[option.series[b].yAxisIndex].min=Math.floor((minall-1)/2)*2>0?Math.floor((minall-1)/2)*2:0,option.yAxis[option.series[b].yAxisIndex].interval=(100-option.yAxis[option.series[b].yAxisIndex].min)/5;

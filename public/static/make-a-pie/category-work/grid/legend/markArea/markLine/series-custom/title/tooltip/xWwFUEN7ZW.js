var BLUEC="/asset/get/s/data-1621845955864-3axUFqMm9.png",BLUET="/asset/get/s/data-1621845950102-7gUZRwc_3.png",ORANGEC="/asset/get/s/data-1621845936770-R15Ud_DLZ.png",ORANGET="/asset/get/s/data-1621845872303-YqLesHwVD.png";let start_="2021-01-1 00:00:00",end_="2021-12-31 00:00:00",allinfo=[],yAxisData_plant=[],chartsdata=[[{product:"A",list:[{db_version:" A",pre_package_time:"2021-02-1 00:00:00",pre_release_time:"2021-03-1 00:00:00",release_version:"0",re_package_time:"2021-03-5 00:00:00",re_release_time:"2021-04-2 00:00:00",id:3,remark:"40"},{db_version:" A",pre_package_time:"2021-02-8 00:00:00",pre_release_time:"2021-03-2 00:00:00",release_version:"1",re_package_time:"2021-04-1 00:00:00",re_release_time:"2021-04-10 00:00:00",id:4,remark:"180"},{db_version:" A",pre_package_time:"2021-06-2 00:00:00",pre_release_time:"2021-06-15 00:00:00",release_version:"1a",re_package_time:"2021-06-18 00:00:00",re_release_time:"2021-07-10 00:00:00",id:4,remark:"P1"}]}],[{product:" B",list:[{db_version:"  B",pre_package_time:"2021-03-5 00:00:00",pre_release_time:"2021-03-20 00:00:00",release_version:"0",re_package_time:"2021-03-10 00:00:00",re_release_time:"2021-03-22 00:00:00",id:3,remark:"20"}]}],[{product:"C",list:[{db_version:"C ",pre_package_time:"2021-06-23 00:00:00",pre_release_time:"2021-07-07 00:00:00",release_version:"1",re_package_time:"2021-06-23 00:00:00",re_release_time:"2021-07-13 00:00:00",id:9,remark:"0"}]}],[{product:"D ",list:[{db_version:"D ",pre_package_time:"2020-12-2 00:00:00",pre_release_time:"2020-12-22 00:00:00",release_version:"0",re_release_time:"2020-12-2 00:00:00",re_package_time:"2020-12-22 00:00:00",id:14,remark:"90"}]}]],seriesData=[],RealData=[],newBase=[],newBlock=[];newBlock.push([{name:"元旦",xAxis:new Date("2021-01-01 00:00:00".replace(/-/g,"/")).getTime(),label:{fontWeight:"bold",position:"top",distance:-2,fontSize:14,color:"#a8071a",fontFamily:"Microsoft YaHei"}},{xAxis:new Date("2021-01-3 23:59:00".replace(/-/g,"/")).getTime()}]),newBlock.push([{name:"春節",xAxis:new Date("2021-02-06 00:00:00".replace(/-/g,"/")).getTime(),label:{fontWeight:"bold",position:"top",distance:-2,fontSize:14,color:"#a8071a",fontFamily:"Microsoft YaHei"}},{xAxis:new Date("2021-02-21 23:59:00".replace(/-/g,"/")).getTime()}]),newBlock.push([{name:"清明節",xAxis:new Date("2021-04-03 00:00:00".replace(/-/g,"/")).getTime(),label:{fontWeight:"bold",position:"top",distance:-2,fontSize:14,color:"#a8071a",fontFamily:"Microsoft YaHei"}},{xAxis:new Date("2021-04-5 23:59:00".replace(/-/g,"/")).getTime()}]),newBlock.push([{name:"勞動節",xAxis:new Date("2021-05-01 00:00:00".replace(/-/g,"/")).getTime(),label:{fontWeight:"bold",position:"top",distance:-2,fontSize:14,color:"#a8071a",fontFamily:"Microsoft YaHei"}},{xAxis:new Date("2021-05-3 23:59:00".replace(/-/g,"/")).getTime()}]),newBlock.push([{name:"端午節",xAxis:new Date("2021-06-12 00:00:00".replace(/-/g,"/")).getTime(),label:{fontWeight:"bold",position:"top",distance:-2,fontSize:14,color:"#a8071a",fontFamily:"Microsoft YaHei"}},{xAxis:new Date("2021-06-14 23:59:00".replace(/-/g,"/")).getTime()}]),newBlock.push([{name:"中秋節",xAxis:new Date("2021-09-19 00:00:00".replace(/-/g,"/")).getTime(),label:{fontWeight:"bold",position:"top",distance:-2,fontSize:14,color:"#a8071a",fontFamily:"Microsoft YaHei"}},{xAxis:new Date("2021-09-21 23:59:00".replace(/-/g,"/")).getTime()}]),newBlock.push([{name:"國慶節",xAxis:new Date("2021-10-1 00:00:00".replace(/-/g,"/")).getTime(),label:{fontWeight:"bold",position:"top",distance:-2,fontSize:14,color:"#a8071a",fontFamily:"Microsoft YaHei"}},{xAxis:new Date("2021-10-5 23:59:00".replace(/-/g,"/")).getTime()}]),chartsdata.length>0&&chartsdata.map((t,e)=>{yAxisData_plant.push(t[0].product),t[0].list.length>0&&t[0].list.map(o=>{allinfo.push(o);let a=new Date(o.pre_package_time.replace("00:00:00","12:00:00").replace(/-/g,"/")).getTime(),n=new Date(o.pre_release_time.replace("00:00:00","12:00:00").replace(/-/g,"/")).getTime(),i=o.re_package_time?new Date(o.re_package_time.replace("00:00:00","12:00:00").replace(/-/g,"/")).getTime():"",l=o.re_release_time?new Date(o.re_release_time.replace("00:00:00","12:00:00").replace(/-/g,"/")).getTime():"";seriesData.push({name:o.release_version,value:[e,a,n],itemStyle:{normal:{color:"#ff833b"}}}),RealData.push({name:o.release_version,value:[e,i,l],itemStyle:{normal:{color:"#2194ff"}}})})}),option={title:{left:"center",text:"Overall Schedule"},color:["#ff833b","#2194ff"],legend:{data:["计划时间","实际时间"],tooltip:{show:!0},top:30,itemWidth:15,itemHeight:15,textStyle:{fontSize:16,fontFamily:"Microsoft YaHei"},itemGap:120,padding:5},tooltip:{formatter:function(t){if(t.componentType!="markLine"&&t.componentType!="markArea"){var e=t.name+"<br/>";return e+="计划冻结时间："+allinfo[t.dataIndex].pre_package_time.split(" ")[0].replace(/-/g,"/")+"&nbsp;<br/>计划发布时间："+allinfo[t.dataIndex].pre_release_time.split(" ")[0].replace(/-/g,"/")+"&nbsp;<br/>实际冻结时间："+allinfo[t.dataIndex].re_package_time.split(" ")[0].replace(/-/g,"/")+"&nbsp;<br/>实际发布时间："+allinfo[t.dataIndex].re_release_time.split(" ")[0].replace(/-/g,"/")+"&nbsp;",e}else if(t.componentType!="markArea"){let a=new Date(t.value);var o=`时间：${[a.getFullYear(),a.getMonth()+1,a.getDate()].join("/")}`;return o}else{let a=t.dataIndex;var o="封网时间：2021-05-05 ~ 2021-05-25";return o}},textStyle:{align:"left"}},grid:{top:100,left:80,right:38,bottom:10,height:545},xAxis:{type:"time",min:new Date(start_).getTime(),max:new Date(end_).getTime(),interval:(new Date(end_).getTime()-new Date(start_).getTime())/12,position:"top",splitNumber:12,axisLabel:{show:!0,textStyle:{color:"#000"},interval:0,margin:15,fontSize:14,formatter:function(t,e){let o=new Date(t);return[o.getFullYear(),o.getMonth()+1,o.getDate()].join("/")}},axisLine:{show:!0},splitLine:{show:!0,lineStyle:{color:"rgba(0,0,0,0.2)",type:"dashed"}}},yAxis:{axisLine:{onZero:!1,show:!0},axisLabel:{show:!0,textStyle:{color:"#000"},fontSize:14},splitLine:{show:!0,lineStyle:{color:"rgba(0,0,0,0.2)",type:"dashed"}},inverse:!0,data:yAxisData_plant},series:[{name:"计划时间",type:"custom",label:{normal:{show:!0,position:"bottom",padding:[18,0,0,0],formatter:function(t){return[`{fragment1|${allinfo[t.dataIndex].remark?allinfo[t.dataIndex].remark.split(",").join(`
`):""}}`].join(`
`)},color:"#000",fontSize:11,rich:{fragment1:{lineHeight:14,align:"center",color:"#000"}}}},renderItem:function(t,e){let o=e.value(0),a=e.coord([e.value(1),o]),n=e.coord([e.value(2),o]),i=e.size([0,1])[1]*.03,l=echarts.graphic.clipRectByRect({x:a[0],y:a[1]-15,width:n[0]-a[0],height:4},{x:t.coordSys.x,y:t.coordSys.y,width:t.coordSys.width,height:t.coordSys.height});return l&&{type:"rect",shape:l,style:e.style(),styleEmphasis:{textStroke:null}}},encode:{x:[1,2],y:0},data:seriesData},{name:"计划时间",type:"custom",label:{normal:{show:!0,position:"top",padding:[0,0,10,0],formatter:function(t,e){return`{term|${t.name}}`},color:"#000",rich:{term:{align:"center",fontSize:16,color:"rgb(199,86,83)"}}}},renderItem:function(t,e){let o=e.value(0),a=e.coord([e.value(1),o]),n=e.coord([e.value(2),o]),i=e.size([0,1])[1]*.03,l=echarts.graphic.clipRectByRect({x:a[0],y:a[1]-15,width:n[0]-a[0],height:4},{x:t.coordSys.x,y:t.coordSys.y,width:t.coordSys.width,height:t.coordSys.height});return l&&{type:"rect",shape:l,style:e.style(),styleEmphasis:{textStroke:null}}},encode:{x:[1,2],y:0},data:seriesData,markLine:{data:newBase},markArea:{itemStyle:{color:"rgba(200, 200, 200, 0.4)"},data:newBlock}},{name:"计划时间",type:"custom",label:{normal:{show:!0,position:"left",padding:[0,-5,0,0],formatter:function(t){let e=new Date(t.data.value[1]);return`{fragment1|${[e.getMonth()+1,e.getDate()].join("/")}}{one|}`},rich:{fragment1:{color:"#000",fontSize:10,padding:[20,-25,0,0]},one:{fontSize:8,backgroundColor:{image:ORANGET}}}}},renderItem:function(t,e){let o=e.value(0),a=e.coord([e.value(1),o]),n=e.coord([e.value(2),o]),i=e.size([0,1])[1]*.03,l=echarts.graphic.clipRectByRect({x:a[0],y:a[1]-15,width:n[0]-a[0],height:4},{x:t.coordSys.x,y:t.coordSys.y,width:t.coordSys.width,height:t.coordSys.height});return l&&{type:"rect",shape:l,style:e.style(),styleEmphasis:{textStroke:null}}},encode:{x:[1,2],y:0},data:seriesData},{name:"计划时间",type:"custom",label:{normal:{show:!0,position:"right",padding:[0,0,0,-5],formatter:function(t){let e=new Date(t.data.value[2]);return`{one|}{fragment1|${[e.getMonth()+1,e.getDate()].join("/")}}`},rich:{fragment1:{color:"#000",fontSize:10,padding:[20,0,0,-25]},one:{fontSize:8,backgroundColor:{image:ORANGEC}}}}},renderItem:function(t,e){let o=e.value(0),a=e.coord([e.value(1),o]),n=e.coord([e.value(2),o]),i=e.size([0,1])[1]*.03,l=echarts.graphic.clipRectByRect({x:a[0],y:a[1]-15,width:n[0]-a[0],height:4},{x:t.coordSys.x,y:t.coordSys.y,width:t.coordSys.width,height:t.coordSys.height});return l&&{type:"rect",shape:l,style:e.style(),styleEmphasis:{textStroke:null}}},encode:{x:[1,2],y:0},data:seriesData},{name:"实际时间",type:"custom",label:{normal:{show:!0,position:"left",padding:[0,-5,0,0],formatter:function(t){let e=new Date(t.data.value[1]);return`{fragment1|${[e.getMonth()+1,e.getDate()].join("/")}}{one|}`},rich:{fragment1:{color:"#000",fontSize:10,padding:[0,-25,20,0]},one:{fontSize:8,backgroundColor:{image:BLUET}}}}},renderItem:function(t,e){let o=e.value(0),a=e.coord([e.value(1),o]),n=e.coord([e.value(2),o]),i=e.size([0,1])[1]*.03,l=echarts.graphic.clipRectByRect({x:a[0],y:a[1]-5,width:n[0]-a[0],height:4},{x:t.coordSys.x,y:t.coordSys.y,width:t.coordSys.width,height:t.coordSys.height});return l&&{type:"rect",shape:l,style:e.style(),styleEmphasis:{textStroke:null}}},encode:{x:[1,2],y:0},data:RealData},{name:"实际时间",type:"custom",label:{normal:{show:!0,position:"right",padding:[0,0,0,-5],formatter:function(t){let e=new Date(t.data.value[2]);return`{one|}{fragment1|${[e.getMonth()+1,e.getDate()].join("/")}}`},rich:{fragment1:{color:"#000",fontSize:10,padding:[0,0,20,-25]},one:{fontSize:8,backgroundColor:{image:BLUEC}}}}},renderItem:function(t,e){let o=e.value(0),a=e.coord([e.value(1),o]),n=e.coord([e.value(2),o]),i=e.size([0,1])[1]*.03,l=echarts.graphic.clipRectByRect({x:a[0],y:a[1]-5,width:n[0]-a[0],height:4},{x:t.coordSys.x,y:t.coordSys.y,width:t.coordSys.width,height:t.coordSys.height});return l&&{type:"rect",shape:l,style:e.style(),styleEmphasis:{textStroke:null}}},encode:{x:[1,2],y:0},data:RealData}]};

let data={xData:["2020-08-17","2020-08-18","2020-08-19","2020-08-20","2020-08-21","2020-08-22","2020-08-23","2020-08-24","2020-08-25","2020-08-26"]},xData=["2020-08-17","2020-08-18","2020-08-19","2020-08-20","2020-08-21","2020-08-22","2020-08-23","2020-08-24","2020-08-25","2020-08-26"],totDay=xData.length,generateData=[],spreadData=[],disappearData=[],dieData=[],secondData=[],trueData=[],predictData=[],generateDataIdx=[0,1],spreadDataIdx=[0,1,2,3],disappearDataIdx=[0,0,0,1,2,3],dieDataIdx=[0,0,0,0,0,1,2,3],secondDataIdx=[0,0,0,0,0,0,0,1,2,3],predictSet=new Set;predictSet.add("2020-08-22"),predictSet.add("2020-08-23"),predictSet.add("2020-08-24"),predictSet.add("2020-08-25"),predictSet.add("2020-08-26");let colorMap={发生阶段:"#D24136",扩散阶段:"#EB8A3E",消弥阶段:"#EBB582",消亡阶段:"#785A46",二次扩散阶段:"#217CA3"};function hex2rgb(e){if(e=="")return"";e=e.substring(1),e=e.toLowerCase();let t=new Array;for(let a=0;a<3;a++)t[0]=e.substr(a*2,2),t[3]="0123456789abcdef",t[1]=t[0].substr(0,1),t[2]=t[0].substr(1,1),t[20+a]=t[3].indexOf(t[1])*16+t[3].indexOf(t[2]);return"rgba("+t[20]+","+t[21]+","+t[22]}for(let e=0;e<totDay;e++)generateData.push("-"),spreadData.push("-"),disappearData.push("-"),dieData.push("-"),secondData.push("-"),predictData.push("-"),trueData.push("-");generateData[0]=0;for(let e=0;e<totDay;e++)generateDataIdx[e]&&(generateData[e]=Math.random()*200),spreadDataIdx[e]>1?spreadData[e]=Math.random()*200:spreadDataIdx[e]===1&&(spreadData[e]=generateData[e]),disappearDataIdx[e]>1?disappearData[e]=Math.random()*200:disappearDataIdx[e]===1&&(disappearData[e]=spreadData[e]),dieDataIdx[e]>1?dieData[e]=Math.random()*200:dieDataIdx[e]===1&&(dieData[e]=disappearData[e]),secondDataIdx[e]>1?secondData[e]=Math.random()*200:secondDataIdx[e]===1&&(secondData[e]=dieData[e]);console.log(dieData);let series=[{data:[{name:"发生阶段",value:1}],label:{show:!0,position:"inside",formatter:"{b}",offset:[0,10],textStyle:{color:"#D24136"}},type:"bar",barGap:0,barWidth:"11.1%",itemStyle:{normal:{color:"#fff"}},xAxisIndex:1,yAxisIndex:1},{data:[{name:"扩散阶段",value:1}],label:{show:!0,position:"inside",formatter:"{b}",offset:[0,10],textStyle:{color:"#EB8A3E"}},type:"bar",barGap:0,barWidth:"22.2%",itemStyle:{normal:{color:"#fff"}},xAxisIndex:1,yAxisIndex:1},{data:[{name:"消弥阶段",value:1}],label:{show:!0,position:"inside",formatter:"{b}",offset:[0,10],textStyle:{color:"#EBB582"}},type:"bar",barGap:0,barWidth:"22.2%",itemStyle:{normal:{color:"#fff"}},xAxisIndex:1,yAxisIndex:1},{data:[{name:"消亡阶段",value:1}],label:{show:!0,position:"inside",formatter:"{b}",offset:[0,10],textStyle:{color:"#785A46"}},type:"bar",barGap:0,barWidth:"22.2%",itemStyle:{normal:{color:"#fff"}},xAxisIndex:1,yAxisIndex:1},{data:[{name:"二次扩散阶段",value:1}],label:{show:!0,position:"inside",formatter:"{b}",offset:[0,10],textStyle:{color:"#217CA3"}},type:"bar",barCategoryGap:0,barGap:0,barWidth:"22.2%",itemStyle:{normal:{color:"#fff"}},xAxisIndex:1,yAxisIndex:1}];series.push({name:"发生阶段",data:generateData,type:"line",xAxisIndex:0,yAxisIndex:0,itemStyle:{normal:{color:"#D24136",lineStyle:{width:2},areaStyle:{color:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:hex2rgb("#D24136")+",0.2)"},{offset:1,color:hex2rgb("#D24136")+",0.1)"}])}}},predict:!1}),series.push({name:"扩散阶段",data:spreadData,type:"line",xAxisIndex:0,yAxisIndex:0,itemStyle:{normal:{color:"#EB8A3E",lineStyle:{width:2},areaStyle:{color:new echarts.graphic.LinearGradient(0,1,0,0,[{offset:0,color:hex2rgb("#EB8A3E")+",0.2)"},{offset:1,color:hex2rgb("#EB8A3E")+",0.1)"}])}}},predict:!1}),series.push({name:"消弥阶段",data:disappearData,type:"line",xAxisIndex:0,yAxisIndex:0,itemStyle:{normal:{color:"#EBB582",lineStyle:{width:2},areaStyle:{color:new echarts.graphic.LinearGradient(0,1,0,0,[{offset:0,color:hex2rgb("#EBB582")+",0.2)"},{offset:1,color:hex2rgb("#EBB582")+",0.1)"}])}}},markPoint:{label:{normal:{show:!0,align:"center",color:"WHITE"}},itemStyle:{normal:{color:"red"}},data:[{coord:[4,disappearData[4]]}]},predict:!1}),series.push({name:"消弥阶段",data:disappearData,type:"line",xAxisIndex:0,yAxisIndex:0,itemStyle:{normal:{color:"#EBB582",lineStyle:{width:2},areaStyle:{color:new echarts.graphic.LinearGradient(0,1,0,0,[{offset:0,color:hex2rgb("#EBB582")+",0.2)"},{offset:1,color:hex2rgb("#EBB582")+",0.1)"}])}}},markPoint:{label:{normal:{show:!0,align:"center",color:"WHITE"}},itemStyle:{normal:{color:"red"}},data:[{coord:[4,disappearData[4]]}]},predict:!1});let disappearData1=[];for(let e=0;e<disappearData.length;e++)disappearData1.push("-");disappearData1[4]=disappearData[4],disappearData1[5]=dieData[5],disappearData[5]="-",series.push({name:"消弥阶段",data:disappearData1,type:"line",xAxisIndex:0,yAxisIndex:0,itemStyle:{normal:{color:"#EBB582",lineStyle:{width:2,type:"dashed"}}},predict:!0}),series.push({name:"消亡阶段",data:dieData,type:"line",xAxisIndex:0,yAxisIndex:0,itemStyle:{normal:{color:"#785A46",lineStyle:{width:2,type:"dashed"}}},markPoint:{symbolOffset:[0,"-20%"],itemStyle:{normal:{color:"red",label:{color:"red",position:"bottom",formatter:function(e){return"二次扩散起点"}}}},data:[{name:"二次扩散起点",coord:[7,dieData[7]]}]},predict:!0}),series.push({name:"二次扩散阶段",data:secondData,type:"line",xAxisIndex:0,yAxisIndex:0,itemStyle:{normal:{color:"#217CA3",lineStyle:{width:2,type:"dashed"}}},predict:!0}),series.push({name:"预测",data:predictData,type:"line",xAxisIndex:0,yAxisIndex:0,itemStyle:{normal:{color:"#217CA3",lineStyle:{width:2,type:"dashed"}}},predict:!0}),series.push({name:"实际",data:trueData,type:"line",xAxisIndex:0,yAxisIndex:0,itemStyle:{normal:{color:"#217CA3",lineStyle:{width:2,type:"dashed"}}},predict:!0}),option={backgroundColor:"#fff",tooltip:{trigger:"axis",extraCssText:"padding:5px;display:flex;font-size:12px;line-height:24px;color:black;background:#fff;box-shadow:0 0 3px rgba(0, 0, 0, 0.2)",formatter:function(e){let t="",a="",r=0;for(let o=0;o<e.length;o++){let l=e[o];if(l.value!=="-"){r=l.value,t=l.axisValue,a=l.seriesName;break}}let i="实际";predictSet.has(t)&&(i="预测");let s=i==="实际"?"solid":"dashed",n="";return n+=`<div><span style="display:inline-block; margin-bottom:5px; width:20px; height:10px; border-bottom: 1px ${s} ${colorMap[a]}"></span><span style="margin-left:10px">${i}:</span><span style="margin-left:10px;font-weight:500; font-size:18px">${r.toFixed(0)}</span><span style="padding:5px; margin-left:10px; background:${hex2rgb(colorMap[a])}, 0.3);border-radius:4px; color:${colorMap[a]}">${a}</span> </div>`,n}},legend:{show:!0,top:10,itemWidth:15,itemHeight:15,data:[{name:"预测",icon:"line"},{name:"实际",icon:"line",color:"black"},{name:"发生阶段",icon:"rect"},{name:"扩散阶段",icon:"rect"},{name:"消弥阶段",icon:"rect"},{name:"消亡阶段",icon:"rect"},{name:"二次扩散阶段",icon:"rect"}]},grid:[{top:50,bottom:60,left:40,right:40},{left:40,right:40,height:40,bottom:20}],xAxis:[{type:"category",data:data.xData,boundaryGap:!1,gridIndex:0,axisLabel:{color:"#333"},axisLine:{lineStyle:{color:"#e7e7e7"}},axisTick:{lineStyle:{color:"#e7e7e7"}},zlevel:2},{type:"category",gridIndex:1,axisLine:{show:!1},zlevel:1}],yAxis:[{type:"value",gridIndex:0,axisLabel:{color:"#333"},splitLine:{lineStyle:{type:"dashed"}},axisLine:{lineStyle:{color:"#ccc"}},axisTick:{lineStyle:{color:"#ccc"}}},{type:"value",gridIndex:1,axisLabel:{show:!1},axisLine:{show:!1},splitLine:{show:!1},axisTick:{show:!1}}],series};

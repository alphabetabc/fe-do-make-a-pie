var series=[{name:"直接访问",type:"bar",stack:"总量",label:{show:!0,position:"insideRight"},data:[2,2,2,2,2,2,1]},{name:"邮件营销",type:"bar",stack:"总量",label:{show:!0,position:"insideRight"},data:[120,132,101,134,90,230,210]},{name:"联盟广告",type:"bar",stack:"总量",label:{show:!0,position:"insideRight"},data:[220,182,191,234,290,330,310]},{name:"视频广告",type:"bar",stack:"总量",label:{show:!0,position:"insideRight"},data:[150,212,201,154,190,330,410]},{name:"搜索引擎",type:"bar",stack:"总量",label:{show:!0,position:"insideRight"},data:[820,832,901,934,1290,1330,1320]},{name:"转化率",type:"line",data:[90,60,80,30,15,68,77],yAxisIndex:1}];function getSeriesItemMax(a){console.log(a);var t=[];return a.forEach(i=>{i.forEach((s,e)=>{t[e]?isNaN(s/1)?t[e]+=0:t[e]+=s/1:isNaN(s/1)?t[e]=0:t[e]=s/1})}),Math.max.apply(null,t)}function yAxisMax(a){if(isNaN(a/1)||a/1<10)return 10;const t=Math.ceil(a)+"",i=Math.ceil(t/5)+"",e=Math.ceil(i/Math.pow(10,i.length-1))*Math.pow(10,i.length-1)+"";return Math.ceil(e/5)*5*5}var y1DataList=[],y2DataList=[];series.forEach(a=>{a.type==="bar"?y1DataList.push(a.data):a.type==="line"&&y2DataList.push(a.data)});var y1MaxValue=getSeriesItemMax(y1DataList),y2MaxValue=getSeriesItemMax(y2DataList),y1Max=yAxisMax(y1MaxValue),y2Max=yAxisMax(y2MaxValue),yAxis=[{type:"value",min:0,max:y1Max,splitNumber:5,interval:y1Max/5},{type:"value",splitNumber:5,min:0,max:y2Max,interval:y2Max/5,axisLabel:{formatter:"{value}%"}}];option={legend:{data:["直接访问","邮件营销","联盟广告","视频广告","搜索引擎"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:["周一","周二","周三","周四","周五","周六","周日"]},tooltip:{trigger:"item"},yAxis,series};

var getname=["1次","2次","3次及以上"],getxlmc=["全屋定制类","木门类","橱柜类"],getvalue=[3466,714,214],getvalue1=[748,215,90],getvalue2=[316,37,4],getzb=[76.51,73.91,50.12],getzb1=[16.51,22.26,21.08],getzb2=[6.98,3.83,.94];function multi_bubbleSort(e){let s=e.data0,r=new Array(s.length).fill(0),l=e.data0.length;for(let a=0;a<l;a++)for(let t=0;t<e.data1.length;t++)r[a]=Number(r[a])+Number(e.data1[t][a]);for(let a=0;a<l;a++)for(let t=0;t<l-1-a;t++)if(Number(r[t])<Number(r[t+1])){let n=r[t+1];r[t+1]=r[t],r[t]=n;let f=e.data0[t+1];e.data0[t+1]=e.data0[t],e.data0[t]=f;for(let o=0;o<e.data2.length;o++){let h=e.data2[o][t+1];e.data2[o][t+1]=e.data2[o][t],e.data2[o][t]=h}}return e}let obj={data0:getname,data1:[getvalue,getvalue1,getvalue2],data2:[getvalue,getvalue1,getvalue2]},multi_obj=multi_bubbleSort(obj);option={backgroundColor:"#000",grid:{top:"15",right:"150",left:"100",bottom:"15"},tooltip:{trigger:"axis",axisPointer:{type:"none"},backgroundColor:"rgba(21, 64, 92, 0.5)",formatter:function(e){var s="";return s+='<span style="color:rgba(255, 255, 255, 1);font:13px bold;">'+e[0].name+"<br>"+e[0].seriesName+":&nbsp;&nbsp;"+e[0].value+"次&nbsp;&nbsp;"+getzb[e[0].dataIndex]+"%</br>"+e[1].seriesName+":&nbsp;&nbsp;"+e[1].value+"次&nbsp;&nbsp;"+getzb1[e[1].dataIndex]+"%</br>"+e[2].seriesName+":&nbsp;&nbsp;"+e[2].value+"次&nbsp;&nbsp;"+getzb2[e[2].dataIndex]+"%</br>",s}},legend:{type:"scroll",icon:"circle",right:"10",top:"0",data:getxlmc,itemGap:20,itemWidth:11,itemHeight:11,textStyle:{fontSize:"13",color:"#A9C1E5"}},yAxis:[{show:!0,inverse:!0,data:multi_obj.data0,axisLabel:{color:"#C5DCFF",textStyle:{fontSize:14}},axisLine:{show:!1},axisTick:{show:!1}}],xAxis:[{axisLabel:{show:!1},axisLine:{show:!1},axisTick:{show:!1},splitLine:{show:!1}}],series:[{type:"bar",name:"全屋定制类",data:multi_obj.data2[0],barWidth:"10px",stack:"投诉情况",label:{show:!1,position:"right",color:"#FFFFFF",fontSize:15,offset:[5,0]},itemStyle:{normal:{color:new echarts.graphic.LinearGradient(1,0,0,0,[{offset:0,color:"#065ADA"},{offset:1,color:"#22CFF5"}],!1)}},z:50},{type:"bar",name:"木门类",data:multi_obj.data2[1],barWidth:"10px",stack:"投诉情况",label:{show:!1,position:"right",color:"#FFFFFF",fontSize:15,offset:[5,0]},itemStyle:{normal:{color:new echarts.graphic.LinearGradient(0,0,1,0,[{offset:0,color:"#2CFFBA"},{offset:1,color:"#1B856D"}],!1)}},z:40},{type:"bar",name:"橱柜类",data:multi_obj.data2[2],barWidth:"10px",stack:"投诉情况",label:{show:!1,position:"right",color:"#FFFFFF",fontSize:15,offset:[5,0]},itemStyle:{normal:{color:new echarts.graphic.LinearGradient(0,0,1,0,[{offset:0,color:"#FF7E7C"},{offset:1,color:"#FF6061"}],!1)}},z:30}]};var series=option.series,fun=function(e){for(var s=0,r=0,l=0;l<series.length;l++)s+=series[l].data[e.dataIndex],r+=getvalue[l]+getvalue1[l]+getvalue2[l];return s+"次 "+(s/r*100).toFixed(2)+"%"};series[series.length-1]&&(series[series.length-1].label.show=!0,series[series.length-1].label.formatter=fun),myChart.on("legendselectchanged",function(e){let s=e.selected.全屋定制类,r=e.selected.木门类,l=e.selected.橱柜类,a=this.getOption();a.yAxis[0].data=[],a.series[0].data=[],a.series[1].data=[],a.series[2].data=[];let t={data0:getname,data1:[],data2:[getvalue,getvalue1,getvalue2]};s&&t.data1.push(getvalue),r&&t.data1.push(getvalue1),l&&t.data1.push(getvalue2);let n=multi_bubbleSort(t);a.yAxis[0].data=n.data0,a.series[0].data=n.data2[0],a.series[1].data=n.data2[1],a.series[2].data=n.data2[2];var f=e.selected,o=[];for(var h in f)if(f[h])for(var c=0;c<series.length;c++){var v=series[c].name;v==h&&o.push(c)}for(var F=function(m){for(var b=0,p=0,i=0;i<o.length;i++)for(var g=0;g<series.length;g++)o[i]==g&&(b+=series[g].data[m.dataIndex],p+=getvalue[i]+getvalue1[i]+getvalue2[i]);return b+"次 "+(b/p*100).toFixed(2)+"%"},u=0;u<series.length;u++)series[u].label.show=!1;var d=series[o[o.length-1]];d!=null&&d!=""&&d!=null&&(d.label.show=!0,d.label.formatter=F),myChart.setOption(option)});

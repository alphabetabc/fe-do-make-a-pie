var getname=["a","b","c","d"],getvaluenum=[92,45,22,48,16,48,51,25,14,45,48,98,78,85,65,100,40,90,205,208],getxlmc=["语文","数学","英语","物理","化学"],getxlmcnum=getvaluenum.length/getname.length,getvalue=[];for(let e=0;e<getxlmcnum;e++){getvalue[e]=[];for(let t=0;t<getname.length;t++)getvalue[e][t]=Number(getvaluenum[e*getname.length+t])}for(var color1=["#63B4FF","#FFD19A","#64F0BC","#BDBCFF","#FFA387","#63B4FF","#FFD19A","#64F0BC","#BDBCFF","#FFA387"],color2=["#1890FF","#FFD283","#47D095","#9C9BFF","#FF6388","#1890FF","#FFD283","#47D095","#9C9BFF","#FF6388"],getvaluesum=[],i=0;i<getname.length;i++){getvaluesum[i]=0;for(var j=0;j<getxlmcnum;j++)getvaluesum[i]+=getvalue[j][i]}var tempSumArr=[...getvaluesum].sort((e,t)=>t-e),indexList=[];tempSumArr.map(e=>{let t=getvaluesum.indexOf(e);for(;indexList.indexOf(t)>-1;)t=getvaluesum.indexOf(e,t+1);indexList.push(t)});var newSortXName=[],newSortYValue=[];indexList.map(e=>{newSortXName.push(getname[e])}),getvalue.map((e,t)=>{newSortYValue[t]=[],indexList.map(a=>{newSortYValue[t].push(e[a])})});var maxnum=Math.max.apply(null,getvaluesum),maxlen=Math.pow(10,String(Math.ceil(maxnum)).length-2);if(maxnum>=5)var max=Math.ceil(maxnum/(.95*maxlen))*maxlen;else var max=5;for(var series=[],i=0;i<getxlmc.length;i++)series.push({name:getxlmc[i],type:"bar",data:newSortYValue[i],stack:"各专业本科生年级分布",barWidth:"20px",itemStyle:{normal:{color:{x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:color1[i]},{offset:1,color:color2[i]}]},barBorderRadius:[0,0,0,0],label:{show:!1,position:"top",textStyle:{fontSize:12,color:"#666666"}}}}});optiondqt={grid:{top:"33",right:"15",left:"50",bottom:"55"},tooltip:{trigger:"axis",axisPointer:{type:"none"},backgroundColor:"rgba(21, 64, 92, 0.9)",formatter:function(e){var t="";t+="<div>"+e[0].name+"</div>";for(var a=0;a<getxlmcnum;a++)e[a]&&e[a].value>0&&(t+='<span style="color:rgba(0, 255, 252, 1);font:16px bold;">'+e[a].seriesName+'</span>本科生人数&nbsp;&nbsp;<span style="color:rgba(0, 255, 252, 1);">'+e[a].value+"人</span></br>");return t}},legend:{type:"scroll",right:"10",top:"0",data:getxlmc,itemGap:25,itemWidth:16,itemHeight:16,textStyle:{fontSize:"13",color:"#666666"}},xAxis:[{data:newSortXName,axisLabel:{interval:0,formatter:function(e){var t="",a=6,s=e.length,l=Math.ceil(s/a);if(l>1){for(var n=0;n<l;n++){var f="",o=n*a,r=o+a;f=e.substring(o,r)+`
`,t+=f}return t}else return e},margin:10,color:"#666666",textStyle:{fontSize:13,fontWeight:400}},axisLine:{lineStyle:{color:"#B0C5DB"}},axisTick:{show:!1}}],yAxis:[{min:0,max,interval:max/5,splitNumber:5,name:"人",nameTextStyle:{color:"#999999",fontSize:13,padding:[0,0,0,-40]},axisLabel:{color:"#666666",textStyle:{fontSize:13}},axisLine:{show:!1},axisTick:{show:!1},splitLine:{lineStyle:{color:"#CCDBEB",type:"dashed",opacity:.5}}}],series};var series=optiondqt.series,fun=function(e){for(var t=0,a=0;a<series.length;a++)t+=series[a].data[e.dataIndex];return t};return series[series.length-1]&&(series[series.length-1].itemStyle.normal.label.show=!0,series[series.length-1].itemStyle.normal.label.formatter=fun,series[series.length-1].itemStyle.normal.barBorderRadius=[3,3,0,0]),myChart.on("legendselectchanged",function(e){var t=e.selected,a=[];for(var s in t)if(t[s])for(var l=0;l<series.length;l++){var n=series[l].name;n==s&&a.push(l)}for(var f=function(d){for(var h=0,m=0;m<a.length;m++)for(var v=0;v<series.length;v++)a[m]==v&&(h+=series[v].data[d.dataIndex]);return h},o=0;o<series.length;o++)series[o].itemStyle.normal.label.show=!1,series[o].itemStyle.normal.barBorderRadius=[0,0,0,0];var r=series[a[a.length-1]];r!=null&&r!=""&&r!=null&&(r.itemStyle.normal.label.show=!0,r.itemStyle.normal.label.formatter=f,r.itemStyle.normal.barBorderRadius=[3,3,0,0]),myChart.setOption(optiondqt)}),optiondqt;

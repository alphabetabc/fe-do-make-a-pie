var titleStyle={fontSize:14},subjectsData={yearMonth:"2018年1-7月",xData:["指标1","指标2","指标3","指标4","指标5","指标6","指标7","指标8","指标9","指标10","指标11","指标12","指标13","指标14","指标15","指标16"],yData:[74756,-5424,-19416,2558,615,7997,-15708,-29782,2848,-7974,-5777,-7055,-4145,13120,6490,4571]},myJson=[],updata=[],downdata=[],auxdata=[],auxdataDown=[],auxdataUp=[];formatStackData(subjectsData,myJson,updata,downdata,auxdata,auxdataDown,auxdataUp),option={title:{text:subjectsData.yearMonth+"财务费用",left:"center",textStyle:titleStyle},toolbox:{feature:{saveAsImage:{show:!0}}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(a){var s,o;a[3].value!="-"?s=a[3]:s=a[4];for(var t,r=0;r<myJson.length;r++)s.name===myJson[r].xData&&(t=Math.abs(s.value)+Math.abs(myJson[r].auxdataDown)+Math.abs(myJson[r].auxdataUp));return s.name+"<br/>"+s.seriesName+" : "+t}},legend:{data:["收入","支出"],selectedMode:!1,left:10,top:18},grid:{left:"1%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",splitLine:{show:!1},axisLabel:{rotate:40},data:subjectsData.xData},yAxis:{type:"value",splitLine:{show:!1}},series:[{name:"辅助",type:"bar",stack:"总量",itemStyle:{normal:{color:"rgba(0,0,0,0)"},emphasis:{show:!1}},data:auxdata},{name:"支出辅助",type:"bar",stack:"总量",itemStyle:{normal:{color:"#FF0033"},emphasis:{show:!1}},data:auxdataDown},{name:"收入辅助",type:"bar",stack:"总量",itemStyle:{normal:{color:"#33CC33"},emphasis:{show:!1}},data:auxdataUp},{name:"收入",type:"bar",stack:"总量",itemStyle:{normal:{color:"#33CC33"}},label:{normal:{show:!0,position:"top",formatter:function(a){return formatNormal(a,myJson)}}},data:updata},{name:"支出",type:"bar",stack:"总量",itemStyle:{normal:{color:"#FF0033"}},label:{normal:{show:!0,position:"bottom",formatter:function(a){return formatNormal(a,myJson)}}},data:downdata}]};function formatStackData(a,s,o,t,r,p,u){for(var l=a.yData,f=a.xData,h=0,e=0;e<l.length;e++){var n=h+l[e];n>0?l[e]>0?(h<0?(o.push(n),u.push(h),p.push(0),r.push(0)):(o.push(l[e]),u.push(0),p.push(0),r.push(h)),t.push("-")):(r.push(n),o.push("-"),t.push(Math.abs(l[e])),p.push(0),u.push(0)):l[e]>0?(r.push(n),o.push(-l[e]),t.push("-"),p.push(0),u.push(0)):(o.push("-"),h>0?(t.push(n),p.push(h),u.push(0),r.push(0)):(t.push(l[e]),p.push(0),u.push(0),r.push(h))),h=h+l[e];var m={xData:f[e],auxdata:r[e],auxdataUp:u[e],auxdataDown:p[e],updata:o[e],downdata:t[e]};s.push(m)}}function formatNormal(a,s){for(var o,t=0;t<s.length;t++)a.name===s[t].xData&&(o=Math.abs(a.value)+Math.abs(s[t].auxdataDown)+Math.abs(s[t].auxdataUp));return o}

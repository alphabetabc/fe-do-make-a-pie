for(var phaseParent=[{name:"方案制定阶段",color:"#3b1a40",order:1,children:[{name:"收到业务需求",order:1},{name:"需求评审",order:2},{name:"提交建设方案",order:3}]},{name:"立项阶段",color:"#463793",order:2,children:[{name:"建设方案评审",order:4},{name:"立项决策会",order:5},{name:"可研评审",order:6},{name:"可研批复",order:7}]},{name:"采购准备阶段",color:"#3c6df0",order:3,children:[{name:"采购材料编制提交",order:8},{name:"采购材料评审",order:9},{name:"采购预申请",order:10},{name:"采购正式申请",order:11}]},{name:"采购发生阶段",color:"#ffab18",order:4,children:[{name:"采购方案决策",order:12},{name:"采购结果公布",order:13},{name:"合同签订",order:14}]},{name:"设计阶段",color:"#9dff6b",order:5,children:[{name:"设计批复",order:15}]},{name:"工程实施阶段",color:"#7ed2c6",order:6,children:[{name:"项目开工",order:16},{name:"设备到货",order:17},{name:"设备安装",order:18},{name:"需求分析",order:19},{name:"系统设计",order:20},{name:"开发阶段",order:21},{name:"集成测试",order:22},{name:"验收测试",order:23},{name:"割接上线",order:24},{name:"试运行",order:25},{name:"竣工验收",order:26}]}],allSubPhase=[],i=0;i<phaseParent.length;i++)for(var children=phaseParent[i].children,j=0;j<children.length;j++){var child=children[j];child.color=phaseParent[i].color,allSubPhase.push(child)}var all_phase_cnt=allSubPhase.length,projectPhase=[["收到业务需求","ERP集中化项目"],["需求评审","430项目"],["建设方案评审","可视化大屏项目"],["立项决策会","资产管理系统扩容改造项目"],["项目开工","大数据架构升级项目"],["收到业务需求","ERP集中化项目1"],["需求评审","430项目2"],["建设方案评审","可视化大屏项目3"],["立项决策会","资产管理系统扩容改造项目4"],["合同签订","大数据架构升级项目5"],["收到业务需求","ERP集中化项目7"],["需求评审","430项目7"]],yData=projectPhase.map(e=>e[1]);function getBarData(e){for(var r=[],a=0;a<e.length;a++)for(var t=e[a],o=0;o<allSubPhase.length;o++)if(t[0]===allSubPhase[o].name){r.push([allSubPhase[o].order,t[1]]);break}return r}function toPercent(e){return(e*100).toFixed(4)+"%"}for(var option={title:{text:""},tooltip:{show:!0,formatter:function(e){if(e.seriesIndex>0)return null;const r=e.data[0];return e.data[1]+"："+allSubPhase.find(a=>r===a.order).name}},grid:[{top:100,bottom:101},{height:50,top:0},{height:50,top:50},{top:100,bottom:101}],xAxis:[{type:"value",position:"top",min:0,max:26,gridIndex:0,axisLabel:{show:!1},axisLine:{show:!1},splitLine:{show:!1},axisTick:{show:!1}},{type:"category",position:"top",gridIndex:1,axisLine:{show:!1},zlevel:1},{type:"category",position:"top",gridIndex:2,axisLine:{show:!1},zlevel:2},{type:"category",position:"bottom",gridIndex:3,data:allSubPhase.map(e=>e.name),zlevel:0,axisLabel:{show:!1},axisLine:{show:!1},splitLine:{show:!0,interval:0,lineStyle:{type:"dotted"}},axisTick:{show:!1}}],yAxis:[{type:"category",gridIndex:0,data:yData,axisLine:{show:!1},axisTick:{show:!1}},{type:"value",gridIndex:1,axisLabel:{show:!1},axisLine:{show:!1},splitLine:{show:!1},axisTick:{show:!1}},{type:"value",gridIndex:2,axisLabel:{show:!1},axisLine:{show:!1},splitLine:{show:!1},axisTick:{show:!1}},{type:"value",gridIndex:3,axisLabel:{show:!1},axisLine:{show:!1},splitLine:{show:!1},axisTick:{show:!1}}],series:[{type:"bar",data:getBarData(projectPhase),xAxisIndex:0,yAxisIndex:0,itemStyle:{normal:{color:e=>["#4150d8","#28bf7e","#ed7c2f","#f2a93b","#f9cf36","#4a5bdc","#4cd698","#f4914e","#fcb75b","#ffe180","#b6c2ff","#96edc1"][e.dataIndex]}}}]},i=0;i<phaseParent.length;i++)option.series.push({data:[{name:phaseParent[i].name,value:1}],label:{show:!0,position:"inside",formatter:"{b}",textStyle:{color:"#fff",fontWeight:"bold"}},type:"bar",barGap:0,barWidth:toPercent(phaseParent[i].children.length/all_phase_cnt),itemStyle:{color:phaseParent[i].color,borderColor:"#efefef",borderWidth:1},xAxisIndex:1,yAxisIndex:1});for(var i=0;i<allSubPhase.length;i++){var curPhase=allSubPhase[i],phaseName=curPhase.name,halfLen=phaseName.length/2,showName=phaseName.substr(0,halfLen)+`
`+phaseName.substr(halfLen);option.series.push({data:[{name:showName,value:1}],label:{show:!0,position:"inside",formatter:"{b}",textStyle:{fontSize:10,lineHeight:12,color:"#fff"}},type:"bar",barGap:0,barWidth:toPercent(1/all_phase_cnt),itemStyle:{color:curPhase.color,borderColor:"#efefef",borderWidth:1},xAxisIndex:2,yAxisIndex:2})}

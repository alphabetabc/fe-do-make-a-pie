srcData=[["a1","b1","c1",1],["a1","b1","c2",1],["a1","b1","c3",1],["a1","b2","c1",1],["a1","b2","c2",1],["a1","b2","c3",1],["a1","b3","c1",1],["a1","b3","c2",1],["a1","b3","c3",1],["a2","b1","c1",2],["a2","b1","c2",2],["a2","b1","c3",2],["a2","b2","c1",2],["a2","b2","c2",2],["a2","b2","c3",2],["a2","b3","c1",2],["a2","b3","c2",2],["a2","b3","c3",2],["a3","b1","c1",3],["a3","b1","c2",3],["a3","b1","c3",3],["a3","b2","c1",3],["a3","b2","c2",3],["a3","b2","c3",3],["a3","b3","c1",3],["a3","b3","c2",3],["a3","b3","c3",3]];var ecCalc=new Object({});ecCalc.groupCalc=function(e,f,r,t){var b=f?1:0,l=[],a={};if(f){l[0]=[];for(let o in r)l[0].push(e[0][r[o]]);for(let o in t)l[0].push(e[0][t[o].id])}for(let o=b;o<e.length;o++){var h=[];for(let n in r)h.push(e[o][r[n]]);var c=JSON.stringify(h);if(a.hasOwnProperty(c)){for(let n in t)t[n].method==="sum"||t[n].method==="avg"?a[c][n]+=e[o][t[n].id]:t[n].method==="count"&&(a[c][n]+=1);a[c][t.length]+=1}else{a[c]=[];for(let n in t)t[n].method==="sum"||t[n].method==="avg"?a[c][n]=e[o][t[n].id]:t[n].method==="count"&&(a[c][n]=1);a[c][t.length]=1}}for(var d in a){tmp=JSON.parse(d);for(let o in t)t[o].method==="sum"||t[o].method==="count"?tmp.push(a[d][o]):t[o].method==="avg"&&tmp.push(a[d][o]/a[d][t.length]);l.push(tmp)}return l},ecCalc.filter=function(source,hasColumnName,filterCondition){var iBegin=hasColumnName?1:0,res=hasColumnName?[source[0]]:[];if(typeof filterCondition=="function")for(let e=iBegin;e<source.length;e++)filterCondition(source[e])&&res.push(source[e]);else if(typeof filterCondition=="string")for(let i=iBegin;i<source.length;i++){var item=source[i];eval(filterCondition)&&res.push(source[i])}return res},convertConfig=[{dimensions:[0],methods:[{id:3,method:"sum"}],filter:"true"},{dimensions:[1],methods:[{id:3,method:"sum"}],filter:"true"},{dimensions:[2],methods:[{id:3,method:"sum"}],filter:"true"}];function dataConvert(e){let f=[];for(let r of convertConfig){let t=ecCalc.filter(srcData,!1,r.filter);f.push(ecCalc.groupCalc(t,!1,r.dimensions,r.methods))}return f}convertedData=dataConvert(convertConfig),option={title:{text:"受到宿爽大神视频分享中 Message Center 的启发，图表联动的交叉实现"},tooltip:{},grid:[{bottom:"55%"},{top:"55%",right:"55%"}],xAxis:[{type:"category"},{type:"category",gridIndex:1}],yAxis:[{},{gridIndex:1}],series:[{id:"line",type:"line",label:{show:!0,formatter:`{a}
{b}:{@1}`},name:convertConfig[0].filter,data:convertedData[0]},{id:"bar",type:"bar",xAxisIndex:1,yAxisIndex:1,label:{show:!0,formatter:`{a}
{b}:{@1}`},name:convertConfig[1].filter,data:convertedData[1]},{id:"pie",type:"pie",center:["75%","75%"],radius:"25%",label:{show:!0,formatter:`{a}
{b}:{c}`},name:convertConfig[2].filter,data:convertedData[2].map(function(e){return{name:e[0],value:e[1]}})}]},actionConfig=[{to:[1,2]},{to:[0,2]},{to:[0,1]}],myChart.on("click",function(e){let f=actionConfig[e.seriesIndex].to;for(let r of f)convertConfig[r].filter=convertConfig[e.seriesIndex].filter+" && item["+e.seriesIndex+'] == "'+e.name+'"';convertedData=dataConvert(convertConfig),myChart.setOption({series:[{id:"line",name:convertConfig[0].filter,data:convertedData[0]},{id:"bar",name:convertConfig[1].filter,data:convertedData[1]},{id:"pie",name:convertConfig[2].filter,data:convertedData[2].map(function(r){return{name:r[0],value:r[1]}})}]})});

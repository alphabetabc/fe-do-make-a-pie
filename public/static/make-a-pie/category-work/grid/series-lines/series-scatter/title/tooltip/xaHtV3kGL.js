function resizeChart(){var l=$("body").width(),n=$("body").height();myChart.resize({width:l,height:n}),option.series=getSeries(),myChart.setOption(option,!0)}var data=[{name:"节点1",code:"node1",value:{interfaceNum:0,kpiNum:0,alarmNum:0},x:.1,y:.65},{name:"节点2",code:"node2",value:{interfaceNum:0,kpiNum:0,alarmNum:0},x:.3,y:.8},{name:"节点3",code:"node3",value:{interfaceNum:0,kpiNum:0,alarmNum:0},x:.3,y:.5},{name:"节点4",code:"node4",value:{interfaceNum:0,kpiNum:0,alarmNum:0},x:.5,y:.5}],links=[{source:"node1",target:"node2"},{source:"node1",target:"node3"},{source:"node3",target:"node4"}],line=3,column=4;function getScatterData(){for(var l=[],n=myChart.getWidth(),a=myChart.getHeight(),e=n/(column*2),t=a/(line*2),o=0;o<data.length;o++)l.push({name:data[o].name,value:[data[o].x,(data[o].y*a+3/8*t)/a],type:"title",w:e,h:t/4,label:{normal:{textStyle:{color:"#fff",fontWeight:"bold",fontSize:15}}}},{code:data[o].code,value:[data[o].x,(data[o].y*a+1/4*t-3/4*t/2)/a],type:"body",w:e,h:3/4*t,info:data[o].value,label:{normal:{textStyle:{color:"#000"}}}});return l}function getLinesData(){for(var l=[],n={},a=0;a<data.length;a++)n[data[a].code]=data[a];for(var a=0;a<links.length;a++){var e=n[links[a].source],t=n[links[a].target],o=myChart.getWidth(),i=myChart.getHeight(),r=o/(column*2),y=i/(line*2);e.top={x:e.x,y:(e.y*i+1/2*y)/i},e.right={x:(e.x*o+1/2*r)/o,y:e.y},e.bottom={x:e.x,y:(e.y*i-1/2*y)/i},e.left={x:(e.x*o-1/2*r)/o,y:e.y},t.top={x:t.x,y:(t.y*i+1/2*y)/i},t.right={x:(t.x*o+1/2*r)/o,y:t.y},t.bottom={x:t.x,y:(t.y*i-1/2*y)/i},t.left={x:(t.x*o-1/2*r)/o,y:t.y},e.right.x<t.left.x?l.push(getLine([[e.right.x,e.right.y],[t.left.x,t.left.y]])):e.left.x>t.right.x?l.push(getLine([[e.left.x,e.left.y],[t.right.x,t.right.y]])):e.bottom.y>t.top.y?l.push(getLine([[e.bottom.x,e.bottom.y],[t.top.x,t.top.y]])):e.top.y<t.bottom.y&&l.push(getLine([[e.top.x,e.top.y],[t.bottom.x,t.bottom.y]]))}return l}function getLine(l){return{name:"",type:"lines",coordinateSystem:"cartesian2d",symbol:["none","arrow"],symbolSize:10,zlevel:4,effect:{show:!0,period:6,trailLength:.7,color:"#7480BC",symbolSize:3},lineStyle:{normal:{color:"#9EADD6",width:1,curveness:0}},data:[{coords:l}]}}function getSeries(){var l=[];return l.push({type:"scatter",symbol:"rect",zlevel:2,silent:!0,symbolSize:function(n,a){return[a.data.w,a.data.h]},itemStyle:{normal:{shadowBlur:10,shadowColor:"rgba(120, 36, 50, 0.5)",shadowOffsetY:5,color:function(n){return n.data.type=="title"?"#007CB8":"#6DC6F2"}}},label:{normal:{show:!0,position:"inside",formatter:function(n){return n.data.type=="title"?n.data.name:"核心接口数量："+n.data.info.interfaceNum+`
监测指标数量：`+n.data.info.kpiNum+`
告警数量`+n.data.info.alarmNum},textStyle:{color:"#000"}}},data:getScatterData()}),l.concat(getLinesData())}option=null,option={backgroundColor:"#F3F3F3",title:[{text:"流程图",x:"5%",y:0,textStyle:{color:"#333",fontStyle:"normal",fontWeight:"normal",fontFamily:"sans-serif",fontSize:14}}],tooltip:{},grid:{left:0,right:0,top:0,bottom:0},xAxis:{type:"value",splitLine:{show:!1},axisLabel:{show:!1},max:1,min:0},yAxis:{type:"value",splitLine:{show:!1},axisLabel:{show:!1},max:1,min:0},series:getSeries()};

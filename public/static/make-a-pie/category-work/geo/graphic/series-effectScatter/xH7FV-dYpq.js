var shanghai="https://geo.datav.aliyun.com/areas_v2/bound/310000_full.json",minhang="310112",baoshan="310113",jiading="310114",pudongxin="310115",jinshan="310116",songjiang="310117",qingpu="310118",fengxian="310120",chongming="310151";echarts.extendsMap=function(d,r){var o=this.init(document.getElementById(d)),u={},h={闵行区:minhang,宝山区:baoshan,嘉定区:jiading,浦东新区:pudongxin,金山区:jinshan,松江区:songjiang,青浦区:qingpu,奉贤区:fengxian,崇明区:chongming},x={崇明区:[121.39,31.62],嘉定区:[121.26,31.37],萍乡区:[121.3,31.13],宝山区:[121.48,31.4],奉贤区:[121.47,30.91]},b={1:"rgba(241, 109, 115, .8)",2:"rgba(255, 235, 59, .7)",3:"rgba(147, 235, 248, 1)"},C={mapName:"china",goDown:!1,bgColor:"#404a59",activeArea:[],data:[],callback:function(e,t,a){}};r&&(r=this.util.extend(C,r));var f=[r.mapName],g=0,l={leftPlus:15,leftCur:120,left:58,top:50},y=[[0,0],[8,11],[0,22]],c={font:'18px "Microsoft YaHei", sans-serif',textColor:"#eee",lineColor:"rgba(147, 235, 248, .8)"},i={resetOption:function(e,t,a){var n=this.createBreadcrumb(a),p=f.indexOf(a),m=t.graphic.length;if(p<0){if(t.graphic.push(n),t.graphic[0].children[0].shape.x2=180,t.graphic[0].children[1].shape.x2=180,t.graphic.length>2)for(var v=0;v<r.data.length;v++)if(a===r.data[v].name+"市"){t.series[0].data=i.initSeriesData([r.data[v]]);break}else t.series[0].data=[];f.push(a),g++}else t.graphic.splice(p+2,m),t.graphic.length<=2&&(t.graphic[0].children[0].shape.x2=70,t.graphic[0].children[1].shape.x2=70,t.series[0].data=i.initSeriesData(r.data)),f.splice(p+1,m),g=p,l.leftCur-=l.leftPlus*(m-p-1);t.geo.map=a,t.geo.zoom=.4,e.clear(),e.setOption(t),this.zoomAnimation(),r.callback(a,t,e)},createBreadcrumb:function(e){var t={闵行区:"minhang",宝山区:"baoshan",嘉定区:"jiading",浦东新区:"pudongxin",金山区:"jinshan",松江区:"songjiang",青浦区:"qingpu",奉贤区:"fengxian",崇明区:"chongming"},a={type:"group",id:e,left:l.leftCur+l.leftPlus,top:l.top+3,children:[{type:"polyline",left:-90,top:-5,shape:{points:y},style:{stroke:"#fff",key:e},onclick:function(){var n=this.style.key;i.resetOption(o,s,n)}},{type:"text",left:-68,top:"middle",style:{text:e,textAlign:"center",fill:c.textColor,font:c.font},onclick:function(){var n=this.style.text;i.resetOption(o,s,n)}},{type:"text",left:-68,top:10,style:{name:e,text:t[e]?t[e].toUpperCase():"",textAlign:"center",fill:c.textColor,font:'12px "Microsoft YaHei", sans-serif'},onclick:function(){var n=this.style.name;i.resetOption(o,s,n)}}]};return l.leftCur+=l.leftPlus,a},initSeriesData:function(e){for(var t=[],a=0;a<e.length;a++){var n=x[e[a].name];n&&t.push({name:e[a].name,value:n.concat(e[a].value,e[a].level)})}return console.log(t),t},zoomAnimation:function(){var e=null,t=function(a){e||(e=a),e=e+a,o.setOption({geo:{zoom:e}}),e<1&&window.requestAnimationFrame(function(){t(.2)})};window.requestAnimationFrame(function(){t(.2)})}},s={backgroundColor:r.bgColor,graphic:[{type:"group",left:l.left,top:l.top-4,children:[{type:"line",left:0,top:-20,shape:{x1:0,y1:0,x2:70,y2:0},style:{stroke:c.lineColor}},{type:"line",left:0,top:20,shape:{x1:0,y1:0,x2:70,y2:0},style:{stroke:c.lineColor}}]},{id:f[g],type:"group",left:l.left+2,top:l.top,children:[{type:"polyline",left:90,top:-12,shape:{points:y},style:{stroke:"transparent",key:f[0]},onclick:function(){var e=this.style.key;i.resetOption(o,s,e)}},{type:"text",left:0,top:"middle",style:{text:f[0]==="上海市"?"上海市":f[0],textAlign:"center",fill:c.textColor,font:c.font},onclick:function(){i.resetOption(o,s,"上海市")}},{type:"text",left:0,top:10,style:{text:"SHANGHAI",textAlign:"center",fill:c.textColor,font:'12px "Microsoft YaHei", sans-serif'},onclick:function(){i.resetOption(o,s,"上海市")}}]}],geo:{map:r.mapName,roam:!0,zoom:1,label:{normal:{show:!0,textStyle:{color:"#fff"}},emphasis:{textStyle:{color:"#fff"}}},itemStyle:{normal:{borderColor:"rgba(147, 235, 248, 1)",borderWidth:1,areaColor:{type:"radial",x:.5,y:.5,r:.8,colorStops:[{offset:0,color:"rgba(147, 235, 248, 0)"},{offset:1,color:"rgba(147, 235, 248, .2)"}],globalCoord:!1},shadowColor:"rgba(128, 217, 248, 1)",shadowOffsetX:-2,shadowOffsetY:2,shadowBlur:10},emphasis:{areaColor:"#389BB7",borderWidth:0}},regions:r.activeArea.map(function(e){return typeof e!="string"?{name:e.name,itemStyle:{normal:{areaColor:e.areaColor||"#389BB7"}},label:{normal:{show:e.showLabel,textStyle:{color:"#fff"}}}}:{name:e,itemStyle:{normal:{borderColor:"#91e6ff",areaColor:"#389BB7"}}}})},series:[{type:"effectScatter",coordinateSystem:"geo",showEffectOn:"render",rippleEffect:{period:15,scale:6,brushType:"fill"},hoverAnimation:!0,itemStyle:{normal:{color:function(e){return b[e.value[3]]},shadowBlur:10,shadowColor:"#333"}},data:i.initSeriesData(r.data)}]};return o.setOption(s),o.on("click",function(e){var t=this;if(r.goDown&&e.name!==f[g]&&h[e.name]){var a=h[e.name];a="https://geo.datav.aliyun.com/areas_v2/bound/"+a+".json",$.get(a,function(n){u=n,echarts.registerMap(e.name,n),i.resetOption(t,s,e.name)})}}),o.setMap=function(e){var t=this;e.indexOf("市")<0&&(e=e+"市");var a=h[e];if(a){var n="./map/"+a+".json";$.get(n,function(p){u=p,echarts.registerMap(e,p),i.resetOption(t,s,e)})}},o},$.getJSON(shanghai,function(d){echarts.registerMap("上海市",d);var r=echarts.extendsMap("chart-panel",{bgColor:"#154e90",mapName:"上海市",goDown:!0,callback:function(o,u,h){console.log(o,u,h)},data:[{name:"崇明区",value:10,level:1},{name:"嘉定区",value:12,level:2},{name:"萍乡区",value:11,level:3},{name:"宝山区",value:16,level:2},{name:"奉贤区",value:12,level:1}]})});

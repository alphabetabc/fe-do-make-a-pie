$('<div class="back">返 回</div>').appendTo($("#chart-panel")),$(".back").css({position:"absolute",left:"25px",top:"25px",color:"rgb(179, 239, 255)","font-size":"16px",cursor:"pointer","z-index":"100"}),$(".back").click(function(){parentInfo.length!==1&&(myChart.showLoading(),parentInfo.pop(),getGeoJson(parentInfo[parentInfo.length-1].code))});var geoJson={features:[]},parentInfo=[{cityName:"全国",level:"china",code:1e5}],timeTitle=["10.1","10.2","10.3","10.4","10.5","10.6","10.7","10.8"];getGeoJson(1e5);function getGeoJson(a){AMapUI.loadUI(["geo/DistrictExplorer"],t=>{var i=new t;i.loadAreaNode(a,function(n,r){if(n){e:;console.error(n);return}let l=r.getSubFeatures();if(l.length>0)geoJson.features=l;else if(l.length===0&&(geoJson.features=geoJson.features.filter(c=>c.properties.adcode==a),geoJson.features.length===0))return;getMapData()})})}function getMapData(){const a=[{name:"青海省",value:2983.3048524592427,level:"province",cityCode:63e4},{name:"吉林省",value:2959.2463688315747,level:"province",cityCode:22e4},{name:"黑龙江省",value:2959.178718812589,level:"province",cityCode:23e4},{name:"贵州省",value:2858.6789806023394,level:"province",cityCode:52e4},{name:"上海市",value:2843.096833606342,level:"province",cityCode:31e4},{name:"江西省",value:2751.6483389204977,level:"province",cityCode:36e4},{name:"山东省",value:2718.7679846534443,level:"province",cityCode:37e4},{name:"湖南省",value:2532.564233676725,level:"province",cityCode:43e4},{name:"安徽省",value:2409.668140637018,level:"province",cityCode:34e4},{name:"北京市",value:2255.462183846231,level:"province",cityCode:11e4},{name:"海南省",value:2173.1543156242155,level:"province",cityCode:46e4},{name:"浙江省",value:2097.5994824633253,level:"province",cityCode:33e4},{name:"天津市",value:1580.3501393263246,level:"province",cityCode:12e4},{name:"新疆维吾尔自治区",value:1554.4750533682477,level:"province",cityCode:65e4},{name:"西藏自治区",value:1551.4412913554345,level:"province",cityCode:54e4},{name:"辽宁省",value:1274.1176670000025,level:"province",cityCode:21e4},{name:"台湾省",value:1238.0339612705866,level:"province",cityCode:71e4},{name:"湖北省",value:1096.4835151753957,level:"province",cityCode:42e4},{name:"山西省",value:1091.9852147176646,level:"province",cityCode:14e4},{name:"广东省",value:1080.453819241357,level:"province",cityCode:44e4},{name:"河南省",value:1037.9121531812843,level:"province",cityCode:41e4},{name:"福建省",value:880.5542725330653,level:"province",cityCode:35e4},{name:"四川省",value:680.1758456201347,level:"province",cityCode:51e4},{name:"云南省",value:577.1151680087661,level:"province",cityCode:53e4},{name:"宁夏回族自治区",value:564.3971876251948,level:"province",cityCode:64e4},{name:"甘肃省",value:439.0259400077368,level:"province",cityCode:62e4},{name:"河北省",value:419.7815882423199,level:"province",cityCode:13e4},{name:"陕西省",value:375.3413856375156,level:"province",cityCode:61e4},{name:"澳门特别行政区",value:155.79857787302132,level:"province",cityCode:82e4},{name:"内蒙古自治区",value:73.30315291206003,level:"province",cityCode:15e4},{name:"江苏省",value:50.730242810774094,level:"province",cityCode:32e4},{name:"香港特别行政区",value:34.46993969299128,level:"province",cityCode:81e4},{name:"广西壮族自治区",value:14.17476652327565,level:"province",cityCode:45e4},{name:"重庆市",value:.8685779809038952,level:"province",cityCode:5e5}],t=111111;initEchartMap(a,[{name:"北京市",value:[116.405285,39.904989,1286.2885765930978],cityCode:11e4},{name:"天津市",value:[117.190182,39.125596,1438.1524781957098],cityCode:12e4},{name:"河北省",value:[114.502461,38.045474,1616.412384315042],cityCode:13e4},{name:"山西省",value:[112.549248,37.857014,871.2879620328589],cityCode:14e4},{name:"内蒙古自治区",value:[111.670801,40.818311,2408.624788163257],cityCode:15e4},{name:"辽宁省",value:[123.429096,41.796767,2900.75270134033],cityCode:21e4},{name:"吉林省",value:[125.3245,43.886841,1437.095494033697],cityCode:22e4},{name:"黑龙江省",value:[126.642464,45.756967,2142.2714831906674],cityCode:23e4},{name:"上海市",value:[121.472644,31.231706,2690.8121695012296],cityCode:31e4},{name:"江苏省",value:[118.767413,32.041544,90.1037448387092],cityCode:32e4},{name:"浙江省",value:[120.153576,30.287459,2805.927176075527],cityCode:33e4},{name:"安徽省",value:[117.283042,31.86119,1033.9567749510265],cityCode:34e4},{name:"福建省",value:[119.306239,26.075302,2661.944864907178],cityCode:35e4},{name:"江西省",value:[115.892151,28.676493,1884.3595178046317],cityCode:36e4},{name:"山东省",value:[117.000923,36.675807,2354.2444264349806],cityCode:37e4},{name:"河南省",value:[113.665412,34.757975,2561.0729188262058],cityCode:41e4},{name:"湖北省",value:[114.298572,30.584355,2020.0464532115154],cityCode:42e4},{name:"湖南省",value:[112.982279,28.19409,393.0939464512297],cityCode:43e4},{name:"广东省",value:[113.280637,23.125178,2341.8961608335626],cityCode:44e4},{name:"广西壮族自治区",value:[108.320004,22.82402,1971.3160894719774],cityCode:45e4},{name:"海南省",value:[110.33119,20.031971,667.9173732191856],cityCode:46e4},{name:"重庆市",value:[106.504962,29.533155,424.91008227581204],cityCode:5e5},{name:"四川省",value:[104.065735,30.659462,488.9481808365865],cityCode:51e4},{name:"贵州省",value:[106.713478,26.578343,2410.221845388686],cityCode:52e4},{name:"云南省",value:[102.712251,25.040609,726.5999979582824],cityCode:53e4},{name:"西藏自治区",value:[91.132212,29.660361,2208.6740655369986],cityCode:54e4},{name:"陕西省",value:[108.948024,34.263161,1736.7350174435087],cityCode:61e4},{name:"甘肃省",value:[103.823557,36.058039,896.2127177839492],cityCode:62e4},{name:"青海省",value:[101.778916,36.623178,2729.7735894888438],cityCode:63e4},{name:"宁夏回族自治区",value:[106.278179,38.46637,1146.2827101631633],cityCode:64e4},{name:"新疆维吾尔自治区",value:[87.617733,43.792818,1204.9773707295383],cityCode:65e4},{name:"台湾省",value:[121.509062,25.044332,2016.1856418414018],cityCode:71e4},{name:"香港特别行政区",value:[114.173355,22.320048,1152.1638602322766],cityCode:81e4},{name:"澳门特别行政区",value:[113.54909,22.198951,16.545942804256477],cityCode:82e4}])}function initEchartMap(a,t){parentInfo.length===1?echarts.registerMap("china",geoJson):echarts.registerMap("map",geoJson);const i=[],n=[];var r=1,l=1e4;a.length===1&&(r=0),a.forEach(e=>{i.unshift(e.name),n.unshift(e.value)});var c={backgroundColor:"#012248",title:[{left:"center",top:10,text:parentInfo[parentInfo.length-1].cityName+"游客来源",textStyle:{color:"rgb(179, 239, 255)",fontSize:16}}],tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{right:"2%",top:"12%",bottom:"8%",width:"20%"},geo:{map:parentInfo.length===1?"china":"map",zoom:1.1,roam:!0,center:parentInfo.length===1?["118.83531246","32.0267395887"]:!1,tooltip:{trigger:"item",formatter:e=>{let o=e.value[2];return window.isNaN(o)&&(o=0),"<div style='text-align:left'>"+e.name+":<br />销售额："+o+"万</div>"}},label:{normal:{show:!0,color:"rgb(249, 249, 249)",formatter:e=>{switch(e.name){case"内蒙古自治区":e.name="内蒙古";break;case"西藏自治区":e.name="西藏";break;case"新疆维吾尔自治区":e.name="新疆";break;case"宁夏回族自治区":e.name="宁夏";break;case"广西壮族自治区":e.name="广西";break;case"香港特别行政区":e.name="香港";break;case"澳门特别行政区":e.name="澳门";break;default:break}return e.name}},emphasis:{show:!0,color:"#f75a00"}},itemStyle:{normal:{areaColor:"#24CFF4",borderColor:"#53D9FF",borderWidth:1.3,shadowBlur:15,shadowColor:"rgb(58,115,192)",shadowOffsetX:7,shadowOffsetY:6},emphasis:{areaColor:"#8dd7fc",borderWidth:1.6,shadowBlur:25}}},visualMap:{min:r,max:l,left:"3%",bottom:"5%",calculable:!0,seriesIndex:[0],inRange:{color:["#24CFF4","#2E98CA","#1E62AC"]},textStyle:{color:"#24CFF4"}},xAxis:{type:"value",scale:!0,position:"top",boundaryGap:!1,splitLine:{show:!1},axisLine:{show:!0,lineStyle:{color:"#455B77"}},axisTick:{show:!1},axisLabel:{margin:2,textStyle:{color:"#c0e6f9"}}},yAxis:{type:"category",nameGap:16,axisLine:{show:!0,lineStyle:{color:"#455B77"}},axisTick:{show:!1},axisLabel:{interval:0,textStyle:{color:"#c0e6f9"}},data:i},series:[{name:"游客来源",type:"map",geoIndex:0,map:parentInfo.length===1?"china":"map",roam:!0,zoom:1.3,tooltip:{trigger:"item",formatter:e=>{let o=e.value;return e.name=="南海诸岛"?void 0:(window.isNaN(o)&&(o=0),"<div style='text-align:left'>"+e.name+":"+o+"人</div>")}},label:{normal:{show:!1},emphasis:{show:!1}},data:a},{name:"散点",type:"effectScatter",coordinateSystem:"geo",rippleEffect:{brushType:"fill"},itemStyle:{normal:{color:"#F4E925",shadowBlur:10,shadowColor:"#333"}},symbolSize:function(e){return e[2]==l?27:10},showEffectOn:"render"},{type:"bar",barGap:"-100%",barCategoryGap:"60%",itemStyle:{normal:{color:"#11AAFE"},emphasis:{show:!1}},data:n}]};myChart.setOption(c,!0),myChart.hideLoading(),myChart.off("click"),myChart.on("click",echartsMapClick)}function echartsMapClick(a){if(a.data){if(parentInfo[parentInfo.length-1].code==a.data.cityCode)return;myChart.showLoading();let t=a.data;parentInfo.push({cityName:t.name,level:t.level,code:t.cityCode}),getGeoJson(t.cityCode)}else return}

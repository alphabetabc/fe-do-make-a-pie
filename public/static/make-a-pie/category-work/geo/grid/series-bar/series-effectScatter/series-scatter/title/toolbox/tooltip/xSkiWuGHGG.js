var geoCoordMap={北京:[116.46,39.92],上海:[121.48,31.22],杭州:[120.19,30.26],广州:[113.23,23.16],深圳:[114.07,22.62],南京:[118.78,32.04],苏州:[120.62,31.32],佛山:[113.11,23.05],宁波:[121.56,29.86],泉州:[118.37,24.54],青岛:[120.33,36.07],嘉兴:[120.75,30.75],厦门:[24.27,118.06],东莞:[113.75,23.04],武汉:[114.31,30.52],金华:[119.38,29.05],天津:[117.1,39.1],成都:[104.06,30.67],温州:[120.65,28.01],无锡:[120.29,31.59]},data=[{name:"北京",value:655.75},{name:"上海",value:389.34},{name:"杭州",value:209.02},{name:"广州",value:165.89},{name:"深圳",value:151.62},{name:"南京",value:110.22},{name:"苏州",value:103.11},{name:"佛山",value:74.16},{name:"宁波",value:64.76},{name:"泉州",value:38.86},{name:"青岛",value:36.32},{name:"嘉兴",value:34.54},{name:"厦门",value:31.49},{name:"东莞",value:31.24},{name:"武汉",value:29.46},{name:"金华",value:28.7},{name:"天津",value:25.4},{name:"成都",value:24.13},{name:"温州",value:24.13},{name:"无锡",value:21.08}],convertData=function(e){for(var t=[],a=0;a<e.length;a++){var o=geoCoordMap[e[a].name];o&&t.push({name:e[a].name,value:o.concat(e[a].value)})}return t},convertedData=[convertData(data),convertData(data.sort(function(e,t){return t.value-e.value}).slice(0,6))];data.sort(function(e,t){return e.value-t.value});for(var selectedItems=[],categoryData=[],barData=[],sum=0,count=data.length,i=0;i<data.length;i++)categoryData.push(data[i].name),barData.push(data[i].value),sum+=data[i].value;console.log(categoryData),console.log(sum+"   "+count),option={backgroundColor:"#404a59",animation:!0,animationDuration:1e3,animationEasing:"cubicInOut",animationDurationUpdate:1e3,animationEasingUpdate:"cubicInOut",title:[{text:"2017双十一交易额（亿元）",subtext:"数据来源：亿邦智库",left:"center",textStyle:{color:"#fff"}},{id:"statistic",text:count?"平均交易额: "+parseInt((sum/count).toFixed(4)):"",right:120,top:40,width:100,textStyle:{color:"#fff",fontSize:16}}],toolbox:{iconStyle:{normal:{borderColor:"#fff"},emphasis:{borderColor:"#fff"}},feature:{saveAsImage:{show:!0}}},geo:{map:"china",left:"10",right:"35%",center:[117.98561551896913,31.205000490896193],zoom:4,label:{emphasis:{show:!1}},roam:!0,itemStyle:{normal:{areaColor:"#323c48",borderColor:"#111"},emphasis:{areaColor:"#323c48"}}},tooltip:{trigger:"item"},grid:{right:40,top:100,bottom:40,width:"30%"},xAxis:{type:"value",scale:!0,position:"top",boundaryGap:!1,splitLine:{show:!1},axisLine:{show:!1},axisTick:{show:!1},axisLabel:{margin:2,textStyle:{color:"#fff"}}},yAxis:{type:"category",nameGap:16,axisLine:{show:!0,lineStyle:{color:"#ddd"}},axisLabel:{interval:0,textStyle:{color:"#ddd"}},data:categoryData},series:[{type:"scatter",coordinateSystem:"geo",data:convertedData[0],symbolSize:function(e){return Math.max(e[2]/20,5)},label:{normal:{formatter:"{b}",position:"right",show:!1},emphasis:{show:!0}},itemStyle:{normal:{color:"#FF3333",position:"right",show:!0}}},{type:"effectScatter",coordinateSystem:"geo",data:convertedData[0],symbolSize:function(e){return Math.max(e[2]/50,8)},showEffectOn:"render",rippleEffect:{brushType:"stroke"},hoverAnimation:!0,label:{normal:{formatter:"{b}",position:"right",show:!0}},itemStyle:{normal:{color:"#FFDD55",shadowBlur:50,shadowColor:"#EE0000"}},zlevel:1},{id:"bar",zlevel:2,type:"bar",symbol:"none",itemStyle:{normal:{color:"#ddb926"}},data}]};function renderBrushed(e){for(var t=e.batch[0].selected[0],a=[],o=[],l=[],m=30,s=0,n=0,r=0;r<t.dataIndex.length;r++){var v=t.dataIndex[r],u=convertedData[0][v],c=u.value[2];s+=c,n++,a.push(u)}a.sort(function(h,f){return h.value-f.value});for(var r=0;r<Math.min(a.length,m);r++)o.push(a[r].name),l.push(a[r].value[2]);this.setOption({yAxis:{data:o},xAxis:{axisLabel:{show:!!n}},title:{id:"statistic",text:n?"平均: "+(s/n).toFixed(4):""},series:{id:"bar",data:l}})}

const worldGeoCoordMap={美国蒙特里:[-121.874729,36.541478],荷兰奥特芬:[5.057415,52.735095],中国上海:[121.4648,31.2891]},worldDatas=[["美国蒙特里",10,20,30,0,0],["荷兰奥特芬",0,0,0,0,1],["中国上海",0,50,0,100,0]];let series=[];const option={tooltip:{trigger:"item",backgroundColor:"rgba(166, 200, 76, 0.82)",borderColor:"#FFFFCC",showDelay:0,hideDelay:0,enterable:!0,transitionDuration:0,extraCssText:"z-index:100",formatter:function(t,e,l){var r="",o=t.name,n=t.value[t.seriesIndex+1];return r="<span style='color:#fff;'>"+o+"</span><br/>数据："+n,r}},geo:{map:"world",zoom:1.2,label:{emphasis:{show:!1}},roam:!0,itemStyle:{normal:{areaColor:"#DDD",borderColor:"#b1b1b1"},emphasis:{areaColor:"#DDD"}}},series},renderStations=()=>{let t={title:[],grid:[],legend:{data:["GPS","GLONASS","GALILEO","BDS","异常"]},series:[]};echarts.util.each(worldDatas,function(e,l){let r=worldGeoCoordMap[e[0]],o=myChart.convertToPixel("geo",r);l=String(l),inflationData=[{name:"GPS",value:e[1]},{name:"GLONASS",value:e[2]},{name:"GALILEO",value:e[3]},{name:"BDS",value:e[4]},{name:"异常",value:e[5]}];let n=e[1]+e[2]+e[3]+e[4]+e[5],i={text:e[0],textStyle:{fontSize:10,fontWeight:"bold"},x:o[0]-15,y:o[1]+15};t.title.push(i),t.grid.push({id:l,gridId:l,width:30,height:40,left:o[0]-15,top:o[1]-15,z:100}),t.series.push({id:l,type:"pie",label:{normal:{show:!1},emphasis:{show:!0}},lableLine:{normal:{show:!1},emphasis:{show:!0}},radius:15,center:o,data:inflationData,z:100,tooltip:{trigger:"item",formatter:"{b} : {c}"},itemStyle:{normal:{color:function(a){return["#38c2cc","#a047f2","#f7bb2a","#a7f421","#f02020"][a.dataIndex]}}}})}),myChart.setOption(t)};setTimeout(renderStations,0);function throttle(t,e,l){let r,o=0,n=0,i=null,a,s,u;e=e||0;function c(){n=new Date().getTime(),i=null,t.apply(s,u||[])}return function(){r=new Date().getTime(),s=this,u=arguments,a=r-(l?o:n)-e,clearTimeout(i),l?i=setTimeout(c,e):a>=0?c():i=setTimeout(c,-a),o=r}}const throttledRenderEachStation=throttle(renderStations,0);myChart.on("geoRoam",throttledRenderEachStation),myChart.setOption(option);

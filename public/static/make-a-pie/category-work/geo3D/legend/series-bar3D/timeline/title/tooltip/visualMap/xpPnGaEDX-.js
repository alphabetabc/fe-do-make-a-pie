timeLineData=[],datalist=[],fetch("https://24h-aqi-list.vercel.app/api").then(function(t){return t.json()}).then(function(t){datalist=t,datalist=datalist.reverse();for(item of datalist){let a=item[0][0],e=item[1],o=[{name:"基准",value:0}];for(let r in allarealist){let n={name:allarealist[r],value:50};for(i of e)i.area===allarealist[r]&&(n.value=i.aqi);o.push(n)}let l=a.split(" ")[1].split(":")[0];timetext="",Number(l)>=12?timetext=item[0][0]+"   P.M":Number(l)<=11&&(timetext=item[0][0]+"   A.M"),timeLineData.push(Number(l)),option.baseOption.timeline.data.push(Number(l)),option.options.push({title:[{text:timetext,textAlign:"center",left:"50%",top:"10%",textStyle:{fontSize:30,color:"rgba(255, 255, 255, 0.7)"}},{text:"全国主要城市空气质量",subtext:"data from pm25.com",sublink:"http://www.pm25.com/",left:"center",textStyle:{color:"#fff"}}],series:[{data:convertData(o)}]})}myChart.setOption(option)}).catch(function(t){console.log("parsing failed",t)}),option={baseOption:{backgroundColor:"#08304a",timeline:{show:!0,axisType:"category",tooltip:{show:!0,formatter:function(t){return console.log(t),t.name+"时"}},autoPlay:!0,currentIndex:6,playInterval:2e3,label:{normal:{show:!0,interval:"auto",formatter:"{value}时"}},data:[]},tooltip:{show:!0,formatter:t=>"位置:"+t.name+"<br/>AQI值:"+t.value[2]+"<br/>"},legend:{selectedMode:"single",orient:"vertical",y:"bottom",x:"right",data:["AQI"],textStyle:{color:"#fff"}},visualMap:{textStyle:{color:"#fff"},itemWidth:30,itemHeight:21,pieces:[{min:0,max:50,label:"优",color:"#6ccc06"},{min:51,max:100,label:"良",color:"#fbd029"},{min:101,max:150,label:"轻度污染",color:"#fe8800"},{min:151,max:200,label:"中度污染",color:"#fe0000"},{min:201,max:300,label:"重度污染",color:"#970454"},{min:301,max:500,label:"严重污染",color:"#62001e"}]},geo3D:{environment:"black",boxHeight:20,map:"china",roam:!0,realisticMaterial:{detailTexture:"#666",textureTiling:1,metalness:0,roughness:.5},label:{show:!1,textStyle:{color:"#fff",fontSize:18,opacity:1,backgroundColor:"rgba(0,23,11,0)"}},postEffect:{enable:!0,SSAO:{enable:!0,radius:1,quality:"high"}},shading:"lambert",lambertMaterial:{detailTexture:"",textureTiling:20},itemStyle:{color:"https://aqi.zfe.space/images/pisa.hdr",opacity:.007,borderWidth:0,borderColor:"rgba(0,23,11,0)"},emphasis:{label:{show:!0,textStyle:{color:"#fff",fontSize:3,backgroundColor:"rgba(0,23,11,0)"}}},light:{main:{intensity:1,shadow:!1,shadowQuality:"high"},ambient:{intensity:1},ambientCubemap:{texture:"https://aqi.zfe.space/images/pisa.hdr",exposure:3,diffuseIntensity:.5,specularIntensity:2}}},series:[{name:"AQI",type:"bar3D",coordinateSystem:"geo3D",barSize:.8,shading:"realistic",realisticMaterial:{metalness:1,roughness:.2},minHeight:.1,instancing:!0,animation:!0,animationDurationUpdate:500,opacity:1,bevelSize:.3,label:{show:!1,formatter:"{b}"},data:[]}]},options:[]};var convertData=function(t){for(var a=[],e=0;e<t.length;e++){var o=geoCoordMap[t[e].name];o&&a.push({name:t[e].name,value:o.concat(t[e].value)})}return a};function sortByKey(t,a){return t.sort(function(e,o){var l=e[a],r=o[a];return l<r?-1:l>r?1:0})}screen.width<768&&(option.baseOption.series[0].shading="lambert",myChart.setOption(option));

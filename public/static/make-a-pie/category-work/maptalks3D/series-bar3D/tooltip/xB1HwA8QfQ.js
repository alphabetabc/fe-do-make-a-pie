const minLng=120.9337719797137,minLat=30.85610622801201,maxLat=31.452846278953274,maxLng=121.69631352726837,scale=400;let averageLng=(maxLng-minLng)/50,averageLat=(maxLat-minLat)/50;var img=new Image;img.src="/asset/get/s/data-1530256582420-BkApn87MX.png";var canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");img.onload=function(){var a=canvas.width=img.width/2,n=canvas.height=img.height/2;averageLng=(maxLng-minLng)/a,averageLat=(maxLat-minLat)/n,ctx.drawImage(img,0,0,a,n);for(var e=ctx.getImageData(0,0,a,n),r=[],t=0;t<e.data.length/4;t++){var s=e.data[t*4],o=e.data[t*4+1],i=e.data[t*4+2],l=255-(.2125*s+.7154*o+.0721*i);l=(l-125)/20+50,r.push([t%a,n-Math.floor(t/a),l])}var h=[];for(let d=0;d<r.length;d++){let g=r[d],c=g[0],v=g[1],m=g[2],p=minLng+averageLng*c,u=minLat+averageLat*v,f=m*scale;h.push([p,u,f])}console.log(r),initChart(e,h)};function initChart(a,n){let e={tooltip:{},maptalks3D:{center:[121.4693,31.12307],zoom:10,pitch:50,postEffect:{enable:!0,FXAA:{enable:!0}},light:{main:{shadow:!0,intensity:2},ambientCubemap:{texture:"/asset/get/s/data-1530248984324-SyeXJSmM7.hdr",exposure:2,diffuseIntensity:.2,specularIntensity:1}}},series:[{type:"bar3D",shading:"realistic",coordinateSystem:"maptalks3D",barSize:1,wireframe:{show:!1},itemStyle:{color:function(r){var t=r.dataIndex,s=a.data[t*4],o=a.data[t*4+1],i=a.data[t*4+2];return"rgb("+[s,o,i].join(",")+")"}},data:n}]};myChart.setOption(e)}

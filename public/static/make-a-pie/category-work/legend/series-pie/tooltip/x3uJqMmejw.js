const series=[{name:"One",value:230},{name:"Two",value:48},{name:"Three",value:111},{name:"Four",value:150}],ringC=["#66ccff","#ffec8c","#33ffbb","#ffab66","#7cff33","#5470c6"],color=[setColor("#9fe8ff","#66ccff"),setColor("#fff7c0","#ffec8c"),setColor("#62ffdf","#33ffbb"),setColor("#ffd59f","#ffab66"),"#7cff33","#5470c6"],centerX="50%";function setColor(e,t){return{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:e},{offset:1,color:t}]}}let inter=null,timer=null,dataIndex=0,countToNum=series.map(e=>e.value).reduce((e,t)=>e+t,0),oldAllRate=0;series.forEach((e,t)=>{e.oldAllRate=oldAllRate.toFixed(1),t===series.length-1?e.rate=oldAllRate===0&&e.value===0?0:(100-oldAllRate).toFixed(1):(e.rate=countToNum>0?(e.value/countToNum*100).toFixed(1):0,oldAllRate+=Number(e.rate))});function setRing(){dataIndex=series.length,clearInterval(inter),setPieData(100,5,100),timer=setTimeout(()=>{setPieData(0,5,100),setCarousel()},2e3)}function setCarousel(e=0){clearInterval(inter),dataIndex=e,inter=setInterval(()=>{if(dataIndex!==series.length){setPieData(series[dataIndex].rate,dataIndex,series[dataIndex].oldAllRate);const t=dataIndex===series.length?0:dataIndex,l=setTimeout(()=>{setPieData(0,t,Number(series[t].oldAllRate));const a=setTimeout(()=>{setPieData(0,t,Number(series[t].rate)+Number(series[t].oldAllRate)),clearTimeout(a)},500);clearTimeout(l)},2e3)}dataIndex===series.length?(setPieData(0,0,100),setRing()):dataIndex++},3e3)}function setPieData(e,t,l){myChart.setOption({series:[{data:series},{startAngle:90-l*3.6,clockwise:!0,data:[{value:e,name:"",itemStyle:{color:color[t]}},{value:100-e,name:"",itemStyle:{color:"rgba(0,0,0,0)"}}]}]})}setCarousel(),option={backgroundColor:"#0E1327",fontSize:16,tooltip:{trigger:"item",textStyle:{color:"#fff"},backgroundColor:"rgba(16, 32, 40, 0.88)",borderRadius:4,borderColor:"#20749e",formatter:e=>e.marker+e.name+": "+e.value},legend:{right:"0%",width:"10%",itemGap:10,itemWidth:14,itemHeight:14,top:"center",textStyle:{color:"#fff",rich:{a:{fontSize:12,padding:[1,0,0,0],width:85},b:{fontSize:10,width:55}}},data:series.map((e,t)=>(e.itemStyle={color:color[t]},e))},series:[{type:"pie",hoverAnimation:!1,color,center:[centerX,"50%"],radius:["43%","70%"],startAngle:90,avoidLabelOverlap:!1,label:null,emphasis:null,labelLine:null,itemStyle:{borderWidth:5,borderColor:"rgba(0, 0, 0, 0.6)"},data:series},{type:"pie",clockWise:!0,hoverAnimation:!1,center:[centerX,"50%"],radius:["75%","80%"],startAngle:90,label:null,emphasis:null,labelLine:null,data:[{value:0,name:""},{value:100,name:"",itemStyle:{color:"rgba(0,0,0,0)"}}]}]};

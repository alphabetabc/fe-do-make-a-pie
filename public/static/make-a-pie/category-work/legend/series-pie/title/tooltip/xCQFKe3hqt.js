var data=[{value:20,name:"直接访问",color0:"#F45D67",color1:"#E2332B"},{value:20,name:"邮件营销",color0:"#F0C35E",color1:"#D45900"},{value:20,name:"联盟广告",color0:"#15E09B",color1:"#1DBD6B"},{value:20,name:"视频广告",color0:"#0E58D4",color1:"#093ED9"},{value:20,name:"搜索引擎",color0:"yellow",color1:"green"}],total=data.map(r=>r.value).reduce((r,o)=>r+o);data.reduce((r,o)=>(o.theta1=r,o.theta2=r+o.value/total,o.theta2),0),data.forEach((r,o)=>{var a=calc(r.theta1*2*Math.PI,r.theta2*2*Math.PI);r.value&&(r.itemStyle={color:{type:"radial",x:a.center[0],y:a.center[1],r:a.radius,colorStops:[{offset:0,color:r.color0},{offset:.7,color:r.color0},{offset:.6,color:r.color1},{offset:1,color:r.color1}],globalCoord:!1}})});function calc(r,o){var a=.5,l=.6,t=Math.cos,c=Math.sin,e=Math.PI,i=Math.min,m=Math.max,s=0,v=2*a,f=0,x=a*(1-t(r)),u=a*(1-t(o)),d=a*(1-l*t(r)),y=a*(1-l*t(o));r<e&&o>e&&(s=2*a);var n=i(d,y,x,u),p=m(d,y,x,u,s),g=a*(1+c(r)),M=a*(1+c(o)),b=a*(1+l*c(r)),h=a*(1+l*c(o));return r<e/2&&o>e/2&&(f=2*a),r<e/2*3&&o>e/2*3&&(v=0),xmin=i(b,h,g,M,v),xmax=m(b,h,M,g,f),{center:[(a-xmin)/(xmax-xmin),(a-n)/(p-n)],radius:a/i(xmax-xmin,p-n)}}option={title:{text:"某站点用户访问来源",subtext:"纯属虚构",x:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",left:"left",data:["直接访问","邮件营销","联盟广告","视频广告","搜索引擎"]},series:[{name:"访问来源",type:"pie",radius:["33%","55%"],center:["50%","60%"],data,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};

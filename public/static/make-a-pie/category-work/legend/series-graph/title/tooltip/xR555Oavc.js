data=[{name:"node0",category:"node0",value:64,x:100,y:20}],links=[],categories=[];function generateNodes(e,t,c,r,a){let i={name:e+"_0",category:e+"_childrens",value:r/2,x:t-10-a*5,y:c+17.32},o={name:e+"_1",category:e+"_childrens",value:r/2,x:t+10+a*5,y:c+17.32};data.push(i,o),links.push({source:e,target:e+"_0"},{source:e,target:e+"_1"}),a-1>0&&(generateNodes(i.name,i.x,i.y,r/2,a-1),generateNodes(o.name,o.x,o.y,r/2,a-1))}function getCategories(e){tmp={},ret=[];for(let t in e)typeof tmp[e[t].category]>"u"&&(tmp[e[t].category]="",ret.push(e[t].category));return ret}generateNodes(data[0].name,data[0].x,data[0].y,data[0].value,3),categories=getCategories(data),categoryStatus=function(){let e={};for(let t in categories)e[categories[t]]=!0;return e}(),data.forEach(function(e){e.itemStyle=null,e.symbolSize=e.value,e.label={normal:{show:e.value>30}},e.label.normal.show=e.value>30,e.category=categories.indexOf(e.category)}),option={title:{text:"关系图点击节点展开次级节点效果尝试"},tooltip:{},legend:{show:!1,y:"8%",data:categories},animationDuration:1500,animationEasingUpdate:"quinticInOut",series:[{name:"ECharts学习",type:"graph",layout:"none",data,links,categories:categories.map(function(e){return{name:e}}),roam:!0,focusNodeAdjacency:!0,itemStyle:{normal:{borderColor:"#fff",borderWidth:1,shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.3)"}},label:{position:"right",formatter:"{b}"},lineStyle:{color:"source",curveness:.3},emphasis:{lineStyle:{width:10}}}]},myChart.on("click",function(e){if(categoryName=e.name+"_childrens",categoryStatus[categoryName]){for(let t in categories)categories[t].includes(e.name)&&categories[t]!="node0"&&myChart.dispatchAction({type:"legendUnSelect",name:categories[t]});categoryStatus[categoryName]=!1}else{for(let t in categories)(categories[t].includes(e.name)&&categoryStatus[categories[t]]||categories[t]===categoryName)&&myChart.dispatchAction({type:"legendSelect",name:categories[t]});categoryStatus[categoryName]=!0}});

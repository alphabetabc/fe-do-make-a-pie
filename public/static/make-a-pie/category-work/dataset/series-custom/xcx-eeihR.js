option={backgroundColor:"#fff",dataset:{source:[["value","首笔土地类资金流出10%","首次开盘","回款30%","现金流回正","销售95%","梭备","结利","交房"],["首开奖",null,3,0,0,0,null,null,null],["周转奖",null,null,2e5,2e5,5e5,null,null,null],["利润奖",null,null,1e5,1e5,null,null,null,null],["目前节点",201810,201811,201812,201901,201810,201904,201905,201906],["与预计偏差",null,-1,1,0,null,1,null,null],["启动会节点",201810,201812,201811,201901,201903,201903,201905,201906]]},series:{type:"custom",coordinateSystem:"none",seriesLayoutBy:"row",label:{show:!0,formatter:function(f){return f.value[0]}},renderItem:function(e,t){var x=100,g=20,A=50,u=t.value(5)>0,y=t.style(),h=t.getWidth(),l=t.getHeight(),n=(h-x-g)/8,d=y.text,p=t.value(1),r=e.dataIndex,s=new Date,v=s.getFullYear()*100+s.getMonth()+1,w=v-t.value(4)>0;e.context.now==1?e.context.now=2:w?e.context.now=0:e.context.now!=2&&(e.context.now=1),console.log(e.context.now);var o={type:"group",position:[x+n*r+n/2,l*2/5],children:[{type:"text",style:{text:d,fill:e.context.now==0?"#999":"#333",textAlign:"center",textVerticalAlign:"middle"},position:[0,-30]},{type:"text",style:{text:t.value(4)?t.value(4).toString().substring(0,4)+"."+t.value(4).toString().substring(4,6):"",fill:e.context.now==0?"#999":"#2872eb",textAlign:"center",textVerticalAlign:"middle"},position:[0,30]},{type:"line",style:{stroke:e.context.now==0?"#e3eaf6":"#2872eb",lineWidth:2},styleEmphasis:{stroke:e.context.now==0?"#e3eaf6":"#2872eb"},shape:{x1:-n/2,x2:n/2,y1:0,y2:0}},{type:"ring",style:{fill:"#fff"},shape:{r:8,r0:0}},{type:"ring",style:{fill:e.context.now==0?"#e3eaf6":"#2872eb"},styleEmphasis:{fill:e.context.now==0?"#e3eaf6":"#2872eb"},shape:{r:8,r0:e.context.now==0?6:0}}]};if(t.value(1)||t.value(2)||t.value(3)){var i="";if(t.value(1)){i=`奖
`;for(var c=0;c<t.value(1);c++)i+="★"}else t.value(2)&&(i+="周转奖"+Math.round(t.value(2)/1e4)+"万",t.value(3)&&(i+=`
`)),t.value(3)&&(i+="利润奖"+Math.round(t.value(3)/1e4)+"万");var b={type:"rect",shape:{x:-50,y:-30,width:100,height:50},style:{text:i,fill:e.context.now==0?"#fff":"#2872eb",textFill:e.context.now==0?"#333":"#fff",shadowBlur:10,shadowColor:"rgba(0,0,0,.2)"},position:[0,-l/5-15]};o.children.push(b)}return t.value(5)&&o.children.push({type:"polygon",shape:{points:e.context.now==0?[[-50,-15],[40,-15],[50,0],[40,15],[-50,15],[-40,0]]:[[-55,-15],[45,-15],[55,0],[45,15],[-55,15],[-45,0]]},style:{text:(e.context.now==0?"":"预计")+(u?"延迟":"提前")+Math.abs(t.value(5))+"个月",stroke:u?"#ff9498":"#16c3ca",textFill:u?"#ff9498":"#16c3ca",fill:"#fff"},position:[0,l/5+15]}),t.value(6)&&o.children.push({type:"polygon",shape:{points:[[-50,-15],[40,-15],[50,0],[40,15],[-50,15],[-40,0]]},style:{text:t.value(6).toString().substring(0,4)+"."+t.value(6).toString().substring(4,6),stroke:"#999",textFill:"#999",fill:"#fff"},position:[0,l*2/5+15]}),e.context.now==1&&o.children.push({type:"group",position:[-n/2,0],children:[{type:"text",style:{text:"▼",fill:"#2872eb",textAlign:"center",textVerticalAlign:"bottom"},position:[0,-10]},{type:"text",style:{text:"现在",fill:"#2872eb",textAlign:"center",textVerticalAlign:"top"},position:[0,10]}]}),r==0&&o.children.push({type:"group",position:[-n/2-20,0],children:[{type:"text",style:{text:"目前节点",fill:"#999",textAlign:"right",textVerticalAlign:"middle"},position:[0,0]},{type:"text",style:{text:"与预计偏差",fill:"#999",textAlign:"right",textVerticalAlign:"middle"},position:[0,l/5+15]},{type:"text",style:{text:"启动会节点",fill:"#999",textAlign:"right",textVerticalAlign:"middle"},position:[0,l*2/5+15]}]}),o}}};

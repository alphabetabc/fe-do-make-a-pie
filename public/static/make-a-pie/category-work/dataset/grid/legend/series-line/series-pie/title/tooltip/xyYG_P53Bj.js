var oldData=[{DENOMINATION:"100",COFFERS_NAME:"第一金库",sumAmt:243.35},{DENOMINATION:"50",COFFERS_NAME:"第一金库",sumAmt:40},{DENOMINATION:"20",COFFERS_NAME:"第一金库",sumAmt:300},{DENOMINATION:"10",COFFERS_NAME:"第一金库",sumAmt:40},{DENOMINATION:"5",COFFERS_NAME:"第一金库",sumAmt:100},{DENOMINATION:"100",COFFERS_NAME:"第二金库",sumAmt:100},{DENOMINATION:"50",COFFERS_NAME:"第二金库",sumAmt:341.4514},{DENOMINATION:"20",COFFERS_NAME:"第二金库",sumAmt:45.78},{DENOMINATION:"10",COFFERS_NAME:"第二金库",sumAmt:40},{DENOMINATION:"5",COFFERS_NAME:"第二金库",sumAmt:200},{DENOMINATION:"100",COFFERS_NAME:"第三金库",sumAmt:89.6},{DENOMINATION:"50",COFFERS_NAME:"第三金库",sumAmt:25.645},{DENOMINATION:"20",COFFERS_NAME:"第三金库",sumAmt:7.685},{DENOMINATION:"10",COFFERS_NAME:"第三金库",sumAmt:40},{DENOMINATION:"5",COFFERS_NAME:"第三金库",sumAmt:300}],datavalue={source:[["product"]]};let coffersArr=[],denominationArr=[];oldData.forEach(t=>{denominationArr.indexOf(t.DENOMINATION)<0&&denominationArr.push(t.DENOMINATION),coffersArr.indexOf(t.COFFERS_NAME)<0&&coffersArr.push(t.COFFERS_NAME)});for(var i=0;i<denominationArr.length+1;i++)if(i===0)for(var j=0;j<coffersArr.length;j++)datavalue.source[i][j+1]=coffersArr[j];else datavalue.source[i]=[],datavalue.source[i][0]=denominationArr[i-1];for(var i=1;i<datavalue.source.length;i++)for(var j=1;j<datavalue.source[0].length;j++)for(var k=0;k<oldData.length;k++)datavalue.source[i][0]==oldData[k].DENOMINATION&&datavalue.source[0][j]==oldData[k].COFFERS_NAME&&(datavalue.source[i][j]=oldData[k].sumAmt);console.log(datavalue),setTimeout(function(){option={title:{text:"票面库存统计",subtext:"单位：万元",left:"center"},legend:{right:"0"},tooltip:{trigger:"axis",showContent:!0,position:"outside"},dataset:datavalue,xAxis:{type:"category"},yAxis:{gridIndex:0},grid:{top:"55%"},series:[{type:"line",smooth:!0,seriesLayoutBy:"row"},{type:"line",smooth:!0,seriesLayoutBy:"row"},{type:"line",smooth:!0,seriesLayoutBy:"row"},{type:"line",smooth:!0,seriesLayoutBy:"row"},{type:"line",smooth:!0,seriesLayoutBy:"row"},{type:"line",smooth:!0,seriesLayoutBy:"row"},{type:"pie",id:"pie",radius:["30%","20%"],center:["50%","30%"],label:{position:"outside",formatter:"{b}: ({d}%)"},encode:{itemName:"product"}}]},myChart.on("updateAxisPointer",function(t){var o=t.axesInfo[0];if(o){var e=o.value+1;myChart.setOption({series:{id:"pie",label:{formatter:"{b}: {@["+e+"]} ({d}%)"},encode:{value:e,tooltip:e}}})}}),myChart.setOption(option)});

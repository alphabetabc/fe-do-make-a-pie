let dataSource=[["product","bsntq","zje","B"],["库存材料",102,230,236],["半成品",596,250,509],["产成品",459,550,356],["在制品",308,785,119],["印度工厂",120,340,550],["工程施工",230,340,-650],["库存存货",540,120,760],["发出商品",560,-230,550],["美国",-1230,456,142],["售后库存",654,450,-869]];option={grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},title:{left:"center",show:!0,text:"双y轴分割线对齐",textStyle:{color:"#333",fontSize:18}},xAxis:[{type:"category"}],yAxis:[{type:"value"},{type:"value"}],legend:{show:!0,type:"scroll",bottom:0,textStyle:{fontSize:12}},series:[{name:"上年同期",type:"bar",barGap:"30%"},{name:"增减额",type:"bar",barGap:"30%"},{name:"累计数",type:"line",yAxisIndex:1}],dataset:{source:dataSource},tooltip:{axisPointer:{type:"none"}}};function yAxisMax(a){if(isNaN(a/1)||a/1<10)return 10;const o=Math.ceil(a)+"",t=Math.ceil(o/5)+"",e=Math.ceil(t/Math.pow(10,t.length-1))*Math.pow(10,t.length-1)+"";return Math.ceil(e/5)*5*5}function getYAxisConfig(a,o=[]){let t=[];a.forEach((s,p)=>{p>0&&o.forEach(y=>{t.push(s[y+1]||0)})});let n=t.reduce((s,p)=>Math.abs(s)>Math.abs(p)?Math.abs(s):Math.abs(p)),e=yAxisMax(n)/5,l=Math.max(...t),r=Math.min(...t),i=l>0?Math.ceil(l/e):0,h=r<0?Math.ceil(Math.abs(r)/e):0;return{interval:e,yData:e,topSplitNumber:i,downSplitNumber:h}}function getYAxisIndexSeries(a,o){let t={};a.forEach((n,e)=>{if(!n.yAxisIndex)t.hasOwnProperty("0")?t[0].push(e):t[0]=[e];else if(n.yAxisIndex){let l=n.yAxisIndex+"";t.hasOwnProperty(l)?t[l].push(e):t[l]=[e]}}),Object.keys(t).length>1&&splitLineAlign(o,t)}function splitLineAlign(a,o){let t={},n=[],e=[];for(let i in o)t[i]=getYAxisConfig(a,o[i]),n.push(t[i].topSplitNumber),e.push(t[i].downSplitNumber);let l=Math.max(...n),r=Math.max(...e);for(let i in t)option.yAxis[i]&&(option.yAxis[i].max=t[i].interval*l,option.yAxis[i].min=t[i].interval*r*-1,option.yAxis[i].interval=t[i].interval)}getYAxisIndexSeries(option.series,dataSource);
